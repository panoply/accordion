var Pr=class extends Array{constructor(){super(...arguments),this.refs=Object.create(null)}get(r){let e=typeof r;if(e==="number")return this[r];if(e==="string"){if(r in this.refs)return this[this.refs[r]];throw new Error(`Relapse: No fold using an id value of: ${r}`)}return e==="undefined"?this:void 0}},jt=function r(e,t){let s=typeof e=="string"||typeof e=="object"&&"tagName"in e;if(s&&e instanceof NodeList)throw TypeError("relapse: Invalid selector, NodeList is not supported, pass string or Element");let n=(u=>{let h=Object.create(null);if(h.persist=!0,h.multiple=!1,h.parent=null,h.schema="data-relapse",h.duration=225,h.classes=Object.create(null),h.classes.initial="initial",h.classes.opened="opened",h.classes.disabled="disabled",h.classes.expanded="expanded",h.classes.focused="focused",typeof u=="object")for(let v in u)if(v==="classes")for(let c in u[v])h.classes[c]=u[v][c];else h[v]=u[v];return h})(s?t:e),i=null;if(s)i=typeof e=="string"?document.body.querySelector(e):e;else for(let u of document.body.querySelectorAll(`[${n.schema}]`))r(u,t);if(i===null)return;window.relapse instanceof Map||(window.relapse=new Map);let o=Object.create(null);o.events=Object.create(null),o.folds=new Pr,o.element=i,o.id=`R${window.relapse.size}`,o.count=0,o.config=function(u,h){let v=u.schema.length+1;for(let{nodeName:c,nodeValue:g}of h){if(!c.startsWith(u.schema))continue;let m=c.slice(v),l=g.trim();if(m==="persist"||m==="multiple"){if(l!=="true"&&l!=="false")throw new TypeError(`relapse: Invalid ${c} attribute value. Boolean expected, received: ${l}`);u[m]=l==="true"}else if(m==="duration"){if(isNaN(+l))throw new TypeError(`relapse: Invalid ${c} attribute value. Number expected, received: ${l}`);u[m]=+l}}return u}(n,o.element.attributes),o.parent=o.config.parent;let f=null;i.hasAttribute(o.config.schema)?f=i.getAttribute(o.config.schema):"id"in i&&(f=i.id),f===null&&window.relapse.has(f)===!0&&(f=Math.random().toString(36).slice(2)),o.element.ariaMultiSelectable=`${o.config.multiple}`;let p=i.children,y=p.length,D=(N=o.events,{on:function(u,h){N[u]||(N[u]=[]),N[u].push(h)},off:function(u,h){let v=[],c=N[u];if(c&&h)for(let g=0,m=c.length;g<m;g++)c[g]!==h&&v.push(c[g]);v.length?c[u]=v:delete c[u]},emit:function(u,h,v){let c=N[u]||[],g=c.length,m=null;for(let l=0;l<g;l++){let d=c[l].apply(h,[v]);m===null&&d===!1&&(m=!0)}return m}});var N;let Oe=function(u,h){let{classes:v}=u.config;return function(c){let g=l=>{if(typeof l!="number")return u.active!==c.index&&(u.active=c.index),c;if(u.folds.get(l))return u.active=c.index,u.folds.get(l);throw new Error(`relapse: No fold exists at index: ${l}`)},m=l=>{l.button.ariaDisabled="false",l.button.ariaExpanded="false",l.element.classList.remove(v.expanded),l.expanded=!1,l.button.classList.contains(v.initial)&&l.button.classList.remove(v.initial),l.element.style.setProperty("max-height","0"),u.parent!==null&&u.parent.style.setProperty("max-height",u.parent.scrollHeight-l.height+"px"),u.folds.length-1===l.index?l.element.addEventListener("transitionend",function d(){l.expanded||(l.element.style.setProperty("opacity","0"),l.element.style.setProperty("visibility","hidden"),l.button.classList.remove(v.opened)),l.element.removeEventListener("transitionend",d)}):(l.element.style.setProperty("opacity","0"),l.element.style.setProperty("visibility","hidden"),l.button.classList.remove(v.opened))};c.open=function(l){let d=g(l);d.expanded||(d.close(),d.height=d.element.scrollHeight,d.button.ariaDisabled="true",d.button.ariaExpanded="true",d.button.classList.add(v.opened),d.element.classList.add(v.expanded),d.element.style.setProperty("max-height",`${d.height}px`),d.element.style.setProperty("opacity","1"),d.element.style.setProperty("visibility","visible"),u.parent!==null&&u.parent.style.setProperty("max-height",`${u.parent.scrollHeight+d.height}px`),d.expanded=!0,d.disable(),u.count=u.folds.filter(({expanded:x})=>x).length,h.emit("expand",u,d))},c.close=function(l){let d=g(l);if(u.config.multiple)(u.config.persist===!1||u.config.persist&&u.count>1)&&m(d);else for(let x of u.folds.values())if(x.expanded===!0){if(u.config.persist&&x.index===d.index)break;m(x),d=x;break}d.enable(),u.count=u.folds.filter(({expanded:x})=>x).length,h.emit("collapse",u,d)},c.focus=function(){u.active=c.index,c.button.classList.add(v.focused),h.emit("focus",u,c)},c.blur=function(){c.button.classList.remove(v.focused)},c.enable=function(l){let d=g(l);d.disabled&&(d.disabled=!1,d.button.ariaDisabled="false",d.button.classList.remove(v.disabled))},c.disable=function(l){let d=g(l);d.disabled||(d.expanded?u.config.persist&&(d.disabled=!0,d.button.ariaDisabled="true"):(d.close(),d.disabled=!0,d.button.ariaDisabled="true",d.button.classList.add(v.disabled)))},c.toggle=function(){if(h.emit("toggle",u,c)!==!1)return c.expanded?c.close():c.open()},c.destroy=function(l=!1){c.close(),c.button.removeEventListener("click",c.toggle),c.button.removeEventListener("focus",c.focus),c.button.removeEventListener("blur",c.blur),l&&(u.element.removeChild(c.element),u.element.removeChild(c.button))},c.button.addEventListener("click",c.toggle),c.button.addEventListener("focus",c.focus),c.button.addEventListener("blur",c.blur),c.element.hasAttribute("id")?(u.folds.push(c),u.folds.refs[c.element.id]=u.folds.length-1):u.folds.push(c)}}(o,D),{classes:L}=o.config,ne=isNaN(o.config.duration)||o.config.duration===-1?null:function(u){let h=u.duration/2;return`will-change:visibility,opacity,max-height;overflow:hidden;transition:visibility ${h}ms linear,opacity ${h}ms linear,max-height ${u.duration}ms ease-in-out;`}(o.config);for(let u=0;u<y;u+=2){let h=p[u],v=p[u+1],c=Object.create(null);c.index=o.folds.length;let g=h.classList.contains(L.initial),m=h.classList.contains(L.opened),l=h.classList.contains(L.disabled),d=v.classList.contains(L.expanded);h.ariaExpanded==="true"||m||d||g?(m?h.ariaExpanded="true":h.classList.add(L.opened),g||h.classList.remove(L.initial),d||v.classList.add(L.expanded),l&&(h.classList.add(L.disabled),h.ariaDisabled="true",c.disabled=!0),c.expanded=!0):h.ariaDisabled==="true"||l?(c.disabled=!0,l?h.ariaDisabled="true":h.classList.add(L.disabled),d?(c.expanded=!0,h.ariaExpanded="true"):(c.expanded=!1,h.ariaExpanded="false"),m&&h.classList.remove(L.opened)):(c.expanded=!1,c.disabled=!1,h.ariaExpanded="false",h.ariaDisabled="false"),"id"in h&&(c.id=h.id),"id"in v&&(c.id=v.id),"id"in c||(c.id=`${o.id}F${c.index}`,h.id=`B${c.id}`,v.id=`C${c.id}`),h.setAttribute("aria-controls",c.id),v.setAttribute("aria-labelledby",h.id),v.setAttribute("role","region"),Object.defineProperties(c,{button:{get:()=>h},element:{get:()=>v}}),c.expanded?(o.count=o.count+1,c.element.style.cssText=ne!==null?`max-height:${c.element.scrollHeight}px;opacity:1;visibility:visible;${ne}`:`max-height:${c.element.scrollHeight}px;opacity:1;visibility:visible;`):c.element.style.cssText=ne!==null?`max-height:0px;opacity:0;visibility:hidden;${ne}`:"max-height:0px;opacity:0;visibility:hidden;",Oe(c),window.relapse.set(f,null);for(let x of c.element.querySelectorAll(`[${o.config.schema}]`))r(x,{parent:c.element})}let Y=(u,h,v=!1)=>{if(typeof h=="number")return u.charCodeAt(0)===100?o.folds[h][u](v):o.folds[h][u]();if(typeof h=="string"){for(let c of o.folds.values())if(c.button.dataset[`${o.config.schema}-fold`]===h)return u.charCodeAt(0)===100?c[u](v):c[u]()}throw new Error(`relapse: Fold does not exist: "${h}"`)};return o.on=D.on,o.off=D.off,o.collapse=u=>Y("close",u),o.expand=u=>Y("open",u),o.destroy=(u,h=!1)=>{if(u===void 0)for(let v of o.folds.values())v.destroy();else Y("destroy",u,h);o.element.removeAttribute("aria-multiselectable"),D.emit("destroy",o),window.relapse.delete(f)},window.relapse.set(f,o),s?o:Array.from(window.relapse.values())};jt.get=r=>r?window.relapse.get(r):window.relapse;var ze=jt;var He=class{constructor(e,t,s){this.eventTarget=e,this.eventName=t,this.eventOptions=s,this.unorderedBindings=new Set}connect(){this.eventTarget.addEventListener(this.eventName,this,this.eventOptions)}disconnect(){this.eventTarget.removeEventListener(this.eventName,this,this.eventOptions)}bindingConnected(e){this.unorderedBindings.add(e)}bindingDisconnected(e){this.unorderedBindings.delete(e)}handleEvent(e){let t=jr(e);for(let s of this.bindings){if(t.immediatePropagationStopped)break;s.handleEvent(t)}}hasBindings(){return this.unorderedBindings.size>0}get bindings(){return Array.from(this.unorderedBindings).sort((e,t)=>{let s=e.index,n=t.index;return s<n?-1:s>n?1:0})}};function jr(r){if("immediatePropagationStopped"in r)return r;{let{stopImmediatePropagation:e}=r;return Object.assign(r,{immediatePropagationStopped:!1,stopImmediatePropagation(){this.immediatePropagationStopped=!0,e.call(this)}})}}var Ue=class{constructor(e){this.application=e,this.eventListenerMaps=new Map,this.started=!1}start(){this.started||(this.started=!0,this.eventListeners.forEach(e=>e.connect()))}stop(){this.started&&(this.started=!1,this.eventListeners.forEach(e=>e.disconnect()))}get eventListeners(){return Array.from(this.eventListenerMaps.values()).reduce((e,t)=>e.concat(Array.from(t.values())),[])}bindingConnected(e){this.fetchEventListenerForBinding(e).bindingConnected(e)}bindingDisconnected(e,t=!1){this.fetchEventListenerForBinding(e).bindingDisconnected(e),t&&this.clearEventListenersForBinding(e)}handleError(e,t,s={}){this.application.handleError(e,`Error ${t}`,s)}clearEventListenersForBinding(e){let t=this.fetchEventListenerForBinding(e);t.hasBindings()||(t.disconnect(),this.removeMappedEventListenerFor(e))}removeMappedEventListenerFor(e){let{eventTarget:t,eventName:s,eventOptions:n}=e,i=this.fetchEventListenerMapForEventTarget(t),o=this.cacheKey(s,n);i.delete(o),i.size==0&&this.eventListenerMaps.delete(t)}fetchEventListenerForBinding(e){let{eventTarget:t,eventName:s,eventOptions:n}=e;return this.fetchEventListener(t,s,n)}fetchEventListener(e,t,s){let n=this.fetchEventListenerMapForEventTarget(e),i=this.cacheKey(t,s),o=n.get(i);return o||(o=this.createEventListener(e,t,s),n.set(i,o)),o}createEventListener(e,t,s){let n=new He(e,t,s);return this.started&&n.connect(),n}fetchEventListenerMapForEventTarget(e){let t=this.eventListenerMaps.get(e);return t||(t=new Map,this.eventListenerMaps.set(e,t)),t}cacheKey(e,t){let s=[e];return Object.keys(t).sort().forEach(n=>{s.push(`${t[n]?"":"!"}${n}`)}),s.join(":")}},Ir={stop({event:r,value:e}){return e&&r.stopPropagation(),!0},prevent({event:r,value:e}){return e&&r.preventDefault(),!0},self({event:r,value:e,element:t}){return e?t===r.target:!0}},Kr=/^(?:(?:([^.]+?)\+)?(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;function qr(r){let t=r.trim().match(Kr)||[],s=t[2],n=t[3];return n&&!["keydown","keyup","keypress"].includes(s)&&(s+=`.${n}`,n=""),{eventTarget:Rr(t[4]),eventName:s,eventOptions:t[7]?Wr(t[7]):{},identifier:t[5],methodName:t[6],keyFilter:t[1]||n}}function Rr(r){if(r=="window")return window;if(r=="document")return document}function Wr(r){return r.split(":").reduce((e,t)=>Object.assign(e,{[t.replace(/^!/,"")]:!/^!/.test(t)}),{})}function zr(r){if(r==window)return"window";if(r==document)return"document"}function pt(r){return r.replace(/(?:[_-])([a-z0-9])/g,(e,t)=>t.toUpperCase())}function _e(r){return pt(r.replace(/--/g,"-").replace(/__/g,"_"))}function de(r){return r.charAt(0).toUpperCase()+r.slice(1)}function Xt(r){return r.replace(/([A-Z])/g,(e,t)=>`-${t.toLowerCase()}`)}function Hr(r){return r.match(/[^\s]+/g)||[]}function It(r){return r!=null}function Xe(r,e){return Object.prototype.hasOwnProperty.call(r,e)}var Kt=["meta","ctrl","alt","shift"],Ye=class{constructor(e,t,s,n){this.element=e,this.index=t,this.eventTarget=s.eventTarget||e,this.eventName=s.eventName||Ur(e)||$e("missing event name"),this.eventOptions=s.eventOptions||{},this.identifier=s.identifier||$e("missing identifier"),this.methodName=s.methodName||$e("missing method name"),this.keyFilter=s.keyFilter||"",this.schema=n}static forToken(e,t){return new this(e.element,e.index,qr(e.content),t)}toString(){let e=this.keyFilter?`.${this.keyFilter}`:"",t=this.eventTargetName?`@${this.eventTargetName}`:"";return`${this.eventName}${e}${t}->${this.identifier}#${this.methodName}`}shouldIgnoreKeyboardEvent(e){if(!this.keyFilter)return!1;let t=this.keyFilter.split("+");if(this.keyFilterDissatisfied(e,t))return!0;let s=t.filter(n=>!Kt.includes(n))[0];return s?(Xe(this.keyMappings,s)||$e(`contains unknown key filter: ${this.keyFilter}`),this.keyMappings[s].toLowerCase()!==e.key.toLowerCase()):!1}shouldIgnoreMouseEvent(e){if(!this.keyFilter)return!1;let t=[this.keyFilter];return!!this.keyFilterDissatisfied(e,t)}get params(){let e={},t=new RegExp(`^data-${this.identifier}-(.+)-param$`,"i");for(let{name:s,value:n}of Array.from(this.element.attributes)){let i=s.match(t),o=i&&i[1];o&&(e[pt(o)]=_r(n))}return e}get eventTargetName(){return zr(this.eventTarget)}get keyMappings(){return this.schema.keyMappings}keyFilterDissatisfied(e,t){let[s,n,i,o]=Kt.map(f=>t.includes(f));return e.metaKey!==s||e.ctrlKey!==n||e.altKey!==i||e.shiftKey!==o}},qt={a:()=>"click",button:()=>"click",form:()=>"submit",details:()=>"toggle",input:r=>r.getAttribute("type")=="submit"?"click":"input",select:()=>"change",textarea:()=>"input"};function Ur(r){let e=r.tagName.toLowerCase();if(e in qt)return qt[e](r)}function $e(r){throw new Error(r)}function _r(r){try{return JSON.parse(r)}catch{return r}}var Ge=class{constructor(e,t){this.context=e,this.action=t}get index(){return this.action.index}get eventTarget(){return this.action.eventTarget}get eventOptions(){return this.action.eventOptions}get identifier(){return this.context.identifier}handleEvent(e){let t=this.prepareActionEvent(e);this.willBeInvokedByEvent(e)&&this.applyEventModifiers(t)&&this.invokeWithEvent(t)}get eventName(){return this.action.eventName}get method(){let e=this.controller[this.methodName];if(typeof e=="function")return e;throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`)}applyEventModifiers(e){let{element:t}=this.action,{actionDescriptorFilters:s}=this.context.application,{controller:n}=this.context,i=!0;for(let[o,f]of Object.entries(this.eventOptions))if(o in s){let p=s[o];i=i&&p({name:o,value:f,event:e,element:t,controller:n})}else continue;return i}prepareActionEvent(e){return Object.assign(e,{params:this.action.params})}invokeWithEvent(e){let{target:t,currentTarget:s}=e;try{this.method.call(this.controller,e),this.context.logDebugActivity(this.methodName,{event:e,target:t,currentTarget:s,action:this.methodName})}catch(n){let{identifier:i,controller:o,element:f,index:p}=this,y={identifier:i,controller:o,element:f,index:p,event:e};this.context.handleError(n,`invoking action "${this.action}"`,y)}}willBeInvokedByEvent(e){let t=e.target;return e instanceof KeyboardEvent&&this.action.shouldIgnoreKeyboardEvent(e)||e instanceof MouseEvent&&this.action.shouldIgnoreMouseEvent(e)?!1:this.element===t?!0:t instanceof Element&&this.element.contains(t)?this.scope.containsElement(t):this.scope.containsElement(this.action.element)}get controller(){return this.context.controller}get methodName(){return this.action.methodName}get element(){return this.scope.element}get scope(){return this.context.scope}},Ce=class{constructor(e,t){this.mutationObserverInit={attributes:!0,childList:!0,subtree:!0},this.element=e,this.started=!1,this.delegate=t,this.elements=new Set,this.mutationObserver=new MutationObserver(s=>this.processMutations(s))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,this.mutationObserverInit),this.refresh())}pause(e){this.started&&(this.mutationObserver.disconnect(),this.started=!1),e(),this.started||(this.mutationObserver.observe(this.element,this.mutationObserverInit),this.started=!0)}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started){let e=new Set(this.matchElementsInTree());for(let t of Array.from(this.elements))e.has(t)||this.removeElement(t);for(let t of Array.from(e))this.addElement(t)}}processMutations(e){if(this.started)for(let t of e)this.processMutation(t)}processMutation(e){e.type=="attributes"?this.processAttributeChange(e.target,e.attributeName):e.type=="childList"&&(this.processRemovedNodes(e.removedNodes),this.processAddedNodes(e.addedNodes))}processAttributeChange(e,t){this.elements.has(e)?this.delegate.elementAttributeChanged&&this.matchElement(e)?this.delegate.elementAttributeChanged(e,t):this.removeElement(e):this.matchElement(e)&&this.addElement(e)}processRemovedNodes(e){for(let t of Array.from(e)){let s=this.elementFromNode(t);s&&this.processTree(s,this.removeElement)}}processAddedNodes(e){for(let t of Array.from(e)){let s=this.elementFromNode(t);s&&this.elementIsActive(s)&&this.processTree(s,this.addElement)}}matchElement(e){return this.delegate.matchElement(e)}matchElementsInTree(e=this.element){return this.delegate.matchElementsInTree(e)}processTree(e,t){for(let s of this.matchElementsInTree(e))t.call(this,s)}elementFromNode(e){if(e.nodeType==Node.ELEMENT_NODE)return e}elementIsActive(e){return e.isConnected!=this.element.isConnected?!1:this.element.contains(e)}addElement(e){this.elements.has(e)||this.elementIsActive(e)&&(this.elements.add(e),this.delegate.elementMatched&&this.delegate.elementMatched(e))}removeElement(e){this.elements.has(e)&&(this.elements.delete(e),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(e))}},Me=class{constructor(e,t,s){this.attributeName=t,this.delegate=s,this.elementObserver=new Ce(e,this)}get element(){return this.elementObserver.element}get selector(){return`[${this.attributeName}]`}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get started(){return this.elementObserver.started}matchElement(e){return e.hasAttribute(this.attributeName)}matchElementsInTree(e){let t=this.matchElement(e)?[e]:[],s=Array.from(e.querySelectorAll(this.selector));return t.concat(s)}elementMatched(e){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(e,this.attributeName)}elementUnmatched(e){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(e,this.attributeName)}elementAttributeChanged(e,t){this.delegate.elementAttributeValueChanged&&this.attributeName==t&&this.delegate.elementAttributeValueChanged(e,t)}};function Xr(r,e,t){Yt(r,e).add(t)}function Yr(r,e,t){Yt(r,e).delete(t),Gr(r,e)}function Yt(r,e){let t=r.get(e);return t||(t=new Set,r.set(e,t)),t}function Gr(r,e){let t=r.get(e);t!=null&&t.size==0&&r.delete(e)}var z=class{constructor(){this.valuesByKey=new Map}get keys(){return Array.from(this.valuesByKey.keys())}get values(){return Array.from(this.valuesByKey.values()).reduce((t,s)=>t.concat(Array.from(s)),[])}get size(){return Array.from(this.valuesByKey.values()).reduce((t,s)=>t+s.size,0)}add(e,t){Xr(this.valuesByKey,e,t)}delete(e,t){Yr(this.valuesByKey,e,t)}has(e,t){let s=this.valuesByKey.get(e);return s!=null&&s.has(t)}hasKey(e){return this.valuesByKey.has(e)}hasValue(e){return Array.from(this.valuesByKey.values()).some(s=>s.has(e))}getValuesForKey(e){let t=this.valuesByKey.get(e);return t?Array.from(t):[]}getKeysForValue(e){return Array.from(this.valuesByKey).filter(([t,s])=>s.has(e)).map(([t,s])=>t)}};var Je=class{constructor(e,t,s,n){this._selector=t,this.details=n,this.elementObserver=new Ce(e,this),this.delegate=s,this.matchesByElement=new z}get started(){return this.elementObserver.started}get selector(){return this._selector}set selector(e){this._selector=e,this.refresh()}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get element(){return this.elementObserver.element}matchElement(e){let{selector:t}=this;if(t){let s=e.matches(t);return this.delegate.selectorMatchElement?s&&this.delegate.selectorMatchElement(e,this.details):s}else return!1}matchElementsInTree(e){let{selector:t}=this;if(t){let s=this.matchElement(e)?[e]:[],n=Array.from(e.querySelectorAll(t)).filter(i=>this.matchElement(i));return s.concat(n)}else return[]}elementMatched(e){let{selector:t}=this;t&&this.selectorMatched(e,t)}elementUnmatched(e){let t=this.matchesByElement.getKeysForValue(e);for(let s of t)this.selectorUnmatched(e,s)}elementAttributeChanged(e,t){let{selector:s}=this;if(s){let n=this.matchElement(e),i=this.matchesByElement.has(s,e);n&&!i?this.selectorMatched(e,s):!n&&i&&this.selectorUnmatched(e,s)}}selectorMatched(e,t){this.delegate.selectorMatched(e,t,this.details),this.matchesByElement.add(t,e)}selectorUnmatched(e,t){this.delegate.selectorUnmatched(e,t,this.details),this.matchesByElement.delete(t,e)}},Qe=class{constructor(e,t){this.element=e,this.delegate=t,this.started=!1,this.stringMap=new Map,this.mutationObserver=new MutationObserver(s=>this.processMutations(s))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,attributeOldValue:!0}),this.refresh())}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started)for(let e of this.knownAttributeNames)this.refreshAttribute(e,null)}processMutations(e){if(this.started)for(let t of e)this.processMutation(t)}processMutation(e){let t=e.attributeName;t&&this.refreshAttribute(t,e.oldValue)}refreshAttribute(e,t){let s=this.delegate.getStringMapKeyForAttribute(e);if(s!=null){this.stringMap.has(e)||this.stringMapKeyAdded(s,e);let n=this.element.getAttribute(e);if(this.stringMap.get(e)!=n&&this.stringMapValueChanged(n,s,t),n==null){let i=this.stringMap.get(e);this.stringMap.delete(e),i&&this.stringMapKeyRemoved(s,e,i)}else this.stringMap.set(e,n)}}stringMapKeyAdded(e,t){this.delegate.stringMapKeyAdded&&this.delegate.stringMapKeyAdded(e,t)}stringMapValueChanged(e,t,s){this.delegate.stringMapValueChanged&&this.delegate.stringMapValueChanged(e,t,s)}stringMapKeyRemoved(e,t,s){this.delegate.stringMapKeyRemoved&&this.delegate.stringMapKeyRemoved(e,t,s)}get knownAttributeNames(){return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))}get currentAttributeNames(){return Array.from(this.element.attributes).map(e=>e.name)}get recordedAttributeNames(){return Array.from(this.stringMap.keys())}},Le=class{constructor(e,t,s){this.attributeObserver=new Me(e,t,this),this.delegate=s,this.tokensByElement=new z}get started(){return this.attributeObserver.started}start(){this.attributeObserver.start()}pause(e){this.attributeObserver.pause(e)}stop(){this.attributeObserver.stop()}refresh(){this.attributeObserver.refresh()}get element(){return this.attributeObserver.element}get attributeName(){return this.attributeObserver.attributeName}elementMatchedAttribute(e){this.tokensMatched(this.readTokensForElement(e))}elementAttributeValueChanged(e){let[t,s]=this.refreshTokensForElement(e);this.tokensUnmatched(t),this.tokensMatched(s)}elementUnmatchedAttribute(e){this.tokensUnmatched(this.tokensByElement.getValuesForKey(e))}tokensMatched(e){e.forEach(t=>this.tokenMatched(t))}tokensUnmatched(e){e.forEach(t=>this.tokenUnmatched(t))}tokenMatched(e){this.delegate.tokenMatched(e),this.tokensByElement.add(e.element,e)}tokenUnmatched(e){this.delegate.tokenUnmatched(e),this.tokensByElement.delete(e.element,e)}refreshTokensForElement(e){let t=this.tokensByElement.getValuesForKey(e),s=this.readTokensForElement(e),n=Qr(t,s).findIndex(([i,o])=>!Zr(i,o));return n==-1?[[],[]]:[t.slice(n),s.slice(n)]}readTokensForElement(e){let t=this.attributeName,s=e.getAttribute(t)||"";return Jr(s,e,t)}};function Jr(r,e,t){return r.trim().split(/\s+/).filter(s=>s.length).map((s,n)=>({element:e,attributeName:t,content:s,index:n}))}function Qr(r,e){let t=Math.max(r.length,e.length);return Array.from({length:t},(s,n)=>[r[n],e[n]])}function Zr(r,e){return r&&e&&r.index==e.index&&r.content==e.content}var Te=class{constructor(e,t,s){this.tokenListObserver=new Le(e,t,this),this.delegate=s,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}get started(){return this.tokenListObserver.started}start(){this.tokenListObserver.start()}stop(){this.tokenListObserver.stop()}refresh(){this.tokenListObserver.refresh()}get element(){return this.tokenListObserver.element}get attributeName(){return this.tokenListObserver.attributeName}tokenMatched(e){let{element:t}=e,{value:s}=this.fetchParseResultForToken(e);s&&(this.fetchValuesByTokenForElement(t).set(e,s),this.delegate.elementMatchedValue(t,s))}tokenUnmatched(e){let{element:t}=e,{value:s}=this.fetchParseResultForToken(e);s&&(this.fetchValuesByTokenForElement(t).delete(e),this.delegate.elementUnmatchedValue(t,s))}fetchParseResultForToken(e){let t=this.parseResultsByToken.get(e);return t||(t=this.parseToken(e),this.parseResultsByToken.set(e,t)),t}fetchValuesByTokenForElement(e){let t=this.valuesByTokenByElement.get(e);return t||(t=new Map,this.valuesByTokenByElement.set(e,t)),t}parseToken(e){try{return{value:this.delegate.parseValueForToken(e)}}catch(t){return{error:t}}}},Ze=class{constructor(e,t){this.context=e,this.delegate=t,this.bindingsByAction=new Map}start(){this.valueListObserver||(this.valueListObserver=new Te(this.element,this.actionAttribute,this),this.valueListObserver.start())}stop(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())}get element(){return this.context.element}get identifier(){return this.context.identifier}get actionAttribute(){return this.schema.actionAttribute}get schema(){return this.context.schema}get bindings(){return Array.from(this.bindingsByAction.values())}connectAction(e){let t=new Ge(this.context,e);this.bindingsByAction.set(e,t),this.delegate.bindingConnected(t)}disconnectAction(e){let t=this.bindingsByAction.get(e);t&&(this.bindingsByAction.delete(e),this.delegate.bindingDisconnected(t))}disconnectAllActions(){this.bindings.forEach(e=>this.delegate.bindingDisconnected(e,!0)),this.bindingsByAction.clear()}parseValueForToken(e){let t=Ye.forToken(e,this.schema);if(t.identifier==this.identifier)return t}elementMatchedValue(e,t){this.connectAction(t)}elementUnmatchedValue(e,t){this.disconnectAction(t)}},et=class{constructor(e,t){this.context=e,this.receiver=t,this.stringMapObserver=new Qe(this.element,this),this.valueDescriptorMap=this.controller.valueDescriptorMap}start(){this.stringMapObserver.start(),this.invokeChangedCallbacksForDefaultValues()}stop(){this.stringMapObserver.stop()}get element(){return this.context.element}get controller(){return this.context.controller}getStringMapKeyForAttribute(e){if(e in this.valueDescriptorMap)return this.valueDescriptorMap[e].name}stringMapKeyAdded(e,t){let s=this.valueDescriptorMap[t];this.hasValue(e)||this.invokeChangedCallback(e,s.writer(this.receiver[e]),s.writer(s.defaultValue))}stringMapValueChanged(e,t,s){let n=this.valueDescriptorNameMap[t];e!==null&&(s===null&&(s=n.writer(n.defaultValue)),this.invokeChangedCallback(t,e,s))}stringMapKeyRemoved(e,t,s){let n=this.valueDescriptorNameMap[e];this.hasValue(e)?this.invokeChangedCallback(e,n.writer(this.receiver[e]),s):this.invokeChangedCallback(e,n.writer(n.defaultValue),s)}invokeChangedCallbacksForDefaultValues(){for(let{key:e,name:t,defaultValue:s,writer:n}of this.valueDescriptors)s!=null&&!this.controller.data.has(e)&&this.invokeChangedCallback(t,n(s),void 0)}invokeChangedCallback(e,t,s){let n=`${e}Changed`,i=this.receiver[n];if(typeof i=="function"){let o=this.valueDescriptorNameMap[e];try{let f=o.reader(t),p=s;s&&(p=o.reader(s)),i.call(this.receiver,f,p)}catch(f){throw f instanceof TypeError&&(f.message=`Stimulus Value "${this.context.identifier}.${o.name}" - ${f.message}`),f}}}get valueDescriptors(){let{valueDescriptorMap:e}=this;return Object.keys(e).map(t=>e[t])}get valueDescriptorNameMap(){let e={};return Object.keys(this.valueDescriptorMap).forEach(t=>{let s=this.valueDescriptorMap[t];e[s.name]=s}),e}hasValue(e){let t=this.valueDescriptorNameMap[e],s=`has${de(t.name)}`;return this.receiver[s]}},tt=class{constructor(e,t){this.context=e,this.delegate=t,this.targetsByName=new z}start(){this.tokenListObserver||(this.tokenListObserver=new Le(this.element,this.attributeName,this),this.tokenListObserver.start())}stop(){this.tokenListObserver&&(this.disconnectAllTargets(),this.tokenListObserver.stop(),delete this.tokenListObserver)}tokenMatched({element:e,content:t}){this.scope.containsElement(e)&&this.connectTarget(e,t)}tokenUnmatched({element:e,content:t}){this.disconnectTarget(e,t)}connectTarget(e,t){var s;this.targetsByName.has(t,e)||(this.targetsByName.add(t,e),(s=this.tokenListObserver)===null||s===void 0||s.pause(()=>this.delegate.targetConnected(e,t)))}disconnectTarget(e,t){var s;this.targetsByName.has(t,e)&&(this.targetsByName.delete(t,e),(s=this.tokenListObserver)===null||s===void 0||s.pause(()=>this.delegate.targetDisconnected(e,t)))}disconnectAllTargets(){for(let e of this.targetsByName.keys)for(let t of this.targetsByName.getValuesForKey(e))this.disconnectTarget(t,e)}get attributeName(){return`data-${this.context.identifier}-target`}get element(){return this.context.element}get scope(){return this.context.scope}};function fe(r,e){let t=Gt(r);return Array.from(t.reduce((s,n)=>(ts(n,e).forEach(i=>s.add(i)),s),new Set))}function es(r,e){return Gt(r).reduce((s,n)=>(s.push(...rs(n,e)),s),[])}function Gt(r){let e=[];for(;r;)e.push(r),r=Object.getPrototypeOf(r);return e.reverse()}function ts(r,e){let t=r[e];return Array.isArray(t)?t:[]}function rs(r,e){let t=r[e];return t?Object.keys(t).map(s=>[s,t[s]]):[]}var rt=class{constructor(e,t){this.started=!1,this.context=e,this.delegate=t,this.outletsByName=new z,this.outletElementsByName=new z,this.selectorObserverMap=new Map,this.attributeObserverMap=new Map}start(){this.started||(this.outletDefinitions.forEach(e=>{this.setupSelectorObserverForOutlet(e),this.setupAttributeObserverForOutlet(e)}),this.started=!0,this.dependentContexts.forEach(e=>e.refresh()))}refresh(){this.selectorObserverMap.forEach(e=>e.refresh()),this.attributeObserverMap.forEach(e=>e.refresh())}stop(){this.started&&(this.started=!1,this.disconnectAllOutlets(),this.stopSelectorObservers(),this.stopAttributeObservers())}stopSelectorObservers(){this.selectorObserverMap.size>0&&(this.selectorObserverMap.forEach(e=>e.stop()),this.selectorObserverMap.clear())}stopAttributeObservers(){this.attributeObserverMap.size>0&&(this.attributeObserverMap.forEach(e=>e.stop()),this.attributeObserverMap.clear())}selectorMatched(e,t,{outletName:s}){let n=this.getOutlet(e,s);n&&this.connectOutlet(n,e,s)}selectorUnmatched(e,t,{outletName:s}){let n=this.getOutletFromMap(e,s);n&&this.disconnectOutlet(n,e,s)}selectorMatchElement(e,{outletName:t}){let s=this.selector(t),n=this.hasOutlet(e,t),i=e.matches(`[${this.schema.controllerAttribute}~=${t}]`);return s?n&&i&&e.matches(s):!1}elementMatchedAttribute(e,t){let s=this.getOutletNameFromOutletAttributeName(t);s&&this.updateSelectorObserverForOutlet(s)}elementAttributeValueChanged(e,t){let s=this.getOutletNameFromOutletAttributeName(t);s&&this.updateSelectorObserverForOutlet(s)}elementUnmatchedAttribute(e,t){let s=this.getOutletNameFromOutletAttributeName(t);s&&this.updateSelectorObserverForOutlet(s)}connectOutlet(e,t,s){var n;this.outletElementsByName.has(s,t)||(this.outletsByName.add(s,e),this.outletElementsByName.add(s,t),(n=this.selectorObserverMap.get(s))===null||n===void 0||n.pause(()=>this.delegate.outletConnected(e,t,s)))}disconnectOutlet(e,t,s){var n;this.outletElementsByName.has(s,t)&&(this.outletsByName.delete(s,e),this.outletElementsByName.delete(s,t),(n=this.selectorObserverMap.get(s))===null||n===void 0||n.pause(()=>this.delegate.outletDisconnected(e,t,s)))}disconnectAllOutlets(){for(let e of this.outletElementsByName.keys)for(let t of this.outletElementsByName.getValuesForKey(e))for(let s of this.outletsByName.getValuesForKey(e))this.disconnectOutlet(s,t,e)}updateSelectorObserverForOutlet(e){let t=this.selectorObserverMap.get(e);t&&(t.selector=this.selector(e))}setupSelectorObserverForOutlet(e){let t=this.selector(e),s=new Je(document.body,t,this,{outletName:e});this.selectorObserverMap.set(e,s),s.start()}setupAttributeObserverForOutlet(e){let t=this.attributeNameForOutletName(e),s=new Me(this.scope.element,t,this);this.attributeObserverMap.set(e,s),s.start()}selector(e){return this.scope.outlets.getSelectorForOutletName(e)}attributeNameForOutletName(e){return this.scope.schema.outletAttributeForScope(this.identifier,e)}getOutletNameFromOutletAttributeName(e){return this.outletDefinitions.find(t=>this.attributeNameForOutletName(t)===e)}get outletDependencies(){let e=new z;return this.router.modules.forEach(t=>{let s=t.definition.controllerConstructor;fe(s,"outlets").forEach(i=>e.add(i,t.identifier))}),e}get outletDefinitions(){return this.outletDependencies.getKeysForValue(this.identifier)}get dependentControllerIdentifiers(){return this.outletDependencies.getValuesForKey(this.identifier)}get dependentContexts(){let e=this.dependentControllerIdentifiers;return this.router.contexts.filter(t=>e.includes(t.identifier))}hasOutlet(e,t){return!!this.getOutlet(e,t)||!!this.getOutletFromMap(e,t)}getOutlet(e,t){return this.application.getControllerForElementAndIdentifier(e,t)}getOutletFromMap(e,t){return this.outletsByName.getValuesForKey(t).find(s=>s.element===e)}get scope(){return this.context.scope}get schema(){return this.context.schema}get identifier(){return this.context.identifier}get application(){return this.context.application}get router(){return this.application.router}},st=class{constructor(e,t){this.logDebugActivity=(s,n={})=>{let{identifier:i,controller:o,element:f}=this;n=Object.assign({identifier:i,controller:o,element:f},n),this.application.logDebugActivity(this.identifier,s,n)},this.module=e,this.scope=t,this.controller=new e.controllerConstructor(this),this.bindingObserver=new Ze(this,this.dispatcher),this.valueObserver=new et(this,this.controller),this.targetObserver=new tt(this,this),this.outletObserver=new rt(this,this);try{this.controller.initialize(),this.logDebugActivity("initialize")}catch(s){this.handleError(s,"initializing controller")}}connect(){this.bindingObserver.start(),this.valueObserver.start(),this.targetObserver.start(),this.outletObserver.start();try{this.controller.connect(),this.logDebugActivity("connect")}catch(e){this.handleError(e,"connecting controller")}}refresh(){this.outletObserver.refresh()}disconnect(){try{this.controller.disconnect(),this.logDebugActivity("disconnect")}catch(e){this.handleError(e,"disconnecting controller")}this.outletObserver.stop(),this.targetObserver.stop(),this.valueObserver.stop(),this.bindingObserver.stop()}get application(){return this.module.application}get identifier(){return this.module.identifier}get schema(){return this.application.schema}get dispatcher(){return this.application.dispatcher}get element(){return this.scope.element}get parentElement(){return this.element.parentElement}handleError(e,t,s={}){let{identifier:n,controller:i,element:o}=this;s=Object.assign({identifier:n,controller:i,element:o},s),this.application.handleError(e,`Error ${t}`,s)}targetConnected(e,t){this.invokeControllerMethod(`${t}TargetConnected`,e)}targetDisconnected(e,t){this.invokeControllerMethod(`${t}TargetDisconnected`,e)}outletConnected(e,t,s){this.invokeControllerMethod(`${_e(s)}OutletConnected`,e,t)}outletDisconnected(e,t,s){this.invokeControllerMethod(`${_e(s)}OutletDisconnected`,e,t)}invokeControllerMethod(e,...t){let s=this.controller;typeof s[e]=="function"&&s[e](...t)}};function ss(r){return ns(r,is(r))}function ns(r,e){let t=cs(r),s=os(r.prototype,e);return Object.defineProperties(t.prototype,s),t}function is(r){return fe(r,"blessings").reduce((t,s)=>{let n=s(r);for(let i in n){let o=t[i]||{};t[i]=Object.assign(o,n[i])}return t},{})}function os(r,e){return ls(e).reduce((t,s)=>{let n=as(r,e,s);return n&&Object.assign(t,{[s]:n}),t},{})}function as(r,e,t){let s=Object.getOwnPropertyDescriptor(r,t);if(!(s&&"value"in s)){let i=Object.getOwnPropertyDescriptor(e,t).value;return s&&(i.get=s.get||i.get,i.set=s.set||i.set),i}}var ls=(()=>typeof Object.getOwnPropertySymbols=="function"?r=>[...Object.getOwnPropertyNames(r),...Object.getOwnPropertySymbols(r)]:Object.getOwnPropertyNames)(),cs=(()=>{function r(t){function s(){return Reflect.construct(t,arguments,new.target)}return s.prototype=Object.create(t.prototype,{constructor:{value:s}}),Reflect.setPrototypeOf(s,t),s}function e(){let s=r(function(){this.a.call(this)});return s.prototype.a=function(){},new s}try{return e(),r}catch{return s=>class extends s{}}})();function us(r){return{identifier:r.identifier,controllerConstructor:ss(r.controllerConstructor)}}var nt=class{constructor(e,t){this.application=e,this.definition=us(t),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}get identifier(){return this.definition.identifier}get controllerConstructor(){return this.definition.controllerConstructor}get contexts(){return Array.from(this.connectedContexts)}connectContextForScope(e){let t=this.fetchContextForScope(e);this.connectedContexts.add(t),t.connect()}disconnectContextForScope(e){let t=this.contextsByScope.get(e);t&&(this.connectedContexts.delete(t),t.disconnect())}fetchContextForScope(e){let t=this.contextsByScope.get(e);return t||(t=new st(this,e),this.contextsByScope.set(e,t)),t}},it=class{constructor(e){this.scope=e}has(e){return this.data.has(this.getDataKey(e))}get(e){return this.getAll(e)[0]}getAll(e){let t=this.data.get(this.getDataKey(e))||"";return Hr(t)}getAttributeName(e){return this.data.getAttributeNameForKey(this.getDataKey(e))}getDataKey(e){return`${e}-class`}get data(){return this.scope.data}},ot=class{constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get(e){let t=this.getAttributeNameForKey(e);return this.element.getAttribute(t)}set(e,t){let s=this.getAttributeNameForKey(e);return this.element.setAttribute(s,t),this.get(e)}has(e){let t=this.getAttributeNameForKey(e);return this.element.hasAttribute(t)}delete(e){if(this.has(e)){let t=this.getAttributeNameForKey(e);return this.element.removeAttribute(t),!0}else return!1}getAttributeNameForKey(e){return`data-${this.identifier}-${Xt(e)}`}},at=class{constructor(e){this.warnedKeysByObject=new WeakMap,this.logger=e}warn(e,t,s){let n=this.warnedKeysByObject.get(e);n||(n=new Set,this.warnedKeysByObject.set(e,n)),n.has(t)||(n.add(t),this.logger.warn(s,e))}};function lt(r,e){return`[${r}~="${e}"]`}var ct=class{constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return this.find(e)!=null}find(...e){return e.reduce((t,s)=>t||this.findTarget(s)||this.findLegacyTarget(s),void 0)}findAll(...e){return e.reduce((t,s)=>[...t,...this.findAllTargets(s),...this.findAllLegacyTargets(s)],[])}findTarget(e){let t=this.getSelectorForTargetName(e);return this.scope.findElement(t)}findAllTargets(e){let t=this.getSelectorForTargetName(e);return this.scope.findAllElements(t)}getSelectorForTargetName(e){let t=this.schema.targetAttributeForScope(this.identifier);return lt(t,e)}findLegacyTarget(e){let t=this.getLegacySelectorForTargetName(e);return this.deprecate(this.scope.findElement(t),e)}findAllLegacyTargets(e){let t=this.getLegacySelectorForTargetName(e);return this.scope.findAllElements(t).map(s=>this.deprecate(s,e))}getLegacySelectorForTargetName(e){let t=`${this.identifier}.${e}`;return lt(this.schema.targetAttribute,t)}deprecate(e,t){if(e){let{identifier:s}=this,n=this.schema.targetAttribute,i=this.schema.targetAttributeForScope(s);this.guide.warn(e,`target:${t}`,`Please replace ${n}="${s}.${t}" with ${i}="${t}". The ${n} attribute is deprecated and will be removed in a future version of Stimulus.`)}return e}get guide(){return this.scope.guide}},ut=class{constructor(e,t){this.scope=e,this.controllerElement=t}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return this.find(e)!=null}find(...e){return e.reduce((t,s)=>t||this.findOutlet(s),void 0)}findAll(...e){return e.reduce((t,s)=>[...t,...this.findAllOutlets(s)],[])}getSelectorForOutletName(e){let t=this.schema.outletAttributeForScope(this.identifier,e);return this.controllerElement.getAttribute(t)}findOutlet(e){let t=this.getSelectorForOutletName(e);if(t)return this.findElement(t,e)}findAllOutlets(e){let t=this.getSelectorForOutletName(e);return t?this.findAllElements(t,e):[]}findElement(e,t){return this.scope.queryElements(e).filter(n=>this.matchesElement(n,e,t))[0]}findAllElements(e,t){return this.scope.queryElements(e).filter(n=>this.matchesElement(n,e,t))}matchesElement(e,t,s){let n=e.getAttribute(this.scope.schema.controllerAttribute)||"";return e.matches(t)&&n.split(" ").includes(s)}},ht=class r{constructor(e,t,s,n){this.targets=new ct(this),this.classes=new it(this),this.data=new ot(this),this.containsElement=i=>i.closest(this.controllerSelector)===this.element,this.schema=e,this.element=t,this.identifier=s,this.guide=new at(n),this.outlets=new ut(this.documentScope,t)}findElement(e){return this.element.matches(e)?this.element:this.queryElements(e).find(this.containsElement)}findAllElements(e){return[...this.element.matches(e)?[this.element]:[],...this.queryElements(e).filter(this.containsElement)]}queryElements(e){return Array.from(this.element.querySelectorAll(e))}get controllerSelector(){return lt(this.schema.controllerAttribute,this.identifier)}get isDocumentScope(){return this.element===document.documentElement}get documentScope(){return this.isDocumentScope?this:new r(this.schema,document.documentElement,this.identifier,this.guide.logger)}},dt=class{constructor(e,t,s){this.element=e,this.schema=t,this.delegate=s,this.valueListObserver=new Te(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}start(){this.valueListObserver.start()}stop(){this.valueListObserver.stop()}get controllerAttribute(){return this.schema.controllerAttribute}parseValueForToken(e){let{element:t,content:s}=e;return this.parseValueForElementAndIdentifier(t,s)}parseValueForElementAndIdentifier(e,t){let s=this.fetchScopesByIdentifierForElement(e),n=s.get(t);return n||(n=this.delegate.createScopeForElementAndIdentifier(e,t),s.set(t,n)),n}elementMatchedValue(e,t){let s=(this.scopeReferenceCounts.get(t)||0)+1;this.scopeReferenceCounts.set(t,s),s==1&&this.delegate.scopeConnected(t)}elementUnmatchedValue(e,t){let s=this.scopeReferenceCounts.get(t);s&&(this.scopeReferenceCounts.set(t,s-1),s==1&&this.delegate.scopeDisconnected(t))}fetchScopesByIdentifierForElement(e){let t=this.scopesByIdentifierByElement.get(e);return t||(t=new Map,this.scopesByIdentifierByElement.set(e,t)),t}},ft=class{constructor(e){this.application=e,this.scopeObserver=new dt(this.element,this.schema,this),this.scopesByIdentifier=new z,this.modulesByIdentifier=new Map}get element(){return this.application.element}get schema(){return this.application.schema}get logger(){return this.application.logger}get controllerAttribute(){return this.schema.controllerAttribute}get modules(){return Array.from(this.modulesByIdentifier.values())}get contexts(){return this.modules.reduce((e,t)=>e.concat(t.contexts),[])}start(){this.scopeObserver.start()}stop(){this.scopeObserver.stop()}loadDefinition(e){this.unloadIdentifier(e.identifier);let t=new nt(this.application,e);this.connectModule(t);let s=e.controllerConstructor.afterLoad;s&&s.call(e.controllerConstructor,e.identifier,this.application)}unloadIdentifier(e){let t=this.modulesByIdentifier.get(e);t&&this.disconnectModule(t)}getContextForElementAndIdentifier(e,t){let s=this.modulesByIdentifier.get(t);if(s)return s.contexts.find(n=>n.element==e)}proposeToConnectScopeForElementAndIdentifier(e,t){let s=this.scopeObserver.parseValueForElementAndIdentifier(e,t);s?this.scopeObserver.elementMatchedValue(s.element,s):console.error(`Couldn't find or create scope for identifier: "${t}" and element:`,e)}handleError(e,t,s){this.application.handleError(e,t,s)}createScopeForElementAndIdentifier(e,t){return new ht(this.schema,e,t,this.logger)}scopeConnected(e){this.scopesByIdentifier.add(e.identifier,e);let t=this.modulesByIdentifier.get(e.identifier);t&&t.connectContextForScope(e)}scopeDisconnected(e){this.scopesByIdentifier.delete(e.identifier,e);let t=this.modulesByIdentifier.get(e.identifier);t&&t.disconnectContextForScope(e)}connectModule(e){this.modulesByIdentifier.set(e.identifier,e),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach(s=>e.connectContextForScope(s))}disconnectModule(e){this.modulesByIdentifier.delete(e.identifier),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach(s=>e.disconnectContextForScope(s))}},hs={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target",targetAttributeForScope:r=>`data-${r}-target`,outletAttributeForScope:(r,e)=>`data-${r}-${e}-outlet`,keyMappings:Object.assign(Object.assign({enter:"Enter",tab:"Tab",esc:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",home:"Home",end:"End",page_up:"PageUp",page_down:"PageDown"},Rt("abcdefghijklmnopqrstuvwxyz".split("").map(r=>[r,r]))),Rt("0123456789".split("").map(r=>[r,r])))};function Rt(r){return r.reduce((e,[t,s])=>Object.assign(Object.assign({},e),{[t]:s}),{})}var Ne=class{constructor(e=document.documentElement,t=hs){this.logger=console,this.debug=!1,this.logDebugActivity=(s,n,i={})=>{this.debug&&this.logFormattedMessage(s,n,i)},this.element=e,this.schema=t,this.dispatcher=new Ue(this),this.router=new ft(this),this.actionDescriptorFilters=Object.assign({},Ir)}static start(e,t){let s=new this(e,t);return s.start(),s}async start(){await ds(),this.logDebugActivity("application","starting"),this.dispatcher.start(),this.router.start(),this.logDebugActivity("application","start")}stop(){this.logDebugActivity("application","stopping"),this.dispatcher.stop(),this.router.stop(),this.logDebugActivity("application","stop")}register(e,t){this.load({identifier:e,controllerConstructor:t})}registerActionOption(e,t){this.actionDescriptorFilters[e]=t}load(e,...t){(Array.isArray(e)?e:[e,...t]).forEach(n=>{n.controllerConstructor.shouldLoad&&this.router.loadDefinition(n)})}unload(e,...t){(Array.isArray(e)?e:[e,...t]).forEach(n=>this.router.unloadIdentifier(n))}get controllers(){return this.router.contexts.map(e=>e.controller)}getControllerForElementAndIdentifier(e,t){let s=this.router.getContextForElementAndIdentifier(e,t);return s?s.controller:null}handleError(e,t,s){var n;this.logger.error(`%s

%o

%o`,t,e,s),(n=window.onerror)===null||n===void 0||n.call(window,t,"",0,0,e)}logFormattedMessage(e,t,s={}){s=Object.assign({application:this},s),this.logger.groupCollapsed(`${e} #${t}`),this.logger.log("details:",Object.assign({},s)),this.logger.groupEnd()}};function ds(){return new Promise(r=>{document.readyState=="loading"?document.addEventListener("DOMContentLoaded",()=>r()):r()})}function fs(r){return fe(r,"classes").reduce((t,s)=>Object.assign(t,ps(s)),{})}function ps(r){return{[`${r}Class`]:{get(){let{classes:e}=this;if(e.has(r))return e.get(r);{let t=e.getAttributeName(r);throw new Error(`Missing attribute "${t}"`)}}},[`${r}Classes`]:{get(){return this.classes.getAll(r)}},[`has${de(r)}Class`]:{get(){return this.classes.has(r)}}}}function ms(r){return fe(r,"outlets").reduce((t,s)=>Object.assign(t,gs(s)),{})}function Wt(r,e,t){return r.application.getControllerForElementAndIdentifier(e,t)}function zt(r,e,t){let s=Wt(r,e,t);if(s||(r.application.router.proposeToConnectScopeForElementAndIdentifier(e,t),s=Wt(r,e,t),s))return s}function gs(r){let e=_e(r);return{[`${e}Outlet`]:{get(){let t=this.outlets.find(r),s=this.outlets.getSelectorForOutletName(r);if(t){let n=zt(this,t,r);if(n)return n;throw new Error(`The provided outlet element is missing an outlet controller "${r}" instance for host controller "${this.identifier}"`)}throw new Error(`Missing outlet element "${r}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${s}".`)}},[`${e}Outlets`]:{get(){let t=this.outlets.findAll(r);return t.length>0?t.map(s=>{let n=zt(this,s,r);if(n)return n;console.warn(`The provided outlet element is missing an outlet controller "${r}" instance for host controller "${this.identifier}"`,s)}).filter(s=>s):[]}},[`${e}OutletElement`]:{get(){let t=this.outlets.find(r),s=this.outlets.getSelectorForOutletName(r);if(t)return t;throw new Error(`Missing outlet element "${r}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${s}".`)}},[`${e}OutletElements`]:{get(){return this.outlets.findAll(r)}},[`has${de(e)}Outlet`]:{get(){return this.outlets.has(r)}}}}function ys(r){return fe(r,"targets").reduce((t,s)=>Object.assign(t,vs(s)),{})}function vs(r){return{[`${r}Target`]:{get(){let e=this.targets.find(r);if(e)return e;throw new Error(`Missing target element "${r}" for "${this.identifier}" controller`)}},[`${r}Targets`]:{get(){return this.targets.findAll(r)}},[`has${de(r)}Target`]:{get(){return this.targets.has(r)}}}}function bs(r){let e=es(r,"values"),t={valueDescriptorMap:{get(){return e.reduce((s,n)=>{let i=Jt(n,this.identifier),o=this.data.getAttributeNameForKey(i.key);return Object.assign(s,{[o]:i})},{})}}};return e.reduce((s,n)=>Object.assign(s,Es(n)),t)}function Es(r,e){let t=Jt(r,e),{key:s,name:n,reader:i,writer:o}=t;return{[n]:{get(){let f=this.data.get(s);return f!==null?i(f):t.defaultValue},set(f){f===void 0?this.data.delete(s):this.data.set(s,o(f))}},[`has${de(n)}`]:{get(){return this.data.has(s)||t.hasCustomDefaultValue}}}}function Jt([r,e],t){return xs({controller:t,token:r,typeDefinition:e})}function Se(r){switch(r){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function he(r){switch(typeof r){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}if(Array.isArray(r))return"array";if(Object.prototype.toString.call(r)==="[object Object]")return"object"}function ws(r){let{controller:e,token:t,typeObject:s}=r,n=It(s.type),i=It(s.default),o=n&&i,f=n&&!i,p=!n&&i,y=Se(s.type),D=he(r.typeObject.default);if(f)return y;if(p)return D;if(y!==D){let N=e?`${e}.${t}`:t;throw new Error(`The specified default value for the Stimulus Value "${N}" must match the defined type "${y}". The provided default value of "${s.default}" is of type "${D}".`)}if(o)return y}function As(r){let{controller:e,token:t,typeDefinition:s}=r,i=ws({controller:e,token:t,typeObject:s}),o=he(s),f=Se(s),p=i||o||f;if(p)return p;let y=e?`${e}.${s}`:t;throw new Error(`Unknown value type "${y}" for "${t}" value`)}function Os(r){let e=Se(r);if(e)return Ht[e];let t=Xe(r,"default"),s=Xe(r,"type"),n=r;if(t)return n.default;if(s){let{type:i}=n,o=Se(i);if(o)return Ht[o]}return r}function xs(r){let{token:e,typeDefinition:t}=r,s=`${Xt(e)}-value`,n=As(r);return{type:n,key:s,name:pt(s),get defaultValue(){return Os(t)},get hasCustomDefaultValue(){return he(t)!==void 0},reader:ks[n],writer:Ut[n]||Ut.default}}var Ht={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},ks={array(r){let e=JSON.parse(r);if(!Array.isArray(e))throw new TypeError(`expected value of type "array" but instead got value "${r}" of type "${he(e)}"`);return e},boolean(r){return!(r=="0"||String(r).toLowerCase()=="false")},number(r){return Number(r.replace(/_/g,""))},object(r){let e=JSON.parse(r);if(e===null||typeof e!="object"||Array.isArray(e))throw new TypeError(`expected value of type "object" but instead got value "${r}" of type "${he(e)}"`);return e},string(r){return r}},Ut={default:$s,array:_t,object:_t};function _t(r){return JSON.stringify(r)}function $s(r){return`${r}`}var K=class{constructor(e){this.context=e}static get shouldLoad(){return!0}static afterLoad(e,t){}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get outlets(){return this.scope.outlets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(e,{target:t=this.element,detail:s={},prefix:n=this.identifier,bubbles:i=!0,cancelable:o=!0}={}){let f=n?`${n}:${e}`:e,p=new CustomEvent(f,{detail:s,bubbles:i,cancelable:o});return t.dispatchEvent(p),p}};K.blessings=[fs,ys,bs,ms];K.targets=[];K.outlets=[];K.values={};var Fe=class extends K{get html(){return this.application.element}get dom(){return this.application.element.lastElementChild}controller(e,t){return this.application.controllers.find(({context:s})=>t?s.identifier===e&&s.element.id===t:s.identifier===e)}};var S=typeof window<"u"?window:{screen:{},navigator:{}},oe=(S.matchMedia||function(){return{matches:!1}}).bind(S),Cs=!1,Ms={get passive(){return Cs=!0}},Zt=function(){};S.addEventListener&&S.addEventListener("p",Zt,Ms);S.removeEventListener&&S.removeEventListener("p",Zt,!1);var er="PointerEvent"in S,mt="ontouchstart"in S,Ls="TouchEvent"in S,Ts=mt||Ls&&oe("(any-pointer: coarse)").matches,Qt=(S.navigator.maxTouchPoints||0)>0||Ts,tr=S.navigator.userAgent||"",Ns=oe("(pointer: coarse)").matches&&/iPad|Macintosh/.test(tr)&&Math.min(S.screen.width||0,S.screen.height||0)>=768,Ss=(oe("(pointer: coarse)").matches||!oe("(pointer: fine)").matches&&mt)&&!/Windows.*Firefox/.test(tr),Fs=oe("(any-pointer: fine)").matches||oe("(any-hover: hover)").matches||Ns||!mt,pe=Qt&&(Fs||!Ss)?"hybrid":Qt?"touchOnly":"mouseOnly";var Vs=Object.defineProperty,ur=(r,e)=>{for(var t in e)Vs(r,t,{get:e[t],enumerable:!0})},$=(r,e,t)=>new Promise((s,n)=>{var i=p=>{try{f(t.next(p))}catch(y){n(y)}},o=p=>{try{f(t.throw(p))}catch(y){n(y)}},f=p=>p.done?s(p.value):Promise.resolve(p.value).then(i,o);f((t=t.apply(r,e)).next())}),li="content"in document.createElement("template"),ci=document.createRange&&"createContextualFragment"in document.createRange(),q=er?"pointer":"mouse",k=window.history,be=window.location.origin,F=Object.assign,C=Object.create,Ee=Array.isArray,hr=Array.from,J="",Bs=()=>F(C(null),{selectors:C(null),targets:["body"],timeout:3e4,globalThis:!0,schema:"spx",render:"replace",manual:!1,logs:!0,cache:!0,limit:100,preload:null,async:!0,annotate:!1,eval:{script:null,style:null,link:null,meta:!1},hover:{trigger:"href",threshold:250},intersect:{rootMargin:"0px 0px 0px 0px",threshold:0},proximity:{distance:75,threshold:250,throttle:500},progress:{background:"#111",height:"3px",minimum:.08,easing:"linear",speed:200,trickle:!0,threshold:500,trickleSpeed:200}}),a=Bs(),O=C(null),H=C(null),E=C(null),j=C(null),rr=new Set;function me(r=C(null)){return r.x=window.scrollX,r.y=window.scrollY,r}function Ds(){return new Promise(r=>requestAnimationFrame(()=>r()))}function Ps(){return new Promise(r=>setTimeout(()=>r(),0))}function js(){return Promise.resolve()}function Is(r){let e=document.createElement("textarea");return e.innerHTML=r,e.value}function w(r,e,t){if(r===1&&a.logs===!0)console.info("SPX: "+e);else if(r===2&&a.logs===!0)console.warn("SPX: "+e);else{t?console.error("SPX: "+e,t):console.error("SPX: "+e);try{throw r===3?new TypeError(e):new Error(e)}catch{}}}function A(r,e){return e in r}function Ks(){return Math.random().toString(36).slice(2)}function qs(r=2){return(e,t)=>{let s=e.length;return(s<1||e[s-1].length===r?e.push([t]):e[s-1].push(t))&&e}}function sr(r){return r<1024?r+" B":r<1048576?(r/1024).toFixed(1)+" KB":r<1073741824?(r/1048576).toFixed(1)+" MB":(r/1073741824).toFixed(1)+" GB"}function Q(r,e){if(arguments.length===1)return s=>Q(r,s);let t=e.length;if(t!==0)for(let s=0;s<t;s++)r(e[s],s,e)}function nr(r){for(let e in r)delete r[e]}function Rs(r){return A(r,"hover")&&(r.hover===!1?a.hover=!1:typeof r.hover=="object"&&F(a.hover,r.hover),delete r.hover),A(r,"intersect")&&(r.intersect===!1?a.intersect=!1:typeof r.intersect=="object"&&F(a.intersect,r.intersect),delete r.intersect),A(r,"proximity")&&(r.proximity===!1?a.proximity=!1:typeof r.proximity=="object"&&F(a.proximity,r.proximity),delete r.proximity),A(r,"progress")&&(r.progress===!1?a.progress=!1:typeof r.progress=="object"&&F(a.progress,r.progress),delete r.progress),r}function dr(r={}){F(a,Rs(r)),A(r,"eval")&&F(a.eval,r.eval),a.index=null;let e=a.schema==="spx"?"spx":a.schema.endsWith("-")?a.schema.slice(0,-1):a.schema,t=`:not([${e}-disable]):not([href^="#"])`;a.selectors.morph=`${e}-morph`,a.selectors.render=`${e}-render`,a.selectors.hrefs=a.annotate?`a[${e}-link]${t}`:`a${t}`,a.selectors.tracking=`[${e}-track]:not([${e}-track=false])`,a.selectors.scripts=s("script"),a.selectors.scriptsHydrate=`script[${e}-eval=hydrate]:not([${e}-eval=false])`,a.selectors.styles=s("style"),a.selectors.links=s("link"),a.selectors.metas=s("meta"),a.selectors.evals=`[${e}-eval]:not([${e}-eval=false]):not(script)`,a.selectors.attributes=new RegExp("^href|"+e+"-(hydrate|append|prepend|target|progress|threshold|position|proximity|hover)$","i"),a.selectors.proximity=`a[${e}-proximity]${t}${n("proximity")}`,a.selectors.intersector=`[${e}-intersect]${n("intersect")}`,a.selectors.intersects=`a${t}${n("intersect")}`,a.selectors.hover=a.hover.trigger==="href"?`a${t}${n("hover")}`:`a[${e}-hover]${t}${n("hover")}`,H.bytes=0,H.visits=0,H.limit=a.limit;function s(i){let o=`not([${e}-eval=false])`,f=i==="link"?`${i}[rel=stylesheet]:${o},${i}[rel~=preload]:${o}`:i==="script"?`${i}[${e}-eval]:${o}:not([${e}-eval=hydrate])`:`${i}:${o}`;if(a.eval[i]===!1||a.eval[i]===null)return f;if(a.eval[i]===!0)return`${i}[${e}-eval]:${o}`;if(Ee(a.eval[i]))return a.eval[i].length>0?a.eval[i].map(p=>`${p}:${o}`).join(","):(w(2,`Missing eval ${i} option, SPX will use defaults`),f);w(3,`Invalid eval ${i} option, expected boolean or array`)}function n(i){let o=`:not([${e}-${i}=false]):not([${e}-link])`;if(i.charCodeAt(0)===104)return`${o}:not([${e}-proximity]):not([${e}-intersect])`;if(i.charCodeAt(0)===105)return`${o}:not([${e}-hover]):not([${e}-proximity])`;if(i.charCodeAt(0)===112)return`${o}:not([${e}-intersect]):not([${e}-hover])`}}var Ws=/(?:https?:)?\/\/(?:www\.)?/,zs=/\b(?:append|prepend)/,Hs=/^(?:application|text)\/(?:x-)?(?:ecma|java)script|text\/javascript$/,Us=/^\b(?:true|false)$/i,Ot=/^[+-]?\d*\.?\d+$/,_s=/\s+/g,Xs=/\b(?:intersect|hover|proximity)\b/,ir=/\[?[^,'"[\]()\s]+\]?/g,Ys=/\(?\[(['"]?.*['"]?,?)\]\)?/,Gs=/[xy]:[0-9.]+/,Js=/[xy]|\d*\.?\d+/g,M=be.replace(Ws,J);function Qs(r){let e=C(null);return Q((t,s,n)=>{let i=n.length-1>=s?s-1:s;s%2&&(e[n[i]]=Ot.test(t)?Number(t):t)},r),e}function fr(r,e){let t=e||C(null);for(let{nodeName:s,nodeValue:n}of r.attributes)if(a.selectors.attributes.test(s))if(s==="href")t.rev=location.pathname+location.search,e||(t.location=vt(n),t.key=t.location.pathname+t.location.search);else{let i=s.slice(1+s.lastIndexOf("-")),o=n.replace(_s,J);Ys.test(o)?t[i]=zs.test(i)?o.match(ir).reduce(qs(2),[]):o.match(ir):Gs.test(o)?t[i]=Qs(o.match(Js)):Us.test(o)?Xs.test(s)||(t[i]=o==="true"):Ot.test(o)?t[i]=Number(o):t[i]=o}return t}function ae(r){let e=C(null);if(r.length===1&&r.charCodeAt(0)===47)return e.pathname=r,e.hash=J,e.search=J,e;let t=r.indexOf("#");t>=0?(e.hash=r.slice(t),r=r.slice(0,t)):e.hash=J;let s=r.indexOf("?");return s>=0?(e.search=r.slice(s),r=r.slice(0,s)):e.search=J,e.pathname=r,e}function Ve(r,e){let t=r.indexOf("/",e);if(t>e){let n=r.indexOf("#",t);return n<0?r.slice(t):r.slice(t,n)}let s=r.indexOf("?",e);if(s>e){let n=r.indexOf("#",s);return n<0?r.slice(s):r.slice(s,n)}return r.length-e===M.length?"/":null}function gt(r){let e=r.startsWith("www.")?r.slice(4):r,t=e.indexOf("/");if(t>=0){let s=e.slice(t);if(e.slice(0,t)===M)return s.length>0?ae(s):ae("/")}else{let s=e.search(/[?#]/);if(s>=0){if(e.slice(0,s)===M)return ae("/"+e.slice(s))}else if(e===M)return ae("/")}return null}function Zs(r){return r.startsWith("http")?1:r.startsWith("//")?2:r.startsWith("www.")?3:0}function en(r){if(typeof r!="string"||r.length===0)return!1;if(r.charCodeAt(0)===47)return r.charCodeAt(1)!==47?!0:r.startsWith("www.",2)?r.startsWith(M,6):r.startsWith(M,2);if(r.charCodeAt(0)===63)return!0;if(r.startsWith("www."))return r.startsWith(M,4);if(r.startsWith("http")){let e=r.indexOf("/",4)+2;return r.startsWith("www.",e)?r.startsWith(M,e+4):r.startsWith(M,e)}}function tn(r){return r.charCodeAt(0)===47?r.charCodeAt(1)!==47?ae(r):gt(r.slice(2)):r.charCodeAt(0)===63?ae(location.pathname+r):r.startsWith("https:")||r.startsWith("http:")?gt(r.slice(r.indexOf("/",4)+2)):r.startsWith("www.")?gt(r):null}function re(r){if(typeof r=="object")return r.pathname+r.search;if(r===J)return"/";let e=Zs(r);if(e===1){let t=r.charCodeAt(4)===115?8:7,s=r.startsWith("www.",t)?t+4:t;return r.startsWith(M,s)?Ve(r,s):null}if(e===2){let t=r.startsWith("www.",2)?6:2;return r.startsWith(M,t)?Ve(r,t):null}return e===3?r.startsWith(M,4)?Ve(r,4):null:r.startsWith(M,0)?Ve(r,0):null}function rn(){return{hostname:M,origin:be,pathname:location.pathname,search:location.search,hash:location.hash}}function vt(r){if(r===J)return rn();let e=tn(r);return e.origin=be,e.hostname=M,e}function T(r,e=6){if(r instanceof Element){let s=fr(r);return s.type=e||6,s}let t=C(null);return e===7?(t.location=vt(r),t.key=re(t.location),t.rev=t.key,t.type=e):(t.rev=location.pathname+location.search,t.location=vt(typeof r=="string"?r:t.rev),t.key=re(t.location),t.type=e),t}function xt(r){return new DOMParser().parseFromString(r,"text/html")}function pr(r){let e=r.indexOf(">",r.indexOf("<title"))+1,t=r.indexOf("</title",e);return Is(r.slice(e,t).trim())}var Z=C(null);function R(r,...e){let t=r==="store";t&&e.splice(-1,1,xt(e[e.length-1]));let s=!0;return Q(n=>{let i=n.apply(null,e);t?i instanceof Document?s=i.documentElement.outerHTML:typeof s!="string"&&(s=i!==!1):s=i!==!1},Z[r]||[]),s}function sn(r,e,t){A(Z,r)||(Z[r]=[]),Z[r].push(t?e.bind(t):e)}function nn(r,e){let t=Z[r],s=[];if(t&&e){let n=0,i=t.length;for(;n<i;n++)t[n]!==e&&s.push(t[n])}return s.length?Z[r]=s:delete Z[r],this}function ye(r){r?typeof r=="string"?(delete j[E[r].uuid],delete E[r]):Ee(r)&&Q(e=>{delete j[E[e].uuid],delete E[e]},r):(nr(E),nr(j))}function B(r){return r.target=A(r,"target")?r.target.length===1&&r.target[0]==="body"?r.target:[].concat(a.targets,r.target):a.targets,a.cache&&(A(r,"cache")||(r.cache=a.cache),A(r,"uuid")||(r.uuid=Ks())),A(r,"position")||(r.position=C(null),r.position.y=0,r.position.x=0),a.hover!==!1&&r.type===10&&(A(r,"threshold")||(r.threshold=a.hover.threshold)),a.proximity!==!1&&r.type===12&&(A(r,"proximity")||(r.proximity=a.proximity.distance),A(r,"threshold")||(r.threshold=a.proximity.threshold)),a.progress!==!1&&!A(r,"progress")&&(r.progress=a.progress.threshold),A(r,"render")||(r.render="replace"),A(r,"visits")||(r.visits=0),E[r.key]=r,E[r.key]}function kt(r,e){let t=R("store",r,e),s=typeof t=="string"?t:e;return r.type>5&&(r.type>9?r.type=1:A(E,r.rev)&&(E[r.rev].position.x=scrollX,E[r.rev].position.y=scrollY)),r.title=pr(s),!a.cache||t===!1?r:A(r,"uuid")?(E[r.key]=r,j[r.uuid]=s,R("cached",r),r):X(r,s)}function X(r,e){let t=A(E,r.key)?E[r.key]:B(r);return typeof e=="string"&&(j[t.uuid]=e,r.title=pr(e),r.position=me()),F(t,r)}function on(){let r=k.state.key;if(A(E,r))return E[r];w(4,`No record exists: ${r}`)}function Pe(r){if(!r){if(k.state===null)return;r=k.state.key}if(A(E,r)){let e=C(null);return e.page=E[r],e.dom=xt(j[e.page.uuid]),e}w(4,`No record exists: ${r}`)}function W(r){return A(E,r)&&A(E[r],"uuid")&&A(j,E[r].uuid)&&typeof j[E[r].uuid]=="string"}function $t(r,e){if(!(r instanceof Element))return!1;let t=r.closest(e);return t&&t.tagName==="A"?t:!1}function bt(r){if(r.nodeName!=="A")return!1;let e=r.href;return en(e)?!W(re(e)):!1}function an(r,e){let t=[];return document.body.querySelectorAll(r).forEach(s=>{s.nodeName!=="A"?s.querySelectorAll(e).forEach(n=>{bt(s)&&t.push(n)}):bt(s)&&t.push(s)}),t}var Ct=r=>{let e=[];return document.body.querySelectorAll(r).forEach(t=>{bt(t)&&e.push(t)}),e},le=new Map,U=new Map,ln=class extends XMLHttpRequest{constructor(){super(...arguments),this.key=null}},ee=new Map;function Mt(r,e="text"){return new Promise(function(t,s){let n=new ln;n.key=r,n.responseType=e,n.open("GET",r),n.setRequestHeader("X-SPX","true"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.onload=function(){t(this.response)},n.onerror=function(){s(this.statusText)},n.onabort=function(){U.delete(this.key),ee.delete(this.key),le.delete(this.key)},n.onloadend=function(i){ee.delete(this.key),H.bytes=H.bytes+i.loaded,H.visits=H.visits+1},n.send(),ee.set(r,n)})}function mr(r){return U.has(r)?(clearTimeout(U.get(r)),U.delete(r)):!0}function gr(r,e,t){U.has(r)||W(r)||U.set(r,setTimeout(e,t))}function or(r){return ee.forEach((e,t)=>{r!==t&&(e.abort(),w(2,`Pending request aborted: ${t}`))})}function cn(r){if(a.preload!==null){if(Ee(a.preload)){let e=a.preload.filter(t=>{let s=T(t,3);return s.key!==t?V(B(s)):!1});return Promise.allSettled(e)}else if(typeof a.preload=="object"&&A(a.preload,r.key)){let e=a.preload[r.key].map(function(t){return V(B(T(t,3)))});return Promise.allSettled(e)}}}function yr(r){return $(this,null,function*(){if(W(r))return;let e=B(T(r,4));requestIdleCallback(function(t){V(e).then(s=>{s?w(1,`Reverse fetch completed: ${s.key}`):w(2,`Reverse fetch failed: ${r}`)})},{timeout:3e3})})}function Lt(r){return $(this,null,function*(){if(!le.has(r.key))return r;yield Ps();let e=yield le.get(r.key);return le.delete(r.key),U.delete(r.key),kt(r,e)})}function V(r){return $(this,null,function*(){return ee.has(r.key)&&r.type!==7?(r.type===4&&ee.has(r.rev)?(ee.get(r.rev).abort(),w(2,`Request aborted: ${r.rev}`)):w(2,`Request in transit: ${r.key}`),!1):R("fetch",r)?(le.set(r.key,Mt(r.key)),Lt(r)):(w(2,`Request cancelled via dispatched event: ${r.key}`),!1)})}function vr(r){let e=$t(r.target,a.selectors.hover);if(!e)return;let t=T(e,10);if(W(t.key)||U.has(t.key))return;e.addEventListener(`${q}leave`,br,{once:!0});let s=B(t),n=s.threshold||a.hover.threshold;gr(t.key,function(){R("prefetch",e,t)&&V(s).then(function(i){U.delete(t.key),Er(e)})},n)}function br(r){let e=$t(r.target,a.selectors.hover);e&&mr(re(e.href))}function un(r){r.addEventListener(`${q}enter`,vr)}function Er(r){r.removeEventListener(`${q}enter`,vr),r.removeEventListener(`${q}leave`,br)}function Tt(){!a.hover||O.hover||(Q(un,Ct(a.selectors.hover)),O.hover=!0)}function je(){O.hover&&(Q(Er,Ct(a.selectors.hover)),O.hover=!1)}function hn({clientX:r,clientY:e},t){return r<=t.right&&r>=t.left&&e<=t.bottom&&e>=t.top}function dn(r){let e=r.getBoundingClientRect(),t=r.getAttribute(a.selectors.proximity),s=Ot.test(t)?Number(t):a.proximity.distance;return{target:r,top:e.top-s,bottom:e.bottom+s,left:e.left-s,right:e.right+s}}function fn(r){let e=!1;return function(t){if(e)return;e=!0;let s=r.findIndex(n=>hn(t,n));if(s===-1)setTimeout(()=>{e=!1},a.proximity.throttle);else{let{target:n}=r[s],i=B(T(n,12)),o=i.threshold||a.proximity.threshold;gr(i.key,()=>$(this,null,function*(){if(!R("prefetch",n,i))return ue();(yield V(i))&&(r.splice(s,1),e=!1,r.length===0&&(ue(),w(1,"Proximity observer disconnected")))}),o)}}}var Et;function Nt(){if(!a.proximity||O.proximity)return;let r=Ct(a.selectors.proximity).map(dn);r.length>0&&(Et=fn(r),addEventListener(`${q}move`,Et,{passive:!0}),O.proximity=!0)}function ue(){O.proximity&&(removeEventListener(`${q}move`,Et),O.proximity=!1)}var te;function pn(r){return $(this,null,function*(){if(r.isIntersecting){let e=T(r.target,11);if(!R("prefetch",r.target,e))return te.unobserve(r.target);(yield V(B(e)))?te.unobserve(r.target):(w(2,`Prefetch will retry at next intersect for: ${e.key}`),te.observe(r.target))}})}function St(){if(!a.intersect||O.intersect)return;te||(te=new IntersectionObserver(Q(pn),a.intersect));let r=Q(t=>te.observe(t)),e=an(a.selectors.intersector,a.selectors.intersects);r(e),O.intersect=!0}function Ie(){O.intersect&&(te.disconnect(),O.intersect=!1)}var se=null,wr,ge=null,yt=[];function Ft(r){let{speed:e,easing:t,minimum:s}=a.progress,n=typeof se=="number";r=Or(r,s,1),se=r===1?null:r;let i=mn(!n);i.offsetWidth,yn(o=>{if(i.style.transform=`translate3d(${xr(r)}%,0,0)`,i.style.transition=`all ${e}ms ${t}`,r!==1)return setTimeout(o,e);i.style.transition="none",i.style.opacity="1",i.offsetWidth,setTimeout(()=>{i.style.transition=`all ${e}ms ${t}`,i.style.opacity="0",setTimeout(()=>[gn(),o()],e)},e)})}function Ar(r){let e=se;if(!e)return Vt();if(e<1)return typeof r!="number"&&(e>=0&&e<.2?r=.1:e>=.2&&e<.5?r=.04:e>=.5&&e<.8?r=.02:e>=.8&&e<.99?r=.005:r=0),e=Or(e+r,0,.994),Ft(e)}function mn(r){if(ge)return ge;document.documentElement.classList.add("spx-load");let e=r?"-100":xr(se||0),t=document.createElement("div");return t.id="spx-progress",t.style.pointerEvents="none",t.style.background=a.progress.background,t.style.height=a.progress.height,t.style.position="fixed",t.style.zIndex="9999999",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.transition="all 0 linear",t.style.transform=`translate3d(${e}%,0,0)`,document.body.appendChild(t),ge=t,t}function gn(){document.documentElement.classList.remove("spx-load"),document.getElementById("spx-progress")&&document.body.removeChild(ge),ge=null}function Or(r,e,t){return r<e?e:r>t?t:r}function xr(r){return(-1+r)*100}function yn(r){let e=()=>{let t=yt.shift();t&&t(e)};yt.push(r),yt.length===1&&e()}function Vt(r){a.progress&&(wr=setTimeout(function(){se||Ft(0);function e(){setTimeout(()=>{se&&(Ar(),e())},a.progress.trickleSpeed)}a.progress.trickle&&e()},r||0))}function vn(r){if(clearTimeout(wr),!(!r&&!se))return Ar(.3+.5*Math.random()),Ft(1)}function bn(r){return new Promise((e,t)=>{let s=document.createElement("script");s.addEventListener("error",t,{once:!0}),s.async=!1,s.text=r.target.text;for(let{nodeName:n,nodeValue:i}of r.target.attributes)s.setAttribute(n,i);document.contains(r.target)?r.target.replaceWith(s):(document.head.append(s),r.external?s.addEventListener("load",()=>s.remove(),{once:!0}):s.remove()),r.external&&s.addEventListener("load",()=>e(),{once:!0}),e()})}function En(r){if(!r.hasAttribute("src")&&!r.text)return;let e=r.type?r.type.trim().toLowerCase():"text/javascript",t=Hs.test(e)?1:e==="module"?2:NaN,s=C(null);return s.blocking=!0,s.evaluate=!1,s.external=!1,isNaN(t)||r.noModule&&t===1||(r.src&&(s.external=!0),(t!==1||s.external&&(r.hasAttribute("async")||r.defer))&&(s.blocking=!1),s.evaluate=!0,s.target=r),s}function ar(r){return $(this,null,function*(){try{let e=bn(r);r.blocking&&(yield e)}catch(e){console.error(e)}})}function wn(r){return $(this,null,function*(){let e=hr(r,En).filter(t=>t.evaluate).reduce((t,s)=>$(this,null,function*(){return s.external?Promise.all([t,ar(s)]):(yield t,yield ar(s))}),Promise.resolve());yield Promise.race([e])})}function An(r){return r?r.getAttribute&&r.getAttribute("id")||r.id:void 0}function Be(r,e){let t=r.nodeName,s=e.nodeName;if(t===s)return!0;let n=t.charCodeAt(0),i=s.charCodeAt(0);return n<=90&&i>=97||n<=90&&i>=97?t===s.toUpperCase():!1}function On(r,e){return!e||e==="http://www.w3.org/1999/xhtml"?document.createElement(r):document.createElementNS(e,r)}function xn(r,e){let t=r.firstChild;for(;t;){let s=t.nextSibling;e.appendChild(t),t=s}return e}function kn(r,e){if(e.nodeType===11||r.nodeType===11)return;let t=e.attributes,s,n,i,o,f;for(let y=t.length-1;y>=0;y--)s=t[y],n=s.name,o=s.value,i=s.namespaceURI,i?(n=s.localName||n,f=r.getAttributeNS(i,n),f!==o&&(s.prefix==="xmlns"&&(n=s.name),r.setAttributeNS(i,n,o))):(f=r.getAttribute(n),f!==o&&r.setAttribute(n,o));let p=r.attributes;for(let y=p.length-1;y>=0;y--)s=p[y],n=s.name,o=s.value,i=s.namespaceURI,i?(n=s.localName||n,e.hasAttributeNS(i,n)||r.removeAttributeNS(i,n)):e.hasAttribute(n)||r.removeAttribute(n)}var kr={};ur(kr,{INPUT:()=>Cn,OPTION:()=>$n,SELECT:()=>Mn,TEXTAREA:()=>$r});function wt(r,e,t){r[t]!==e[t]&&(r[t]=e[t],r[t]?r.setAttribute(t,""):r.removeAttribute(t))}function $n(r,e){let t=r.parentNode;if(t){let s=t.nodeName.toUpperCase();s==="OPTGROUP"&&(t=t.parentNode,s=t&&t.nodeName.toUpperCase()),s==="SELECT"&&!t.hasAttribute("multiple")&&(r.hasAttribute("selected")&&!e.selected&&(r.setAttribute("selected","selected"),r.removeAttribute("selected")),t.selectedIndex=-1)}wt(r,e,"selected")}function Cn(r,e){wt(r,e,"checked"),wt(r,e,"disabled"),r.value!==e.value&&(r.value=e.value),e.hasAttribute("value")||r.removeAttribute("value")}function $r(r,e){let t=e.value;r.value!==t&&(r.value=t);let s=r.firstChild;if(s){let n=s.nodeValue;if(n===t||!t&&n===r.placeholder)return;s.nodeValue=t}}function Mn(r,e){if(!e.hasAttribute("multiple")){let t=-1,s=0,n=r.firstChild,i,o;for(;n;)if(o=n.nodeName&&n.nodeName.toUpperCase(),o==="OPTGROUP")i=n,n=i.firstChild;else{if(o==="OPTION"){if(n.hasAttribute("selected")){t=s;break}s++}n=n.nextSibling,!n&&i&&(n=i.nextSibling,i=null)}r.selectedIndex=t}}function De(){}function ve(r,e,t){t||(t={}),e.nodeType===11&&(e=e.firstElementChild);let s=t.getNodeKey||An,n=t.onNodeAdded||De,i=t.onBeforeNodeDiscarded||De,o=t.onNodeDiscarded||De,f=t.onBeforeElChildrenUpdated||De,p=new Map,y=[];function D(g,m){if(g.nodeType===1){let l=g.firstChild;for(;l;){let d;m&&(d=s(l))?y.push(d):l.firstChild&&D(l,m),l=l.nextSibling}}}function N(g,m,l){i(g)!==!1&&(m&&m.removeChild(g),D(g,l))}function Oe(g){if(g.nodeType===1||g.nodeType===11){let m=g.firstChild;for(;m;){let l=s(m);l&&p.set(l,m),Oe(m),m=m.nextSibling}}}Oe(r);function L(g){n(g);let m=g.firstChild;for(;m;){let l=m.nextSibling,d=s(m);if(d){let x=p.get(d);x&&Be(m,x)?(m.parentNode.replaceChild(x,m),Y(x,m)):L(m)}else L(m);m=l}}function ne(g,m,l){for(;m;){let d=m.nextSibling;(l=s(m))?y.push(l):N(m,g,!0),m=d}}function Y(g,m){let l=s(m);l&&p.delete(l),g.isEqualNode(m)!==!0&&g.getAttribute(a.selectors.morph)!=="false"&&(g.getAttribute(a.selectors.morph)!=="children"&&kn(g,m),f(g,m)!==!1&&(g.nodeName!=="TEXTAREA"?u(g,m):$r(g,m)))}function u(g,m){let l=m.firstChild,d=g.firstChild,x,P,ie,xe,G;e:for(;l;){for(xe=l.nextSibling,x=s(l);d;){if(ie=d.nextSibling,l.isSameNode&&l.isSameNode(d)){l=xe,d=ie;continue e}P=s(d);let ke=d.nodeType,I;if(ke===l.nodeType&&(ke===1?(x?x!==P&&((G=p.get(x))?ie===G?I=!1:(g.insertBefore(G,d),P?y.push(P):N(d,g,!0),d=G,P=s(d)):I=!1):P&&(I=!1),I=I!==!1&&Be(d,l),I===!1&&p.has(P)&&p.get(P).getAttribute(a.selectors.morph)==="children"&&(I=!0),I&&Y(d,l)):(ke===3||ke===8)&&(I=!0,d.nodeValue!==l.nodeValue&&(d.nodeValue=l.nodeValue))),I){l=xe,d=ie;continue e}P?y.push(P):N(d,g,!0),d=ie}x&&(G=p.get(x))&&Be(G,l)?(g.appendChild(G),Y(G,l)):(l.actualize&&(l=l.actualize(g.ownerDocument||document)),g.appendChild(l),L(l)),l=xe,d=ie}ne(g,d,P);let Pt=kr[g.nodeName];Pt&&Pt(g,m)}let h=r,v=h.nodeType,c=e.nodeType;if(v===1)c===1?Be(r,e)||(o(r),h=xn(r,On(e.nodeName,e.namespaceURI))):h=e;else if(v===3||v===8){if(c===v)return h.nodeValue!==e.nodeValue&&(h.nodeValue=e.nodeValue),h;h=e}if(h===e)o(r);else{if(e.isSameNode&&e.isSameNode(h))return;if(Y(h,e),y)for(let g=0,m=y.length;g<m;g++){let l=p.get(y[g]);l&&N(l,l.parentNode,!1)}}return h!==r&&r.parentNode&&(h.actualize&&(h=h.actualize(r.ownerDocument||document)),r.parentNode.replaceChild(h,r)),h}function Ln(r,e){return r.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_PRECEDING||-1}function Cr(r,e){return $(this,null,function*(){let t=e===7?a.selectors.scriptsHydrate:a.selectors.scripts,s=hr(r.querySelectorAll(t));yield wn(s.sort(Ln))})}function Tn(r){document.head.querySelectorAll(a.selectors.evals).forEach(e=>{r.head.contains(e)||e.remove()}),document.head.append(...r.querySelectorAll(a.selectors.evals))}function Nn(r){let e=r.querySelectorAll(a.selectors.tracking);if(e!==null)for(let t of e)t.hasAttribute("id")?rr.has(t.id)||(document.body.appendChild(t),rr.add(t.id)):w(2,`Tracked node <${t.tagName.toLowerCase()}> must contain an id attribute`)}function Sn(r,e){let t=r.target,s=r.render;if(t.length===1&&t[0]==="body")s==="morph"?ve(document.body,e.body):s==="replace"?document.body.replaceChildren(e.body):document.body.innerHTML=e.body.innerHTML;else{let n=t.join(","),i=e.body.querySelectorAll(n);document.body.querySelectorAll(n).forEach((o,f)=>{if(o.isEqualNode(i[f])||!R("render",o,i[f]))return;let p=s;if(o.hasAttribute(a.selectors.render)){let y=o.getAttribute(a.selectors.render);y!==p&&(p=y)}if(p==="morph"?ve(o,i[f]):r.render==="replace"?o.replaceWith(i[f]):o.innerHTML=i[f].innerHTML,r.append||r.prepend){let y=document.createElement("div");return e.childNodes.forEach(y.appendChild),r.append?o.appendChild(y):o.insertBefore(y,o.firstChild)}}),Nn(e.body)}}function Fn(r,e){let t=r.hydrate;if(t.length===1&&t[0]==="body"){ve(document.body,e.body);return}let s=t.join(","),n=document.body.querySelectorAll(s),i=r.preserve&&r.preserve.length>0?r.preserve.join(","):null,o=[];if(i&&document.body.querySelectorAll(i).forEach(f=>{f.setAttribute("spx-morph","false"),o.push(f)}),n.length>0){let f=e.body.querySelectorAll(s);n.forEach((p,y)=>{if(f[y]instanceof HTMLElement){if(!R("hydrate",p,f[y]))return;ve(p,f[y])}})}if(i)for(let f of o)f.removeAttribute("spx-morph");Cr(e,7),r.hydrate=void 0,r.preserve=void 0,r.type=6,X(r)}function _(r){return $(this,null,function*(){yield Ds(),je(),Ie(),ue(),document.title=r.title;let e=xt(j[r.uuid]);return r.type===7?Fn(r,e):(Tn(e),Sn(r,e),scrollTo(r.position.x,r.position.y),Cr(e,r.type)),vn(),Tt(),St(),Nt(),R("load",r),r})}var Mr={};ur(Mr,{api:()=>k,connect:()=>Nr,disconnect:()=>Sr,doReverse:()=>Lr,get:()=>Vn,push:()=>Ke,replace:()=>we});function Bt(r){let e=C(null);return e.key=r.key,e.rev=r.rev,e.title=r.title,e.position=r.position,e}function Vn(){return k.state}function Lr(){return k.state!==null&&A(k.state,"rev")&&k.state.key!==k.state.rev}function we(r){return k.replaceState(Bt(r),r.title,r.key),w(1,`ReplaceState triggered for: ${r.key}`),r}function Ke(r){return k.pushState(Bt(r),r.title,r.key),r}function Tr(r){return $(this,null,function*(){if(w(1,"PopState visit incurred"),document.readyState!=="complete"&&(yield js()),r.state!==null)if(W(r.state.key))yr(r.state.rev),yield _(E[r.state.key]);else{r.state.type=5;let e=yield V(r.state);if(!e)return location.assign(r.state.key);let t=re(location);if(e.key===t)yield _(e);else if(W(t))yield _(E[t]);else{let s=B(T(t,5));yield V(s),k.pushState(s,document.title,t)}}})}function Nr(r){O.history||(k.scrollRestoration&&(k.scrollRestoration="manual"),k.state===null&&r&&k.replaceState(Bt(r),r.title,r.key),addEventListener("popstate",Tr,!1),O.history=!0)}function Sr(){O.history&&(k.scrollRestoration&&(k.scrollRestoration="auto"),removeEventListener("popstate",Tr,!1),O.history=!1)}function Bn(r){return!(r.target&&r.target.isContentEditable||r.defaultPrevented||r.which>1||r.altKey||r.ctrlKey||r.metaKey||r.shiftKey)}function ce(r){if(!Bn(r))return;let e=$t(r.target,a.selectors.hrefs);if(!e)return;let t=re(e.href);if(t!==null&&R("visit",r))if(je(),ue(),Ie(),W(t)){let s=fr(e,E[t]),n=X(s);e.addEventListener("click",function(i){i.preventDefault(),E[n.rev].position=me(),Ke(n),_(n)},{once:!0})}else if(le.has(t)){let s=E[t];or(t),w(1,`Request in transit: ${t}`),e.addEventListener("click",function(n){n.preventDefault(),E[s.rev].position=me(),At(s)},{once:!0})}else{or(),mr(t);let s=T(e,6),n=B(s);V(n),e.addEventListener("click",function(i){i.preventDefault(),E[n.rev].position=me(),At(n)},{once:!0})}}function At(r){return $(this,null,function*(){Vt(r.progress);let e=yield Lt(r);if(e)Ke(e),_(e);else return location.assign(r.key)})}function lr(r,e){return $(this,null,function*(){if(e){typeof e.cache=="string"&&(e.cache==="clear"?ye():ye(e.key)),Vt(e.progress);let t=yield V(e);t?(Ke(t),_(t)):location.assign(e.key)}else return At(E[r])})}function Dn(){O.hrefs||(pe==="mouseOnly"?addEventListener(`${q}down`,ce,!1):(pe==="touchOnly"||addEventListener(`${q}down`,ce,!1),addEventListener("touchstart",ce,!1)),O.hrefs=!0)}function Pn(){O.hrefs&&(pe==="mouseOnly"?removeEventListener(`${q}down`,ce,!1):(pe==="touchOnly"||removeEventListener(`${q}down`,ce,!1),removeEventListener("touchstart",ce,!1)),O.hrefs=!1)}var cr=C(null);function jn(r){scrollY in cr&&we(E[cr[scrollY]])}function In(){O.scroll||(addEventListener("scroll",jn,{passive:!0}),O.scroll=!0)}function Kn(){let r=B(T(0));Nr(r),a.index=r.key;function e(){Dn(),a.manual===!1&&(Tt(),St(),Nt(),In());let t=kt(r,document.documentElement.outerHTML);return Lr()&&(t.rev=k.state.rev),t.position=me(),we(t),t.rev!==t.key&&setTimeout(()=>yr(t.rev),0),setTimeout(()=>cn(t),0),t}return new Promise(t=>{if(document.readyState==="complete"||document.readyState==="interactive")return t(e());addEventListener("DOMContentLoaded",()=>t(e()),{once:!0})})}function qn(){je(),Tt(),Ie(),St(),ue(),Nt()}function Rn(){Sr(),Pn(),je(),Ie(),ue(),ye(),a.globalThis&&delete window.spx,w(1,"Disconnected \u{1F614}")}var Fr=!!(window.history.pushState&&window.requestAnimationFrame&&window.addEventListener&&window.DOMParser),Vr=F(C(null),{supported:Fr,on:sn,off:nn,observe:qn,history:Mr,connect:Wn,capture:Yn,render:Xn,session:zn,state:Hn,reload:Un,fetch:_n,clear:ye,hydrate:Jn,prefetch:Gn,visit:Qn,disconnect:Rn,get config(){return a}});function Wn(r={}){if(typeof document>"u")return w(4,"SPX only runs in the browser");if(!Fr)return w(4,"Browser does not support SPX");if(!window.location.protocol.startsWith("http"))return w(4,"Invalid protocol, SPX expects https or http protocol");dr(r);let e=Kn();return function(t){return $(this,null,function*(){let s=yield e;if(a.globalThis&&Object.defineProperty(window,"spx",{get(){return Vr}}),t.constructor.name==="AsyncFunction")try{yield t(s)}catch(n){w(2,"Connection Error",n)}else t(s);w(1,"Connection Established \u26A1")})}}function zn(r,e){if(r)if(e)r==="config"&&dr(e),r==="observers"&&F(O,e);else{if(r==="config")return a;if(r==="observers")return O;if(r==="pages")return E;if(r==="snapshots")return j;if(r==="memory")return sr(H.bytes)}let t=C(null);return t.config=a,t.snapshots=j,t.pages=E,t.observers=O,t.memory=H,t.memory.size=sr(t.memory.bytes),t}function Hn(r,e){if(r===void 0)return Pe();if(typeof r=="string"){let t=re(r);W(t)||w(4,`No store exists at: ${t}`);let s=Pe(t);return e!==void 0?X(F(s.page,e)):s}if(typeof r=="object")return X(r)}function Un(){return $(this,null,function*(){let r=E[k.state.key];r.type=9;let e=yield V(r);return e?(w(1,"Triggered reload, page was re-cached"),_(e)):(w(2,"Reload failed, triggering refresh (cache will be purged)"),location.assign(r.key))})}function _n(r){return $(this,null,function*(){let e=T(r,2);e.location.origin!==be&&w(4,"Cross origin fetches are not allowed");let t=yield Mt(e.key);if(t)return t})}function Xn(r,e,t){return $(this,null,function*(){let s=on(),n=T(r);n.location.origin!==be&&w(4,"Cross origin fetches are not allowed");let i=yield Mt(n.key,"document");if(i||w(4,`Fetch failed for: ${n.key}`,i),yield t.call(s,i),e==="replace"){s.title=i.title;let o=X(F(s,n),i.documentElement.outerHTML);return we(o),o}else return _(kt(n,i.documentElement.outerHTML))})}function Yn(r){let{page:e,dom:t}=Pe();if(r=Ee(r)?r:e.target,r.length===1&&r[0]==="body"){t.body.replaceChildren(document.body),X(e,t.documentElement.innerHTML);return}let s=r.join(","),n=document.body.querySelectorAll(s);t.body.querySelectorAll(s).forEach((i,o)=>{ve(i,n[o])}),X(e,t.documentElement.innerHTML)}function Gn(r){return $(this,null,function*(){let e=T(r,1);if(W(e.key)){w(2,`Cache already exists for ${e.key}, prefetch skipped`);return}let t=yield V(B(e));if(t)return t;w(4,`Prefetch failed for ${e.key}`)})}function Jn(r,e){return $(this,null,function*(){let t=T(r,7);if(V(t),Ee(e)){t.hydrate=[],t.preserve=[];for(let n of e)n.charCodeAt(0)===33?t.preserve.push(n.slice(1)):t.hydrate.push(n)}else t.hydrate=a.targets;let s=yield Lt(t);if(s){let{key:n}=k.state;if(we(s),_(s),t.key!==n){a.index===n&&(a.index=t.key);for(let i in E)E[i].rev===n&&(E[i].rev=t.key);ye(n)}}return Pe(s.key).dom})}function Qn(r,e){return $(this,null,function*(){let t=T(r),s=typeof e=="object"?F(t,e):t;return W(t.key)?lr(t.key,X(s)):lr(t.key,B(s))})}var Ae=Vr;var b=function(r){if(Array.isArray(r))return r.forEach(b);if(!("id"in r)){for(let s of["onenter","onexit","oninit","onresize"])if(s in r)throw new Error('qvp: Missing an "id" reference');return Object.entries(r).forEach(([s,n])=>{let i=typeof r[s];if(i==="string")return b({id:s,query:n});throw new TypeError(`qvp: Invalid query type. Expected "string" received "${i}"`)})}let e=Zn(r),{id:t}=e.screen;b.viewports.size||addEventListener("resize",Br(()=>{b.viewports.forEach(s=>{s.screen.active&&s.onresize(window.innerWidth)})},25),!0),b.viewports.has(t)?console.warn(`qvp: The id "${t}" is already defined, use qvp.add() instead.`):b.viewports.set(t,e)};b.viewports=new Map;Object.defineProperty(b,"isTouch",{get(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}});b.get=r=>b.viewports.has(r)?b.viewports.get(r):!1;b.add=(r,e)=>{let t=b.get(r);if(t===!1)return console.error(`qvp: There is no viewport using an id of "${r}"`);Re(e,t.screen),t.screen.test.matches&&t.onenter()};b.off=(r,e)=>{let t=b.get(r.split(":")[0]);if(t===!1||!(r in t.events))return;let s=t.events[r].length;if(typeof e=="number")e<=s-1&&t.events[r].splice(e,1);else if(typeof e=="function"){let n=[];for(let i=0;i<s;i++)t.events[r][i]!==e&&n.push(t.events[r][i]);n.length>0&&(t.events[r]=n)}else delete t.events[r]};b.on=(r,e,t)=>{let[s,n]=r.split(":"),i=b.get(s);if(i===!1)return;r in i.events||(i.events[r]=[]);let o=t?e.bind(t):e;return o["qvp:event"]=i.events[r].length,i.events[r].push(o),i.screen.test.matches?n==="oninit"?o.call():(n==="onenter"&&o.call(),Re({[n]:o},i.screen)):Re({[n]:o},i.screen),o["qvp:event"]};b.list=r=>{let e=Array.from(b.viewports.values()).map(({screen:t})=>t);return r?e.filter(({id:t})=>r.includes(t)):e};b.active=r=>{let e=b.list();if(r){let s=b.get(r);return s?s.screen.active:!1}let t=e.filter(({active:s})=>s===!0);return t.length>1?t:t[0]};b.test=(r,e=",")=>typeof r=="string"?r.indexOf(e)>-1?r.split(e).some(b.active):!!b.active(r):r.some(b.active);b.remove=r=>{b.viewports.has(r)&&(b.viewports.get(r).destroy(),b.viewports.delete(r))};b.destroy=()=>{removeEventListener("resize",Br()),b.viewports.forEach(r=>r.destroy()),b.viewports.clear()};b.screens=()=>{throw Error("qvp: The qvp.screens() is deprecated, use the default import, e.g: qvp(...)")};function Br(r,e){let t=e;return function(){let s=()=>{t=null,r.apply(this,arguments)};t&&cancelAnimationFrame(t),t=requestAnimationFrame(s)}}function Re(r,e){typeof r.onenter=="function"&&("qvp:event"in r.onenter||(r.onenter["qvp:event"]=NaN),e.onenter.add(r.onenter)),typeof r.onexit=="function"&&("qvp:event"in r.onexit||(r.onexit["qvp:event"]=NaN),e.onexit.add(r.onexit)),typeof r.onresize=="function"&&("qvp:event"in r.onresize||(r.onresize["qvp:event"]=NaN),e.onresize.add(r.onresize)),typeof r.oninit=="function"&&("qvp:event"in r.oninit||(r.oninit["qvp:event"]=NaN),e.oninit.add(r.oninit))}function qe(r,...e){let t=b.get(r.split(":")[0]);if(t!==!1&&r in t.events)for(let s=0;s<t.events[r].length&&(t.events[r][s].apply(null,e),r.endsWith(":oninit")&&b.off(r,s),r in t.events);s++);}function Zn(r){let e=r.query||"all",t={id:r.id,query:e,active:!1,test:matchMedia(e),onenter:new Set,onexit:new Set,onresize:new Set,oninit:new Set,events:Object.create(null)};Re(r,t);let s=()=>{t.oninit.size>0&&(t.oninit.forEach(p=>!isNaN(p["qvp:event"])||p()),qe(`${r.id}:oninit`),t.oninit.clear()),t.onenter.forEach(p=>!isNaN(p["qvp:event"])||p()),qe(`${r.id}:onenter`),t.active=!0},n=()=>{t.onexit.forEach(p=>!isNaN(p["qvp:event"])||p()),qe(`${r.id}:onexit`),t.active=!1},i=p=>{t.onresize.forEach(y=>!isNaN(y["qvp:event"])||y()),qe(`${r.id}:onresize`,p)},o=({matches:p})=>p?s():n(),f=()=>{for(let p in t.events)delete t.events[p];t.test.removeEventListener("change",o)};return t.test.addEventListener("change",o),t.test.matches&&s(),{onenter:s,onexit:n,onresize:i,destroy:f,get screen(){return t},get events(){return t.events}}}var Dr=b;var We=class r extends Fe{constructor(){super(...arguments);this.transition=t=>{if(t.propertyName==="transform"){if(this.hasShiftValue)for(let s of this.shifts)s.classList.contains(this.shiftClass)&&(s.classList.remove(this.shiftClass),s.style.removeProperty("transform"));this.hasBackdropClass&&this.backdrop.classList.contains(this.backdropClass)&&this.backdrop.classList.remove(this.backdropClass),this.modeValue==="pull"?this.shifts.item(0).removeEventListener(t.type,this.transition):this.target.removeEventListener(t.type,this.transition)}};this.outsideClick=t=>{t.target!==this.target&&(this.close(),document.documentElement.removeEventListener("click",this.outsideClick,!1))};this.toggle=t=>(t&&t.preventDefault(),this.isOpenValue=!this.isOpenValue,this.isOpenValue?this.open():this.close(),this.isOpenValue?this.open():this.close());this.touchMove=t=>{this.isOpenValue&&this.target.scrollHeight<=this.target.clientHeight&&t.preventDefault()};this.keyboard=t=>{switch(t.code){case"Esc":case"Escape":this.close();break}}}static{this.values={outsideClick:Boolean,height:String,width:String,offset:String,direction:String,shift:String,redraw:String,useParent:{type:Boolean,default:!1},isOpen:{type:Boolean,default:!1},bodyScroll:{type:Boolean,default:!1},backdrop:{type:Boolean,default:!0},mode:{type:String,default:"overlay"}}}static{this.targets=["mount"]}static{this.classes=["backdrop"]}get backdrop(){return r.backdrop}get directionClass(){return`drawer-${this.directionValue}`}get shiftClass(){return`drawer-${this.modeValue}`}get shifts(){return document.documentElement.querySelectorAll(this.shiftValue)}get buttons(){return document.documentElement.querySelectorAll(`[data-drawer="${this.target.id}"]`)}initialize(){r.backdrop||(r.backdrop=document.createElement("div"),r.backdrop.className="drawer-backdrop",r.backdrop.setAttribute("spx-morph","false")),this.useParentValue?(this.target=this.element.parentElement,this.target.ariaHidden="true"):this.target=this.element,this.target.classList.contains("d-none")&&this.target.classList.remove("d-none"),this.modeValue!=="overlay"&&this.hasShiftValue===!1&&console.error('Missing "data-drawer-shift-value" defintions on:',this.target)}connect(){for(let t of this.buttons)t.addEventListener("click",this.toggle);document.documentElement.contains(r.backdrop)===!1&&document.documentElement.appendChild(r.backdrop),this.hasWidthValue&&this.target.style.setProperty("width",this.widthValue),this.hasHeightValue&&this.target.style.setProperty("height",this.heightValue),this.hasDirectionValue&&this.target.classList.contains(this.directionClass)===!1&&this.target.classList.add(this.directionClass),this.modeValue==="pull"&&(this.target.style.setProperty("transform","translateX(0)"),this.target.style.setProperty("z-index","0")),this.html.classList.contains("drawer-open")&&this.html.classList.remove("drawer-open"),Ae.on("load",this.onLoad,this)}disconnect(){}onLoad(){this.isOpenValue&&(Dr.test(["lg","xl","xxl"])?this.close():setTimeout(this.close.bind(this),200))}open(){this.target.classList.contains("drawer-active")||this.target.classList.add("drawer-active"),this.hasBackdropClass&&!this.backdrop.classList.contains(this.backdropClass)&&this.backdrop.classList.add(this.backdropClass),this.bodyScrollValue===!1&&document.documentElement.style.setProperty("overflow","hidden"),this.hasShiftValue&&this.shiftNodes(),this.hasWidthValue&&(this.directionValue==="top"?this.backdrop.style.setProperty("transform",`translateY(-${this.offsetValue})`):this.backdrop.style.setProperty("transform",`translateX(-${this.widthValue})`)),this.html.classList.add("drawer-open"),this.backdrop.addEventListener("click",this.toggle,{once:!0}),this.target.addEventListener("touchstart",this.touchStart,{passive:!0}),this.target.ariaHidden="false"}close(){this.isOpenValue&&(this.isOpenValue=!1),this.hasWidthValue&&this.backdrop.style.removeProperty("transform"),this.bodyScrollValue===!1&&document.documentElement.style.removeProperty("overflow"),this.hasShiftValue?this.shiftNodes():this.target.addEventListener("transitionend",this.transition),this.html.classList.remove("drawer-open"),this.target.removeEventListener("touchstart",this.touchStart),this.backdrop.removeEventListener("click",this.toggle),this.target.classList.remove("drawer-active"),this.target.ariaHidden="true"}shiftNodes(){this.modeValue==="pull"?(this.target.style.setProperty("transform","translateX(0)"),this.target.style.setProperty("z-index","0"),this.isOpenValue===!1&&this.shifts.item(0).addEventListener("transitionend",this.transition)):this.isOpenValue===!1&&this.target.addEventListener("transitionend",this.transition);for(let t of this.shifts)this.isOpenValue?(t.classList.contains(this.shiftClass)||t.classList.add(this.shiftClass),this.hasWidthValue&&(this.directionValue==="left"||this.directionValue==="right")?t.style.setProperty("transform",`translateX(-${this.widthValue})`):this.hasHeightValue&&(this.directionValue==="top"||this.directionValue==="bottom")&&t.style.setProperty("transform",`translateY(-${this.heightValue})`)):this.hasWidthValue&&(this.directionValue==="left"||this.directionValue==="right")?t.style.setProperty("transform","translateX(0)"):this.hasHeightValue&&(this.directionValue==="top"||this.directionValue==="bottom")&&t.style.setProperty("transform","translateY(0)")}touchStart({target:t}){if(t instanceof HTMLElement){let{scrollTop:s,offsetHeight:n}=t,i=s+n;s===0?t.scrollTop=1:i===s&&(t.scrollTop=s-1)}}};var Dt=class extends K{static{this.targets=[""]}connect(){}};Ae.connect({targets:["#main"],render:"replace"})(function(){let r=Ne.start();r.register("control",Dt),r.register("drawer",We),ze()});Ae.on("load",()=>{ze()});
