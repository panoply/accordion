var Pr=class extends Array{constructor(){super(...arguments),this.refs=Object.create(null)}get(t){let e=typeof t;if(e==="number")return this[t];if(e==="string"){if(t in this.refs)return this[this.refs[t]];throw new Error(`Relapse: No fold using an id value of: ${t}`)}else if(e==="undefined")return this}};function jr(t){function e(s,i,o){let a=t[s]||[],c=a.length,u=null;for(let C=0;C<c;C++){let j=a[C].apply(i,[o]);u===null&&j===!1&&(u=!0)}return u}function r(s,i){t[s]||(t[s]=[]),t[s].push(i)}function n(s,i){let o=[],a=t[s];if(a&&i)for(let c=0,u=a.length;c<u;c++)a[c]!==i&&o.push(a[c]);o.length?a[s]=o:delete a[s]}return{on:r,off:n,emit:e}}function Ir(t,e){let{classes:r}=t.config;return function(n){let s=o=>{if(typeof o!="number")return t.active!==n.index&&(t.active=n.index),n;if(t.folds.get(o))return t.active=n.index,t.folds.get(o);throw new Error(`relapse: No fold exists at index: ${o}`)},i=o=>{o.button.ariaDisabled="false",o.button.ariaExpanded="false",o.element.classList.remove(r.expanded),o.expanded=!1,o.button.classList.contains(r.initial)&&o.button.classList.remove(r.initial),o.element.style.setProperty("max-height","0"),t.parent!==null&&t.parent.style.setProperty("max-height",`${t.parent.scrollHeight-o.height}px`),t.folds.length-1===o.index?o.element.addEventListener("transitionend",function a(){o.expanded||(o.element.style.setProperty("opacity","0"),o.element.style.setProperty("visibility","hidden"),o.button.classList.remove(r.opened)),o.element.removeEventListener("transitionend",a)}):(o.element.style.setProperty("opacity","0"),o.element.style.setProperty("visibility","hidden"),o.button.classList.remove(r.opened))};n.open=function(o){let a=s(o);a.expanded||(a.close(),a.height=a.element.scrollHeight,a.button.ariaDisabled="true",a.button.ariaExpanded="true",a.button.classList.add(r.opened),a.element.classList.add(r.expanded),a.element.style.setProperty("max-height",`${a.height}px`),a.element.style.setProperty("opacity","1"),a.element.style.setProperty("visibility","visible"),t.parent!==null&&t.parent.style.setProperty("max-height",`${t.parent.scrollHeight+a.height}px`),a.expanded=!0,a.disable(),t.count=t.folds.filter(({expanded:c})=>c).length,e.emit("expand",t,a))},n.close=function(o){let a=s(o);if(t.config.multiple)(t.config.persist===!1||t.config.persist&&t.count>1)&&i(a);else for(let c of t.folds.values())if(c.expanded===!0){if(t.config.persist&&c.index===a.index)break;i(c),a=c;break}a.enable(),t.count=t.folds.filter(({expanded:c})=>c).length,e.emit("collapse",t,a)},n.focus=function(){t.active=n.index,n.button.classList.add(r.focused),e.emit("focus",t,n)},n.blur=function(){n.button.classList.remove(r.focused)},n.enable=function(o){let a=s(o);a.disabled&&(a.disabled=!1,a.button.ariaDisabled="false",a.button.classList.remove(r.disabled))},n.disable=function(o){let a=s(o);a.disabled||(a.expanded?t.config.persist&&(a.disabled=!0,a.button.ariaDisabled="true"):(a.close(),a.disabled=!0,a.button.ariaDisabled="true",a.button.classList.add(r.disabled)))},n.toggle=function(){if(e.emit("toggle",t,n)!==!1)return n.expanded?n.close():n.open()},n.destroy=function(o=!1){n.close(),n.button.removeEventListener("click",n.toggle),n.button.removeEventListener("focus",n.focus),n.button.removeEventListener("blur",n.blur),o&&(t.element.removeChild(n.element),t.element.removeChild(n.button))},n.button.addEventListener("click",n.toggle),n.button.addEventListener("focus",n.focus),n.button.addEventListener("blur",n.blur),n.element.hasAttribute("id")?(t.folds.push(n),t.folds.refs[n.element.id]=t.folds.length-1):t.folds.push(n)}}var Kr=t=>{let e=Object.create(null);if(e.persist=!0,e.multiple=!1,e.parent=null,e.schema="data-relapse",e.duration=225,e.classes=Object.create(null),e.classes.initial="initial",e.classes.opened="opened",e.classes.disabled="disabled",e.classes.expanded="expanded",e.classes.focused="focused",typeof t=="object")for(let r in t)if(r==="classes")for(let n in t[r])e.classes[n]=t[r][n];else e[r]=t[r];return e};function qr(t,e){let r=t.schema.length+1;for(let{nodeName:n,nodeValue:s}of e){if(!n.startsWith(t.schema))continue;let i=n.slice(r),o=s.trim();if(i==="persist"||i==="multiple")if(o==="true"||o==="false")t[i]=o==="true";else throw new TypeError(`relapse: Invalid ${n} attribute value. Boolean expected, received: ${o}`);else if(i==="duration"){if(isNaN(+o))throw new TypeError(`relapse: Invalid ${n} attribute value. Number expected, received: ${o}`);t[i]=+o}}return t}function Rr(t){let e=t.duration/2;return`will-change:visibility,opacity,max-height;overflow:hidden;transition:visibility ${e}ms linear,opacity ${e}ms linear,max-height ${t.duration}ms ease-in-out;`}var jt=function t(e,r){let n=typeof e=="string"||typeof e=="object"&&"tagName"in e;if(n&&e instanceof NodeList)throw TypeError("relapse: Invalid selector, NodeList is not supported, pass string or Element");let s=Kr(n?r:e),i=null;if(n)typeof e=="string"?i=document.body.querySelector(e):i=e;else for(let w of document.body.querySelectorAll(`[${s.schema}]`))t(w,r);if(i===null)return;window.relapse instanceof Map||(window.relapse=new Map);let o=Object.create(null);o.events=Object.create(null),o.folds=new Pr,o.element=i,o.id=`R${window.relapse.size}`,o.count=0,o.config=qr(s,o.element.attributes),o.parent=o.config.parent;let a=null;i.hasAttribute(o.config.schema)?a=i.getAttribute(o.config.schema):"id"in i&&(a=i.id),a===null&&window.relapse.has(a)===!0&&(a=Math.random().toString(36).slice(2)),o.element.ariaMultiSelectable=`${o.config.multiple}`;let c=i.children,u=c.length,C=jr(o.events),j=Ir(o,C),{classes:T}=o.config,Y=isNaN(o.config.duration)||o.config.duration===-1?null:Rr(o.config);for(let w=0;w<u;w=w+2){let g=c[w],v=c[w+1],y=Object.create(null);y.index=o.folds.length;let he=g.classList.contains(T.initial),f=g.classList.contains(T.opened),d=g.classList.contains(T.disabled),h=v.classList.contains(T.expanded);g.ariaExpanded==="true"||f||h||he?(f?g.ariaExpanded="true":g.classList.add(T.opened),he||g.classList.remove(T.initial),h||v.classList.add(T.expanded),d&&(g.classList.add(T.disabled),g.ariaDisabled="true",y.disabled=!0),y.expanded=!0):g.ariaDisabled==="true"||d?(y.disabled=!0,d?g.ariaDisabled="true":g.classList.add(T.disabled),h?(y.expanded=!0,g.ariaExpanded="true"):(y.expanded=!1,g.ariaExpanded="false"),f&&g.classList.remove(T.opened)):(y.expanded=!1,y.disabled=!1,g.ariaExpanded="false",g.ariaDisabled="false"),"id"in g&&(y.id=g.id),"id"in v&&(y.id=v.id),"id"in y||(y.id=`${o.id}F${y.index}`,g.id=`B${y.id}`,v.id=`C${y.id}`),g.setAttribute("aria-controls",y.id),v.setAttribute("aria-labelledby",g.id),v.setAttribute("role","region"),Object.defineProperties(y,{button:{get(){return g}},element:{get(){return v}}}),y.expanded?(o.count=o.count+1,y.element.style.cssText=Y!==null?`max-height:${y.element.scrollHeight}px;opacity:1;visibility:visible;${Y}`:`max-height:${y.element.scrollHeight}px;opacity:1;visibility:visible;`):y.element.style.cssText=Y!==null?`max-height:0px;opacity:0;visibility:hidden;${Y}`:"max-height:0px;opacity:0;visibility:hidden;",j(y),window.relapse.set(a,null);for(let E of y.element.querySelectorAll(`[${o.config.schema}]`))t(E,{parent:y.element})}let ue=(w,g,v=!1)=>{if(typeof g=="number")return w.charCodeAt(0)===100?o.folds[g][w](v):o.folds[g][w]();if(typeof g=="string"){for(let y of o.folds.values())if(y.button.dataset[`${o.config.schema}-fold`]===g)return w.charCodeAt(0)===100?y[w](v):y[w]()}throw new Error(`relapse: Fold does not exist: "${g}"`)};return o.on=C.on,o.off=C.off,o.collapse=w=>ue("close",w),o.expand=w=>ue("open",w),o.destroy=(w,g=!1)=>{if(typeof w>"u")for(let v of o.folds.values())v.destroy();else ue("destroy",w,g);o.element.removeAttribute("aria-multiselectable"),C.emit("destroy",o),window.relapse.delete(a)},window.relapse.set(a,o),n?o:Array.from(window.relapse.values())};jt.get=t=>t?window.relapse.get(t):window.relapse;var ze=jt;var He=class{constructor(e,r,n){this.eventTarget=e,this.eventName=r,this.eventOptions=n,this.unorderedBindings=new Set}connect(){this.eventTarget.addEventListener(this.eventName,this,this.eventOptions)}disconnect(){this.eventTarget.removeEventListener(this.eventName,this,this.eventOptions)}bindingConnected(e){this.unorderedBindings.add(e)}bindingDisconnected(e){this.unorderedBindings.delete(e)}handleEvent(e){let r=Wr(e);for(let n of this.bindings){if(r.immediatePropagationStopped)break;n.handleEvent(r)}}hasBindings(){return this.unorderedBindings.size>0}get bindings(){return Array.from(this.unorderedBindings).sort((e,r)=>{let n=e.index,s=r.index;return n<s?-1:n>s?1:0})}};function Wr(t){if("immediatePropagationStopped"in t)return t;{let{stopImmediatePropagation:e}=t;return Object.assign(t,{immediatePropagationStopped:!1,stopImmediatePropagation(){this.immediatePropagationStopped=!0,e.call(this)}})}}var Ue=class{constructor(e){this.application=e,this.eventListenerMaps=new Map,this.started=!1}start(){this.started||(this.started=!0,this.eventListeners.forEach(e=>e.connect()))}stop(){this.started&&(this.started=!1,this.eventListeners.forEach(e=>e.disconnect()))}get eventListeners(){return Array.from(this.eventListenerMaps.values()).reduce((e,r)=>e.concat(Array.from(r.values())),[])}bindingConnected(e){this.fetchEventListenerForBinding(e).bindingConnected(e)}bindingDisconnected(e,r=!1){this.fetchEventListenerForBinding(e).bindingDisconnected(e),r&&this.clearEventListenersForBinding(e)}handleError(e,r,n={}){this.application.handleError(e,`Error ${r}`,n)}clearEventListenersForBinding(e){let r=this.fetchEventListenerForBinding(e);r.hasBindings()||(r.disconnect(),this.removeMappedEventListenerFor(e))}removeMappedEventListenerFor(e){let{eventTarget:r,eventName:n,eventOptions:s}=e,i=this.fetchEventListenerMapForEventTarget(r),o=this.cacheKey(n,s);i.delete(o),i.size==0&&this.eventListenerMaps.delete(r)}fetchEventListenerForBinding(e){let{eventTarget:r,eventName:n,eventOptions:s}=e;return this.fetchEventListener(r,n,s)}fetchEventListener(e,r,n){let s=this.fetchEventListenerMapForEventTarget(e),i=this.cacheKey(r,n),o=s.get(i);return o||(o=this.createEventListener(e,r,n),s.set(i,o)),o}createEventListener(e,r,n){let s=new He(e,r,n);return this.started&&s.connect(),s}fetchEventListenerMapForEventTarget(e){let r=this.eventListenerMaps.get(e);return r||(r=new Map,this.eventListenerMaps.set(e,r)),r}cacheKey(e,r){let n=[e];return Object.keys(r).sort().forEach(s=>{n.push(`${r[s]?"":"!"}${s}`)}),n.join(":")}},zr={stop({event:t,value:e}){return e&&t.stopPropagation(),!0},prevent({event:t,value:e}){return e&&t.preventDefault(),!0},self({event:t,value:e,element:r}){return e?r===t.target:!0}},Hr=/^(?:(?:([^.]+?)\+)?(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;function Ur(t){let r=t.trim().match(Hr)||[],n=r[2],s=r[3];return s&&!["keydown","keyup","keypress"].includes(n)&&(n+=`.${s}`,s=""),{eventTarget:_r(r[4]),eventName:n,eventOptions:r[7]?Xr(r[7]):{},identifier:r[5],methodName:r[6],keyFilter:r[1]||s}}function _r(t){if(t=="window")return window;if(t=="document")return document}function Xr(t){return t.split(":").reduce((e,r)=>Object.assign(e,{[r.replace(/^!/,"")]:!/^!/.test(r)}),{})}function Yr(t){if(t==window)return"window";if(t==document)return"document"}function pt(t){return t.replace(/(?:[_-])([a-z0-9])/g,(e,r)=>r.toUpperCase())}function _e(t){return pt(t.replace(/--/g,"-").replace(/__/g,"_"))}function fe(t){return t.charAt(0).toUpperCase()+t.slice(1)}function Xt(t){return t.replace(/([A-Z])/g,(e,r)=>`-${r.toLowerCase()}`)}function Gr(t){return t.match(/[^\s]+/g)||[]}function It(t){return t!=null}function Xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Kt=["meta","ctrl","alt","shift"],Ye=class{constructor(e,r,n,s){this.element=e,this.index=r,this.eventTarget=n.eventTarget||e,this.eventName=n.eventName||Jr(e)||$e("missing event name"),this.eventOptions=n.eventOptions||{},this.identifier=n.identifier||$e("missing identifier"),this.methodName=n.methodName||$e("missing method name"),this.keyFilter=n.keyFilter||"",this.schema=s}static forToken(e,r){return new this(e.element,e.index,Ur(e.content),r)}toString(){let e=this.keyFilter?`.${this.keyFilter}`:"",r=this.eventTargetName?`@${this.eventTargetName}`:"";return`${this.eventName}${e}${r}->${this.identifier}#${this.methodName}`}shouldIgnoreKeyboardEvent(e){if(!this.keyFilter)return!1;let r=this.keyFilter.split("+");if(this.keyFilterDissatisfied(e,r))return!0;let n=r.filter(s=>!Kt.includes(s))[0];return n?(Xe(this.keyMappings,n)||$e(`contains unknown key filter: ${this.keyFilter}`),this.keyMappings[n].toLowerCase()!==e.key.toLowerCase()):!1}shouldIgnoreMouseEvent(e){if(!this.keyFilter)return!1;let r=[this.keyFilter];return!!this.keyFilterDissatisfied(e,r)}get params(){let e={},r=new RegExp(`^data-${this.identifier}-(.+)-param$`,"i");for(let{name:n,value:s}of Array.from(this.element.attributes)){let i=n.match(r),o=i&&i[1];o&&(e[pt(o)]=Qr(s))}return e}get eventTargetName(){return Yr(this.eventTarget)}get keyMappings(){return this.schema.keyMappings}keyFilterDissatisfied(e,r){let[n,s,i,o]=Kt.map(a=>r.includes(a));return e.metaKey!==n||e.ctrlKey!==s||e.altKey!==i||e.shiftKey!==o}},qt={a:()=>"click",button:()=>"click",form:()=>"submit",details:()=>"toggle",input:t=>t.getAttribute("type")=="submit"?"click":"input",select:()=>"change",textarea:()=>"input"};function Jr(t){let e=t.tagName.toLowerCase();if(e in qt)return qt[e](t)}function $e(t){throw new Error(t)}function Qr(t){try{return JSON.parse(t)}catch{return t}}var Ge=class{constructor(e,r){this.context=e,this.action=r}get index(){return this.action.index}get eventTarget(){return this.action.eventTarget}get eventOptions(){return this.action.eventOptions}get identifier(){return this.context.identifier}handleEvent(e){let r=this.prepareActionEvent(e);this.willBeInvokedByEvent(e)&&this.applyEventModifiers(r)&&this.invokeWithEvent(r)}get eventName(){return this.action.eventName}get method(){let e=this.controller[this.methodName];if(typeof e=="function")return e;throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`)}applyEventModifiers(e){let{element:r}=this.action,{actionDescriptorFilters:n}=this.context.application,{controller:s}=this.context,i=!0;for(let[o,a]of Object.entries(this.eventOptions))if(o in n){let c=n[o];i=i&&c({name:o,value:a,event:e,element:r,controller:s})}else continue;return i}prepareActionEvent(e){return Object.assign(e,{params:this.action.params})}invokeWithEvent(e){let{target:r,currentTarget:n}=e;try{this.method.call(this.controller,e),this.context.logDebugActivity(this.methodName,{event:e,target:r,currentTarget:n,action:this.methodName})}catch(s){let{identifier:i,controller:o,element:a,index:c}=this,u={identifier:i,controller:o,element:a,index:c,event:e};this.context.handleError(s,`invoking action "${this.action}"`,u)}}willBeInvokedByEvent(e){let r=e.target;return e instanceof KeyboardEvent&&this.action.shouldIgnoreKeyboardEvent(e)||e instanceof MouseEvent&&this.action.shouldIgnoreMouseEvent(e)?!1:this.element===r?!0:r instanceof Element&&this.element.contains(r)?this.scope.containsElement(r):this.scope.containsElement(this.action.element)}get controller(){return this.context.controller}get methodName(){return this.action.methodName}get element(){return this.scope.element}get scope(){return this.context.scope}},Ce=class{constructor(e,r){this.mutationObserverInit={attributes:!0,childList:!0,subtree:!0},this.element=e,this.started=!1,this.delegate=r,this.elements=new Set,this.mutationObserver=new MutationObserver(n=>this.processMutations(n))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,this.mutationObserverInit),this.refresh())}pause(e){this.started&&(this.mutationObserver.disconnect(),this.started=!1),e(),this.started||(this.mutationObserver.observe(this.element,this.mutationObserverInit),this.started=!0)}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started){let e=new Set(this.matchElementsInTree());for(let r of Array.from(this.elements))e.has(r)||this.removeElement(r);for(let r of Array.from(e))this.addElement(r)}}processMutations(e){if(this.started)for(let r of e)this.processMutation(r)}processMutation(e){e.type=="attributes"?this.processAttributeChange(e.target,e.attributeName):e.type=="childList"&&(this.processRemovedNodes(e.removedNodes),this.processAddedNodes(e.addedNodes))}processAttributeChange(e,r){this.elements.has(e)?this.delegate.elementAttributeChanged&&this.matchElement(e)?this.delegate.elementAttributeChanged(e,r):this.removeElement(e):this.matchElement(e)&&this.addElement(e)}processRemovedNodes(e){for(let r of Array.from(e)){let n=this.elementFromNode(r);n&&this.processTree(n,this.removeElement)}}processAddedNodes(e){for(let r of Array.from(e)){let n=this.elementFromNode(r);n&&this.elementIsActive(n)&&this.processTree(n,this.addElement)}}matchElement(e){return this.delegate.matchElement(e)}matchElementsInTree(e=this.element){return this.delegate.matchElementsInTree(e)}processTree(e,r){for(let n of this.matchElementsInTree(e))r.call(this,n)}elementFromNode(e){if(e.nodeType==Node.ELEMENT_NODE)return e}elementIsActive(e){return e.isConnected!=this.element.isConnected?!1:this.element.contains(e)}addElement(e){this.elements.has(e)||this.elementIsActive(e)&&(this.elements.add(e),this.delegate.elementMatched&&this.delegate.elementMatched(e))}removeElement(e){this.elements.has(e)&&(this.elements.delete(e),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(e))}},Me=class{constructor(e,r,n){this.attributeName=r,this.delegate=n,this.elementObserver=new Ce(e,this)}get element(){return this.elementObserver.element}get selector(){return`[${this.attributeName}]`}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get started(){return this.elementObserver.started}matchElement(e){return e.hasAttribute(this.attributeName)}matchElementsInTree(e){let r=this.matchElement(e)?[e]:[],n=Array.from(e.querySelectorAll(this.selector));return r.concat(n)}elementMatched(e){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(e,this.attributeName)}elementUnmatched(e){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(e,this.attributeName)}elementAttributeChanged(e,r){this.delegate.elementAttributeValueChanged&&this.attributeName==r&&this.delegate.elementAttributeValueChanged(e,r)}};function Zr(t,e,r){Yt(t,e).add(r)}function en(t,e,r){Yt(t,e).delete(r),tn(t,e)}function Yt(t,e){let r=t.get(e);return r||(r=new Set,t.set(e,r)),r}function tn(t,e){let r=t.get(e);r!=null&&r.size==0&&t.delete(e)}var z=class{constructor(){this.valuesByKey=new Map}get keys(){return Array.from(this.valuesByKey.keys())}get values(){return Array.from(this.valuesByKey.values()).reduce((r,n)=>r.concat(Array.from(n)),[])}get size(){return Array.from(this.valuesByKey.values()).reduce((r,n)=>r+n.size,0)}add(e,r){Zr(this.valuesByKey,e,r)}delete(e,r){en(this.valuesByKey,e,r)}has(e,r){let n=this.valuesByKey.get(e);return n!=null&&n.has(r)}hasKey(e){return this.valuesByKey.has(e)}hasValue(e){return Array.from(this.valuesByKey.values()).some(n=>n.has(e))}getValuesForKey(e){let r=this.valuesByKey.get(e);return r?Array.from(r):[]}getKeysForValue(e){return Array.from(this.valuesByKey).filter(([r,n])=>n.has(e)).map(([r,n])=>r)}};var Je=class{constructor(e,r,n,s){this._selector=r,this.details=s,this.elementObserver=new Ce(e,this),this.delegate=n,this.matchesByElement=new z}get started(){return this.elementObserver.started}get selector(){return this._selector}set selector(e){this._selector=e,this.refresh()}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get element(){return this.elementObserver.element}matchElement(e){let{selector:r}=this;if(r){let n=e.matches(r);return this.delegate.selectorMatchElement?n&&this.delegate.selectorMatchElement(e,this.details):n}else return!1}matchElementsInTree(e){let{selector:r}=this;if(r){let n=this.matchElement(e)?[e]:[],s=Array.from(e.querySelectorAll(r)).filter(i=>this.matchElement(i));return n.concat(s)}else return[]}elementMatched(e){let{selector:r}=this;r&&this.selectorMatched(e,r)}elementUnmatched(e){let r=this.matchesByElement.getKeysForValue(e);for(let n of r)this.selectorUnmatched(e,n)}elementAttributeChanged(e,r){let{selector:n}=this;if(n){let s=this.matchElement(e),i=this.matchesByElement.has(n,e);s&&!i?this.selectorMatched(e,n):!s&&i&&this.selectorUnmatched(e,n)}}selectorMatched(e,r){this.delegate.selectorMatched(e,r,this.details),this.matchesByElement.add(r,e)}selectorUnmatched(e,r){this.delegate.selectorUnmatched(e,r,this.details),this.matchesByElement.delete(r,e)}},Qe=class{constructor(e,r){this.element=e,this.delegate=r,this.started=!1,this.stringMap=new Map,this.mutationObserver=new MutationObserver(n=>this.processMutations(n))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,attributeOldValue:!0}),this.refresh())}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started)for(let e of this.knownAttributeNames)this.refreshAttribute(e,null)}processMutations(e){if(this.started)for(let r of e)this.processMutation(r)}processMutation(e){let r=e.attributeName;r&&this.refreshAttribute(r,e.oldValue)}refreshAttribute(e,r){let n=this.delegate.getStringMapKeyForAttribute(e);if(n!=null){this.stringMap.has(e)||this.stringMapKeyAdded(n,e);let s=this.element.getAttribute(e);if(this.stringMap.get(e)!=s&&this.stringMapValueChanged(s,n,r),s==null){let i=this.stringMap.get(e);this.stringMap.delete(e),i&&this.stringMapKeyRemoved(n,e,i)}else this.stringMap.set(e,s)}}stringMapKeyAdded(e,r){this.delegate.stringMapKeyAdded&&this.delegate.stringMapKeyAdded(e,r)}stringMapValueChanged(e,r,n){this.delegate.stringMapValueChanged&&this.delegate.stringMapValueChanged(e,r,n)}stringMapKeyRemoved(e,r,n){this.delegate.stringMapKeyRemoved&&this.delegate.stringMapKeyRemoved(e,r,n)}get knownAttributeNames(){return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))}get currentAttributeNames(){return Array.from(this.element.attributes).map(e=>e.name)}get recordedAttributeNames(){return Array.from(this.stringMap.keys())}},Le=class{constructor(e,r,n){this.attributeObserver=new Me(e,r,this),this.delegate=n,this.tokensByElement=new z}get started(){return this.attributeObserver.started}start(){this.attributeObserver.start()}pause(e){this.attributeObserver.pause(e)}stop(){this.attributeObserver.stop()}refresh(){this.attributeObserver.refresh()}get element(){return this.attributeObserver.element}get attributeName(){return this.attributeObserver.attributeName}elementMatchedAttribute(e){this.tokensMatched(this.readTokensForElement(e))}elementAttributeValueChanged(e){let[r,n]=this.refreshTokensForElement(e);this.tokensUnmatched(r),this.tokensMatched(n)}elementUnmatchedAttribute(e){this.tokensUnmatched(this.tokensByElement.getValuesForKey(e))}tokensMatched(e){e.forEach(r=>this.tokenMatched(r))}tokensUnmatched(e){e.forEach(r=>this.tokenUnmatched(r))}tokenMatched(e){this.delegate.tokenMatched(e),this.tokensByElement.add(e.element,e)}tokenUnmatched(e){this.delegate.tokenUnmatched(e),this.tokensByElement.delete(e.element,e)}refreshTokensForElement(e){let r=this.tokensByElement.getValuesForKey(e),n=this.readTokensForElement(e),s=nn(r,n).findIndex(([i,o])=>!sn(i,o));return s==-1?[[],[]]:[r.slice(s),n.slice(s)]}readTokensForElement(e){let r=this.attributeName,n=e.getAttribute(r)||"";return rn(n,e,r)}};function rn(t,e,r){return t.trim().split(/\s+/).filter(n=>n.length).map((n,s)=>({element:e,attributeName:r,content:n,index:s}))}function nn(t,e){let r=Math.max(t.length,e.length);return Array.from({length:r},(n,s)=>[t[s],e[s]])}function sn(t,e){return t&&e&&t.index==e.index&&t.content==e.content}var Te=class{constructor(e,r,n){this.tokenListObserver=new Le(e,r,this),this.delegate=n,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}get started(){return this.tokenListObserver.started}start(){this.tokenListObserver.start()}stop(){this.tokenListObserver.stop()}refresh(){this.tokenListObserver.refresh()}get element(){return this.tokenListObserver.element}get attributeName(){return this.tokenListObserver.attributeName}tokenMatched(e){let{element:r}=e,{value:n}=this.fetchParseResultForToken(e);n&&(this.fetchValuesByTokenForElement(r).set(e,n),this.delegate.elementMatchedValue(r,n))}tokenUnmatched(e){let{element:r}=e,{value:n}=this.fetchParseResultForToken(e);n&&(this.fetchValuesByTokenForElement(r).delete(e),this.delegate.elementUnmatchedValue(r,n))}fetchParseResultForToken(e){let r=this.parseResultsByToken.get(e);return r||(r=this.parseToken(e),this.parseResultsByToken.set(e,r)),r}fetchValuesByTokenForElement(e){let r=this.valuesByTokenByElement.get(e);return r||(r=new Map,this.valuesByTokenByElement.set(e,r)),r}parseToken(e){try{return{value:this.delegate.parseValueForToken(e)}}catch(r){return{error:r}}}},Ze=class{constructor(e,r){this.context=e,this.delegate=r,this.bindingsByAction=new Map}start(){this.valueListObserver||(this.valueListObserver=new Te(this.element,this.actionAttribute,this),this.valueListObserver.start())}stop(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())}get element(){return this.context.element}get identifier(){return this.context.identifier}get actionAttribute(){return this.schema.actionAttribute}get schema(){return this.context.schema}get bindings(){return Array.from(this.bindingsByAction.values())}connectAction(e){let r=new Ge(this.context,e);this.bindingsByAction.set(e,r),this.delegate.bindingConnected(r)}disconnectAction(e){let r=this.bindingsByAction.get(e);r&&(this.bindingsByAction.delete(e),this.delegate.bindingDisconnected(r))}disconnectAllActions(){this.bindings.forEach(e=>this.delegate.bindingDisconnected(e,!0)),this.bindingsByAction.clear()}parseValueForToken(e){let r=Ye.forToken(e,this.schema);if(r.identifier==this.identifier)return r}elementMatchedValue(e,r){this.connectAction(r)}elementUnmatchedValue(e,r){this.disconnectAction(r)}},et=class{constructor(e,r){this.context=e,this.receiver=r,this.stringMapObserver=new Qe(this.element,this),this.valueDescriptorMap=this.controller.valueDescriptorMap}start(){this.stringMapObserver.start(),this.invokeChangedCallbacksForDefaultValues()}stop(){this.stringMapObserver.stop()}get element(){return this.context.element}get controller(){return this.context.controller}getStringMapKeyForAttribute(e){if(e in this.valueDescriptorMap)return this.valueDescriptorMap[e].name}stringMapKeyAdded(e,r){let n=this.valueDescriptorMap[r];this.hasValue(e)||this.invokeChangedCallback(e,n.writer(this.receiver[e]),n.writer(n.defaultValue))}stringMapValueChanged(e,r,n){let s=this.valueDescriptorNameMap[r];e!==null&&(n===null&&(n=s.writer(s.defaultValue)),this.invokeChangedCallback(r,e,n))}stringMapKeyRemoved(e,r,n){let s=this.valueDescriptorNameMap[e];this.hasValue(e)?this.invokeChangedCallback(e,s.writer(this.receiver[e]),n):this.invokeChangedCallback(e,s.writer(s.defaultValue),n)}invokeChangedCallbacksForDefaultValues(){for(let{key:e,name:r,defaultValue:n,writer:s}of this.valueDescriptors)n!=null&&!this.controller.data.has(e)&&this.invokeChangedCallback(r,s(n),void 0)}invokeChangedCallback(e,r,n){let s=`${e}Changed`,i=this.receiver[s];if(typeof i=="function"){let o=this.valueDescriptorNameMap[e];try{let a=o.reader(r),c=n;n&&(c=o.reader(n)),i.call(this.receiver,a,c)}catch(a){throw a instanceof TypeError&&(a.message=`Stimulus Value "${this.context.identifier}.${o.name}" - ${a.message}`),a}}}get valueDescriptors(){let{valueDescriptorMap:e}=this;return Object.keys(e).map(r=>e[r])}get valueDescriptorNameMap(){let e={};return Object.keys(this.valueDescriptorMap).forEach(r=>{let n=this.valueDescriptorMap[r];e[n.name]=n}),e}hasValue(e){let r=this.valueDescriptorNameMap[e],n=`has${fe(r.name)}`;return this.receiver[n]}},tt=class{constructor(e,r){this.context=e,this.delegate=r,this.targetsByName=new z}start(){this.tokenListObserver||(this.tokenListObserver=new Le(this.element,this.attributeName,this),this.tokenListObserver.start())}stop(){this.tokenListObserver&&(this.disconnectAllTargets(),this.tokenListObserver.stop(),delete this.tokenListObserver)}tokenMatched({element:e,content:r}){this.scope.containsElement(e)&&this.connectTarget(e,r)}tokenUnmatched({element:e,content:r}){this.disconnectTarget(e,r)}connectTarget(e,r){var n;this.targetsByName.has(r,e)||(this.targetsByName.add(r,e),(n=this.tokenListObserver)===null||n===void 0||n.pause(()=>this.delegate.targetConnected(e,r)))}disconnectTarget(e,r){var n;this.targetsByName.has(r,e)&&(this.targetsByName.delete(r,e),(n=this.tokenListObserver)===null||n===void 0||n.pause(()=>this.delegate.targetDisconnected(e,r)))}disconnectAllTargets(){for(let e of this.targetsByName.keys)for(let r of this.targetsByName.getValuesForKey(e))this.disconnectTarget(r,e)}get attributeName(){return`data-${this.context.identifier}-target`}get element(){return this.context.element}get scope(){return this.context.scope}};function pe(t,e){let r=Gt(t);return Array.from(r.reduce((n,s)=>(an(s,e).forEach(i=>n.add(i)),n),new Set))}function on(t,e){return Gt(t).reduce((n,s)=>(n.push(...ln(s,e)),n),[])}function Gt(t){let e=[];for(;t;)e.push(t),t=Object.getPrototypeOf(t);return e.reverse()}function an(t,e){let r=t[e];return Array.isArray(r)?r:[]}function ln(t,e){let r=t[e];return r?Object.keys(r).map(n=>[n,r[n]]):[]}var rt=class{constructor(e,r){this.started=!1,this.context=e,this.delegate=r,this.outletsByName=new z,this.outletElementsByName=new z,this.selectorObserverMap=new Map,this.attributeObserverMap=new Map}start(){this.started||(this.outletDefinitions.forEach(e=>{this.setupSelectorObserverForOutlet(e),this.setupAttributeObserverForOutlet(e)}),this.started=!0,this.dependentContexts.forEach(e=>e.refresh()))}refresh(){this.selectorObserverMap.forEach(e=>e.refresh()),this.attributeObserverMap.forEach(e=>e.refresh())}stop(){this.started&&(this.started=!1,this.disconnectAllOutlets(),this.stopSelectorObservers(),this.stopAttributeObservers())}stopSelectorObservers(){this.selectorObserverMap.size>0&&(this.selectorObserverMap.forEach(e=>e.stop()),this.selectorObserverMap.clear())}stopAttributeObservers(){this.attributeObserverMap.size>0&&(this.attributeObserverMap.forEach(e=>e.stop()),this.attributeObserverMap.clear())}selectorMatched(e,r,{outletName:n}){let s=this.getOutlet(e,n);s&&this.connectOutlet(s,e,n)}selectorUnmatched(e,r,{outletName:n}){let s=this.getOutletFromMap(e,n);s&&this.disconnectOutlet(s,e,n)}selectorMatchElement(e,{outletName:r}){let n=this.selector(r),s=this.hasOutlet(e,r),i=e.matches(`[${this.schema.controllerAttribute}~=${r}]`);return n?s&&i&&e.matches(n):!1}elementMatchedAttribute(e,r){let n=this.getOutletNameFromOutletAttributeName(r);n&&this.updateSelectorObserverForOutlet(n)}elementAttributeValueChanged(e,r){let n=this.getOutletNameFromOutletAttributeName(r);n&&this.updateSelectorObserverForOutlet(n)}elementUnmatchedAttribute(e,r){let n=this.getOutletNameFromOutletAttributeName(r);n&&this.updateSelectorObserverForOutlet(n)}connectOutlet(e,r,n){var s;this.outletElementsByName.has(n,r)||(this.outletsByName.add(n,e),this.outletElementsByName.add(n,r),(s=this.selectorObserverMap.get(n))===null||s===void 0||s.pause(()=>this.delegate.outletConnected(e,r,n)))}disconnectOutlet(e,r,n){var s;this.outletElementsByName.has(n,r)&&(this.outletsByName.delete(n,e),this.outletElementsByName.delete(n,r),(s=this.selectorObserverMap.get(n))===null||s===void 0||s.pause(()=>this.delegate.outletDisconnected(e,r,n)))}disconnectAllOutlets(){for(let e of this.outletElementsByName.keys)for(let r of this.outletElementsByName.getValuesForKey(e))for(let n of this.outletsByName.getValuesForKey(e))this.disconnectOutlet(n,r,e)}updateSelectorObserverForOutlet(e){let r=this.selectorObserverMap.get(e);r&&(r.selector=this.selector(e))}setupSelectorObserverForOutlet(e){let r=this.selector(e),n=new Je(document.body,r,this,{outletName:e});this.selectorObserverMap.set(e,n),n.start()}setupAttributeObserverForOutlet(e){let r=this.attributeNameForOutletName(e),n=new Me(this.scope.element,r,this);this.attributeObserverMap.set(e,n),n.start()}selector(e){return this.scope.outlets.getSelectorForOutletName(e)}attributeNameForOutletName(e){return this.scope.schema.outletAttributeForScope(this.identifier,e)}getOutletNameFromOutletAttributeName(e){return this.outletDefinitions.find(r=>this.attributeNameForOutletName(r)===e)}get outletDependencies(){let e=new z;return this.router.modules.forEach(r=>{let n=r.definition.controllerConstructor;pe(n,"outlets").forEach(i=>e.add(i,r.identifier))}),e}get outletDefinitions(){return this.outletDependencies.getKeysForValue(this.identifier)}get dependentControllerIdentifiers(){return this.outletDependencies.getValuesForKey(this.identifier)}get dependentContexts(){let e=this.dependentControllerIdentifiers;return this.router.contexts.filter(r=>e.includes(r.identifier))}hasOutlet(e,r){return!!this.getOutlet(e,r)||!!this.getOutletFromMap(e,r)}getOutlet(e,r){return this.application.getControllerForElementAndIdentifier(e,r)}getOutletFromMap(e,r){return this.outletsByName.getValuesForKey(r).find(n=>n.element===e)}get scope(){return this.context.scope}get schema(){return this.context.schema}get identifier(){return this.context.identifier}get application(){return this.context.application}get router(){return this.application.router}},nt=class{constructor(e,r){this.logDebugActivity=(n,s={})=>{let{identifier:i,controller:o,element:a}=this;s=Object.assign({identifier:i,controller:o,element:a},s),this.application.logDebugActivity(this.identifier,n,s)},this.module=e,this.scope=r,this.controller=new e.controllerConstructor(this),this.bindingObserver=new Ze(this,this.dispatcher),this.valueObserver=new et(this,this.controller),this.targetObserver=new tt(this,this),this.outletObserver=new rt(this,this);try{this.controller.initialize(),this.logDebugActivity("initialize")}catch(n){this.handleError(n,"initializing controller")}}connect(){this.bindingObserver.start(),this.valueObserver.start(),this.targetObserver.start(),this.outletObserver.start();try{this.controller.connect(),this.logDebugActivity("connect")}catch(e){this.handleError(e,"connecting controller")}}refresh(){this.outletObserver.refresh()}disconnect(){try{this.controller.disconnect(),this.logDebugActivity("disconnect")}catch(e){this.handleError(e,"disconnecting controller")}this.outletObserver.stop(),this.targetObserver.stop(),this.valueObserver.stop(),this.bindingObserver.stop()}get application(){return this.module.application}get identifier(){return this.module.identifier}get schema(){return this.application.schema}get dispatcher(){return this.application.dispatcher}get element(){return this.scope.element}get parentElement(){return this.element.parentElement}handleError(e,r,n={}){let{identifier:s,controller:i,element:o}=this;n=Object.assign({identifier:s,controller:i,element:o},n),this.application.handleError(e,`Error ${r}`,n)}targetConnected(e,r){this.invokeControllerMethod(`${r}TargetConnected`,e)}targetDisconnected(e,r){this.invokeControllerMethod(`${r}TargetDisconnected`,e)}outletConnected(e,r,n){this.invokeControllerMethod(`${_e(n)}OutletConnected`,e,r)}outletDisconnected(e,r,n){this.invokeControllerMethod(`${_e(n)}OutletDisconnected`,e,r)}invokeControllerMethod(e,...r){let n=this.controller;typeof n[e]=="function"&&n[e](...r)}};function cn(t){return un(t,hn(t))}function un(t,e){let r=mn(t),n=dn(t.prototype,e);return Object.defineProperties(r.prototype,n),r}function hn(t){return pe(t,"blessings").reduce((r,n)=>{let s=n(t);for(let i in s){let o=r[i]||{};r[i]=Object.assign(o,s[i])}return r},{})}function dn(t,e){return pn(e).reduce((r,n)=>{let s=fn(t,e,n);return s&&Object.assign(r,{[n]:s}),r},{})}function fn(t,e,r){let n=Object.getOwnPropertyDescriptor(t,r);if(!(n&&"value"in n)){let i=Object.getOwnPropertyDescriptor(e,r).value;return n&&(i.get=n.get||i.get,i.set=n.set||i.set),i}}var pn=(()=>typeof Object.getOwnPropertySymbols=="function"?t=>[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)]:Object.getOwnPropertyNames)(),mn=(()=>{function t(r){function n(){return Reflect.construct(r,arguments,new.target)}return n.prototype=Object.create(r.prototype,{constructor:{value:n}}),Reflect.setPrototypeOf(n,r),n}function e(){let n=t(function(){this.a.call(this)});return n.prototype.a=function(){},new n}try{return e(),t}catch{return n=>class extends n{}}})();function gn(t){return{identifier:t.identifier,controllerConstructor:cn(t.controllerConstructor)}}var st=class{constructor(e,r){this.application=e,this.definition=gn(r),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}get identifier(){return this.definition.identifier}get controllerConstructor(){return this.definition.controllerConstructor}get contexts(){return Array.from(this.connectedContexts)}connectContextForScope(e){let r=this.fetchContextForScope(e);this.connectedContexts.add(r),r.connect()}disconnectContextForScope(e){let r=this.contextsByScope.get(e);r&&(this.connectedContexts.delete(r),r.disconnect())}fetchContextForScope(e){let r=this.contextsByScope.get(e);return r||(r=new nt(this,e),this.contextsByScope.set(e,r)),r}},it=class{constructor(e){this.scope=e}has(e){return this.data.has(this.getDataKey(e))}get(e){return this.getAll(e)[0]}getAll(e){let r=this.data.get(this.getDataKey(e))||"";return Gr(r)}getAttributeName(e){return this.data.getAttributeNameForKey(this.getDataKey(e))}getDataKey(e){return`${e}-class`}get data(){return this.scope.data}},ot=class{constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get(e){let r=this.getAttributeNameForKey(e);return this.element.getAttribute(r)}set(e,r){let n=this.getAttributeNameForKey(e);return this.element.setAttribute(n,r),this.get(e)}has(e){let r=this.getAttributeNameForKey(e);return this.element.hasAttribute(r)}delete(e){if(this.has(e)){let r=this.getAttributeNameForKey(e);return this.element.removeAttribute(r),!0}else return!1}getAttributeNameForKey(e){return`data-${this.identifier}-${Xt(e)}`}},at=class{constructor(e){this.warnedKeysByObject=new WeakMap,this.logger=e}warn(e,r,n){let s=this.warnedKeysByObject.get(e);s||(s=new Set,this.warnedKeysByObject.set(e,s)),s.has(r)||(s.add(r),this.logger.warn(n,e))}};function lt(t,e){return`[${t}~="${e}"]`}var ct=class{constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return this.find(e)!=null}find(...e){return e.reduce((r,n)=>r||this.findTarget(n)||this.findLegacyTarget(n),void 0)}findAll(...e){return e.reduce((r,n)=>[...r,...this.findAllTargets(n),...this.findAllLegacyTargets(n)],[])}findTarget(e){let r=this.getSelectorForTargetName(e);return this.scope.findElement(r)}findAllTargets(e){let r=this.getSelectorForTargetName(e);return this.scope.findAllElements(r)}getSelectorForTargetName(e){let r=this.schema.targetAttributeForScope(this.identifier);return lt(r,e)}findLegacyTarget(e){let r=this.getLegacySelectorForTargetName(e);return this.deprecate(this.scope.findElement(r),e)}findAllLegacyTargets(e){let r=this.getLegacySelectorForTargetName(e);return this.scope.findAllElements(r).map(n=>this.deprecate(n,e))}getLegacySelectorForTargetName(e){let r=`${this.identifier}.${e}`;return lt(this.schema.targetAttribute,r)}deprecate(e,r){if(e){let{identifier:n}=this,s=this.schema.targetAttribute,i=this.schema.targetAttributeForScope(n);this.guide.warn(e,`target:${r}`,`Please replace ${s}="${n}.${r}" with ${i}="${r}". The ${s} attribute is deprecated and will be removed in a future version of Stimulus.`)}return e}get guide(){return this.scope.guide}},ut=class{constructor(e,r){this.scope=e,this.controllerElement=r}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return this.find(e)!=null}find(...e){return e.reduce((r,n)=>r||this.findOutlet(n),void 0)}findAll(...e){return e.reduce((r,n)=>[...r,...this.findAllOutlets(n)],[])}getSelectorForOutletName(e){let r=this.schema.outletAttributeForScope(this.identifier,e);return this.controllerElement.getAttribute(r)}findOutlet(e){let r=this.getSelectorForOutletName(e);if(r)return this.findElement(r,e)}findAllOutlets(e){let r=this.getSelectorForOutletName(e);return r?this.findAllElements(r,e):[]}findElement(e,r){return this.scope.queryElements(e).filter(s=>this.matchesElement(s,e,r))[0]}findAllElements(e,r){return this.scope.queryElements(e).filter(s=>this.matchesElement(s,e,r))}matchesElement(e,r,n){let s=e.getAttribute(this.scope.schema.controllerAttribute)||"";return e.matches(r)&&s.split(" ").includes(n)}},ht=class t{constructor(e,r,n,s){this.targets=new ct(this),this.classes=new it(this),this.data=new ot(this),this.containsElement=i=>i.closest(this.controllerSelector)===this.element,this.schema=e,this.element=r,this.identifier=n,this.guide=new at(s),this.outlets=new ut(this.documentScope,r)}findElement(e){return this.element.matches(e)?this.element:this.queryElements(e).find(this.containsElement)}findAllElements(e){return[...this.element.matches(e)?[this.element]:[],...this.queryElements(e).filter(this.containsElement)]}queryElements(e){return Array.from(this.element.querySelectorAll(e))}get controllerSelector(){return lt(this.schema.controllerAttribute,this.identifier)}get isDocumentScope(){return this.element===document.documentElement}get documentScope(){return this.isDocumentScope?this:new t(this.schema,document.documentElement,this.identifier,this.guide.logger)}},dt=class{constructor(e,r,n){this.element=e,this.schema=r,this.delegate=n,this.valueListObserver=new Te(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}start(){this.valueListObserver.start()}stop(){this.valueListObserver.stop()}get controllerAttribute(){return this.schema.controllerAttribute}parseValueForToken(e){let{element:r,content:n}=e;return this.parseValueForElementAndIdentifier(r,n)}parseValueForElementAndIdentifier(e,r){let n=this.fetchScopesByIdentifierForElement(e),s=n.get(r);return s||(s=this.delegate.createScopeForElementAndIdentifier(e,r),n.set(r,s)),s}elementMatchedValue(e,r){let n=(this.scopeReferenceCounts.get(r)||0)+1;this.scopeReferenceCounts.set(r,n),n==1&&this.delegate.scopeConnected(r)}elementUnmatchedValue(e,r){let n=this.scopeReferenceCounts.get(r);n&&(this.scopeReferenceCounts.set(r,n-1),n==1&&this.delegate.scopeDisconnected(r))}fetchScopesByIdentifierForElement(e){let r=this.scopesByIdentifierByElement.get(e);return r||(r=new Map,this.scopesByIdentifierByElement.set(e,r)),r}},ft=class{constructor(e){this.application=e,this.scopeObserver=new dt(this.element,this.schema,this),this.scopesByIdentifier=new z,this.modulesByIdentifier=new Map}get element(){return this.application.element}get schema(){return this.application.schema}get logger(){return this.application.logger}get controllerAttribute(){return this.schema.controllerAttribute}get modules(){return Array.from(this.modulesByIdentifier.values())}get contexts(){return this.modules.reduce((e,r)=>e.concat(r.contexts),[])}start(){this.scopeObserver.start()}stop(){this.scopeObserver.stop()}loadDefinition(e){this.unloadIdentifier(e.identifier);let r=new st(this.application,e);this.connectModule(r);let n=e.controllerConstructor.afterLoad;n&&n.call(e.controllerConstructor,e.identifier,this.application)}unloadIdentifier(e){let r=this.modulesByIdentifier.get(e);r&&this.disconnectModule(r)}getContextForElementAndIdentifier(e,r){let n=this.modulesByIdentifier.get(r);if(n)return n.contexts.find(s=>s.element==e)}proposeToConnectScopeForElementAndIdentifier(e,r){let n=this.scopeObserver.parseValueForElementAndIdentifier(e,r);n?this.scopeObserver.elementMatchedValue(n.element,n):console.error(`Couldn't find or create scope for identifier: "${r}" and element:`,e)}handleError(e,r,n){this.application.handleError(e,r,n)}createScopeForElementAndIdentifier(e,r){return new ht(this.schema,e,r,this.logger)}scopeConnected(e){this.scopesByIdentifier.add(e.identifier,e);let r=this.modulesByIdentifier.get(e.identifier);r&&r.connectContextForScope(e)}scopeDisconnected(e){this.scopesByIdentifier.delete(e.identifier,e);let r=this.modulesByIdentifier.get(e.identifier);r&&r.disconnectContextForScope(e)}connectModule(e){this.modulesByIdentifier.set(e.identifier,e),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach(n=>e.connectContextForScope(n))}disconnectModule(e){this.modulesByIdentifier.delete(e.identifier),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach(n=>e.disconnectContextForScope(n))}},yn={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target",targetAttributeForScope:t=>`data-${t}-target`,outletAttributeForScope:(t,e)=>`data-${t}-${e}-outlet`,keyMappings:Object.assign(Object.assign({enter:"Enter",tab:"Tab",esc:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",home:"Home",end:"End",page_up:"PageUp",page_down:"PageDown"},Rt("abcdefghijklmnopqrstuvwxyz".split("").map(t=>[t,t]))),Rt("0123456789".split("").map(t=>[t,t])))};function Rt(t){return t.reduce((e,[r,n])=>Object.assign(Object.assign({},e),{[r]:n}),{})}var Ne=class{constructor(e=document.documentElement,r=yn){this.logger=console,this.debug=!1,this.logDebugActivity=(n,s,i={})=>{this.debug&&this.logFormattedMessage(n,s,i)},this.element=e,this.schema=r,this.dispatcher=new Ue(this),this.router=new ft(this),this.actionDescriptorFilters=Object.assign({},zr)}static start(e,r){let n=new this(e,r);return n.start(),n}async start(){await vn(),this.logDebugActivity("application","starting"),this.dispatcher.start(),this.router.start(),this.logDebugActivity("application","start")}stop(){this.logDebugActivity("application","stopping"),this.dispatcher.stop(),this.router.stop(),this.logDebugActivity("application","stop")}register(e,r){this.load({identifier:e,controllerConstructor:r})}registerActionOption(e,r){this.actionDescriptorFilters[e]=r}load(e,...r){(Array.isArray(e)?e:[e,...r]).forEach(s=>{s.controllerConstructor.shouldLoad&&this.router.loadDefinition(s)})}unload(e,...r){(Array.isArray(e)?e:[e,...r]).forEach(s=>this.router.unloadIdentifier(s))}get controllers(){return this.router.contexts.map(e=>e.controller)}getControllerForElementAndIdentifier(e,r){let n=this.router.getContextForElementAndIdentifier(e,r);return n?n.controller:null}handleError(e,r,n){var s;this.logger.error(`%s

%o

%o`,r,e,n),(s=window.onerror)===null||s===void 0||s.call(window,r,"",0,0,e)}logFormattedMessage(e,r,n={}){n=Object.assign({application:this},n),this.logger.groupCollapsed(`${e} #${r}`),this.logger.log("details:",Object.assign({},n)),this.logger.groupEnd()}};function vn(){return new Promise(t=>{document.readyState=="loading"?document.addEventListener("DOMContentLoaded",()=>t()):t()})}function bn(t){return pe(t,"classes").reduce((r,n)=>Object.assign(r,En(n)),{})}function En(t){return{[`${t}Class`]:{get(){let{classes:e}=this;if(e.has(t))return e.get(t);{let r=e.getAttributeName(t);throw new Error(`Missing attribute "${r}"`)}}},[`${t}Classes`]:{get(){return this.classes.getAll(t)}},[`has${fe(t)}Class`]:{get(){return this.classes.has(t)}}}}function wn(t){return pe(t,"outlets").reduce((r,n)=>Object.assign(r,An(n)),{})}function Wt(t,e,r){return t.application.getControllerForElementAndIdentifier(e,r)}function zt(t,e,r){let n=Wt(t,e,r);if(n||(t.application.router.proposeToConnectScopeForElementAndIdentifier(e,r),n=Wt(t,e,r),n))return n}function An(t){let e=_e(t);return{[`${e}Outlet`]:{get(){let r=this.outlets.find(t),n=this.outlets.getSelectorForOutletName(t);if(r){let s=zt(this,r,t);if(s)return s;throw new Error(`The provided outlet element is missing an outlet controller "${t}" instance for host controller "${this.identifier}"`)}throw new Error(`Missing outlet element "${t}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${n}".`)}},[`${e}Outlets`]:{get(){let r=this.outlets.findAll(t);return r.length>0?r.map(n=>{let s=zt(this,n,t);if(s)return s;console.warn(`The provided outlet element is missing an outlet controller "${t}" instance for host controller "${this.identifier}"`,n)}).filter(n=>n):[]}},[`${e}OutletElement`]:{get(){let r=this.outlets.find(t),n=this.outlets.getSelectorForOutletName(t);if(r)return r;throw new Error(`Missing outlet element "${t}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${n}".`)}},[`${e}OutletElements`]:{get(){return this.outlets.findAll(t)}},[`has${fe(e)}Outlet`]:{get(){return this.outlets.has(t)}}}}function On(t){return pe(t,"targets").reduce((r,n)=>Object.assign(r,xn(n)),{})}function xn(t){return{[`${t}Target`]:{get(){let e=this.targets.find(t);if(e)return e;throw new Error(`Missing target element "${t}" for "${this.identifier}" controller`)}},[`${t}Targets`]:{get(){return this.targets.findAll(t)}},[`has${fe(t)}Target`]:{get(){return this.targets.has(t)}}}}function kn(t){let e=on(t,"values"),r={valueDescriptorMap:{get(){return e.reduce((n,s)=>{let i=Jt(s,this.identifier),o=this.data.getAttributeNameForKey(i.key);return Object.assign(n,{[o]:i})},{})}}};return e.reduce((n,s)=>Object.assign(n,$n(s)),r)}function $n(t,e){let r=Jt(t,e),{key:n,name:s,reader:i,writer:o}=r;return{[s]:{get(){let a=this.data.get(n);return a!==null?i(a):r.defaultValue},set(a){a===void 0?this.data.delete(n):this.data.set(n,o(a))}},[`has${fe(s)}`]:{get(){return this.data.has(n)||r.hasCustomDefaultValue}}}}function Jt([t,e],r){return Tn({controller:r,token:t,typeDefinition:e})}function Se(t){switch(t){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function de(t){switch(typeof t){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}if(Array.isArray(t))return"array";if(Object.prototype.toString.call(t)==="[object Object]")return"object"}function Cn(t){let{controller:e,token:r,typeObject:n}=t,s=It(n.type),i=It(n.default),o=s&&i,a=s&&!i,c=!s&&i,u=Se(n.type),C=de(t.typeObject.default);if(a)return u;if(c)return C;if(u!==C){let j=e?`${e}.${r}`:r;throw new Error(`The specified default value for the Stimulus Value "${j}" must match the defined type "${u}". The provided default value of "${n.default}" is of type "${C}".`)}if(o)return u}function Mn(t){let{controller:e,token:r,typeDefinition:n}=t,i=Cn({controller:e,token:r,typeObject:n}),o=de(n),a=Se(n),c=i||o||a;if(c)return c;let u=e?`${e}.${n}`:r;throw new Error(`Unknown value type "${u}" for "${r}" value`)}function Ln(t){let e=Se(t);if(e)return Ht[e];let r=Xe(t,"default"),n=Xe(t,"type"),s=t;if(r)return s.default;if(n){let{type:i}=s,o=Se(i);if(o)return Ht[o]}return t}function Tn(t){let{token:e,typeDefinition:r}=t,n=`${Xt(e)}-value`,s=Mn(t);return{type:s,key:n,name:pt(n),get defaultValue(){return Ln(r)},get hasCustomDefaultValue(){return de(r)!==void 0},reader:Nn[s],writer:Ut[s]||Ut.default}}var Ht={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},Nn={array(t){let e=JSON.parse(t);if(!Array.isArray(e))throw new TypeError(`expected value of type "array" but instead got value "${t}" of type "${de(e)}"`);return e},boolean(t){return!(t=="0"||String(t).toLowerCase()=="false")},number(t){return Number(t.replace(/_/g,""))},object(t){let e=JSON.parse(t);if(e===null||typeof e!="object"||Array.isArray(e))throw new TypeError(`expected value of type "object" but instead got value "${t}" of type "${de(e)}"`);return e},string(t){return t}},Ut={default:Sn,array:_t,object:_t};function _t(t){return JSON.stringify(t)}function Sn(t){return`${t}`}var K=class{constructor(e){this.context=e}static get shouldLoad(){return!0}static afterLoad(e,r){}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get outlets(){return this.scope.outlets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(e,{target:r=this.element,detail:n={},prefix:s=this.identifier,bubbles:i=!0,cancelable:o=!0}={}){let a=s?`${s}:${e}`:e,c=new CustomEvent(a,{detail:n,bubbles:i,cancelable:o});return r.dispatchEvent(c),c}};K.blessings=[bn,On,kn,wn];K.targets=[];K.outlets=[];K.values={};var Fe=class extends K{get html(){return this.application.element}get dom(){return this.application.element.lastElementChild}controller(e,r){return this.application.controllers.find(({context:n})=>r?n.identifier===e&&n.element.id===r:n.identifier===e)}};var N=typeof window<"u"?window:{screen:{},navigator:{}},ie=(N.matchMedia||function(){return{matches:!1}}).bind(N),Fn=!1,Vn={get passive(){return Fn=!0}},Zt=function(){};N.addEventListener&&N.addEventListener("p",Zt,Vn);N.removeEventListener&&N.removeEventListener("p",Zt,!1);var er="PointerEvent"in N,mt="ontouchstart"in N,Bn="TouchEvent"in N,Dn=mt||Bn&&ie("(any-pointer: coarse)").matches,Qt=(N.navigator.maxTouchPoints||0)>0||Dn,tr=N.navigator.userAgent||"",Pn=ie("(pointer: coarse)").matches&&/iPad|Macintosh/.test(tr)&&Math.min(N.screen.width||0,N.screen.height||0)>=768,jn=(ie("(pointer: coarse)").matches||!ie("(pointer: fine)").matches&&mt)&&!/Windows.*Firefox/.test(tr),In=ie("(any-pointer: fine)").matches||ie("(any-hover: hover)").matches||Pn||!mt,me=Qt&&(In||!jn)?"hybrid":Qt?"touchOnly":"mouseOnly";var Kn=Object.defineProperty,ur=(t,e)=>{for(var r in e)Kn(t,r,{get:e[r],enumerable:!0})},k=(t,e,r)=>new Promise((n,s)=>{var i=c=>{try{a(r.next(c))}catch(u){s(u)}},o=c=>{try{a(r.throw(c))}catch(u){s(u)}},a=c=>c.done?n(c.value):Promise.resolve(c.value).then(i,o);a((r=r.apply(t,e)).next())}),fi="content"in document.createElement("template"),pi=document.createRange&&"createContextualFragment"in document.createRange(),q=er?"pointer":"mouse",x=window.history,Ee=window.location.origin,S=Object.assign,$=Object.create,we=Array.isArray,hr=Array.from,J="",qn=()=>S($(null),{selectors:$(null),targets:["body"],timeout:3e4,globalThis:!0,schema:"spx",render:"replace",manual:!1,logs:!0,cache:!0,limit:100,preload:null,async:!0,annotate:!1,eval:{script:null,style:null,link:null,meta:!1},hover:{trigger:"href",threshold:250},intersect:{rootMargin:"0px 0px 0px 0px",threshold:0},proximity:{distance:75,threshold:250,throttle:500},progress:{background:"#111",height:"3px",minimum:.08,easing:"linear",speed:200,trickle:!0,threshold:500,trickleSpeed:200}}),l=qn(),O=$(null),H=$(null),m=$(null),P=$(null),rr=new Set;function ge(t=$(null)){return t.x=window.scrollX,t.y=window.scrollY,t}function Rn(){return new Promise(t=>requestAnimationFrame(()=>t()))}function Wn(){return new Promise(t=>setTimeout(()=>t(),0))}function zn(){return Promise.resolve()}function Hn(t){let e=document.createElement("textarea");return e.innerHTML=t,e.value}function b(t,e,r){if(t===1&&l.logs===!0)console.info("SPX: "+e);else if(t===2&&l.logs===!0)console.warn("SPX: "+e);else{r?console.error("SPX: "+e,r):console.error("SPX: "+e);try{throw t===3?new TypeError(e):new Error(e)}catch{}}}function A(t,e){return e in t}function Un(){return Math.random().toString(36).slice(2)}function _n(t=2){return(e,r)=>{let n=e.length;return(n<1||e[n-1].length===t?e.push([r]):e[n-1].push(r))&&e}}function nr(t){return t<1024?t+" B":t<1048576?(t/1024).toFixed(1)+" KB":t<1073741824?(t/1048576).toFixed(1)+" MB":(t/1073741824).toFixed(1)+" GB"}function Q(t,e){if(arguments.length===1)return n=>Q(t,n);let r=e.length;if(r!==0)for(let n=0;n<r;n++)t(e[n],n,e)}function sr(t){for(let e in t)delete t[e]}function Xn(t){return A(t,"hover")&&(t.hover===!1?l.hover=!1:typeof t.hover=="object"&&S(l.hover,t.hover),delete t.hover),A(t,"intersect")&&(t.intersect===!1?l.intersect=!1:typeof t.intersect=="object"&&S(l.intersect,t.intersect),delete t.intersect),A(t,"proximity")&&(t.proximity===!1?l.proximity=!1:typeof t.proximity=="object"&&S(l.proximity,t.proximity),delete t.proximity),A(t,"progress")&&(t.progress===!1?l.progress=!1:typeof t.progress=="object"&&S(l.progress,t.progress),delete t.progress),t}function dr(t={}){S(l,Xn(t)),A(t,"eval")&&S(l.eval,t.eval),l.index=null;let e=l.schema==="spx"?"spx":l.schema.endsWith("-")?l.schema.slice(0,-1):l.schema,r=`:not([${e}-disable]):not([href^="#"])`;l.selectors.morph=`${e}-morph`,l.selectors.render=`${e}-render`,l.selectors.hrefs=l.annotate?`a[${e}-link]${r}`:`a${r}`,l.selectors.tracking=`[${e}-track]:not([${e}-track=false])`,l.selectors.scripts=n("script"),l.selectors.scriptsHydrate=`script[${e}-eval=hydrate]:not([${e}-eval=false])`,l.selectors.styles=n("style"),l.selectors.links=n("link"),l.selectors.metas=n("meta"),l.selectors.evals=`[${e}-eval]:not([${e}-eval=false]):not(script)`,l.selectors.attributes=new RegExp("^href|"+e+"-(hydrate|append|prepend|target|progress|threshold|position|proximity|hover)$","i"),l.selectors.proximity=`a[${e}-proximity]${r}${s("proximity")}`,l.selectors.intersector=`[${e}-intersect]${s("intersect")}`,l.selectors.intersects=`a${r}${s("intersect")}`,l.selectors.hover=l.hover.trigger==="href"?`a${r}${s("hover")}`:`a[${e}-hover]${r}${s("hover")}`,H.bytes=0,H.visits=0,H.limit=l.limit;function n(i){let o=`not([${e}-eval=false])`,a=i==="link"?`${i}[rel=stylesheet]:${o},${i}[rel~=preload]:${o}`:i==="script"?`${i}[${e}-eval]:${o}:not([${e}-eval=hydrate])`:`${i}:${o}`;if(l.eval[i]===!1||l.eval[i]===null)return a;if(l.eval[i]===!0)return`${i}[${e}-eval]:${o}`;if(we(l.eval[i]))return l.eval[i].length>0?l.eval[i].map(c=>`${c}:${o}`).join(","):(b(2,`Missing eval ${i} option, SPX will use defaults`),a);b(3,`Invalid eval ${i} option, expected boolean or array`)}function s(i){let o=`:not([${e}-${i}=false]):not([${e}-link])`;if(i.charCodeAt(0)===104)return`${o}:not([${e}-proximity]):not([${e}-intersect])`;if(i.charCodeAt(0)===105)return`${o}:not([${e}-hover]):not([${e}-proximity])`;if(i.charCodeAt(0)===112)return`${o}:not([${e}-intersect]):not([${e}-hover])`}}var Yn=/(?:https?:)?\/\/(?:www\.)?/,Gn=/\b(?:append|prepend)/,Jn=/^(?:application|text)\/(?:x-)?(?:ecma|java)script|text\/javascript$/,Qn=/^\b(?:true|false)$/i,Ot=/^[+-]?\d*\.?\d+$/,Zn=/\s+/g,es=/\b(?:intersect|hover|proximity)\b/,ir=/\[?[^,'"[\]()\s]+\]?/g,ts=/\(?\[(['"]?.*['"]?,?)\]\)?/,rs=/[xy]:[0-9.]+/,ns=/[xy]|\d*\.?\d+/g,M=Ee.replace(Yn,J);function ss(t){let e=$(null);return Q((r,n,s)=>{let i=s.length-1>=n?n-1:n;n%2&&(e[s[i]]=Ot.test(r)?Number(r):r)},t),e}function fr(t,e){let r=e||$(null);for(let{nodeName:n,nodeValue:s}of t.attributes)if(l.selectors.attributes.test(n))if(n==="href")r.rev=location.pathname+location.search,e||(r.location=vt(s),r.key=r.location.pathname+r.location.search);else{let i=n.slice(1+n.lastIndexOf("-")),o=s.replace(Zn,J);ts.test(o)?r[i]=Gn.test(i)?o.match(ir).reduce(_n(2),[]):o.match(ir):rs.test(o)?r[i]=ss(o.match(ns)):Qn.test(o)?es.test(n)||(r[i]=o==="true"):Ot.test(o)?r[i]=Number(o):r[i]=o}return r}function oe(t){let e=$(null);if(t.length===1&&t.charCodeAt(0)===47)return e.pathname=t,e.hash=J,e.search=J,e;let r=t.indexOf("#");r>=0?(e.hash=t.slice(r),t=t.slice(0,r)):e.hash=J;let n=t.indexOf("?");return n>=0?(e.search=t.slice(n),t=t.slice(0,n)):e.search=J,e.pathname=t,e}function Ve(t,e){let r=t.indexOf("/",e);if(r>e){let s=t.indexOf("#",r);return s<0?t.slice(r):t.slice(r,s)}let n=t.indexOf("?",e);if(n>e){let s=t.indexOf("#",n);return s<0?t.slice(n):t.slice(n,s)}return t.length-e===M.length?"/":null}function gt(t){let e=t.startsWith("www.")?t.slice(4):t,r=e.indexOf("/");if(r>=0){let n=e.slice(r);if(e.slice(0,r)===M)return n.length>0?oe(n):oe("/")}else{let n=e.search(/[?#]/);if(n>=0){if(e.slice(0,n)===M)return oe("/"+e.slice(n))}else if(e===M)return oe("/")}return null}function is(t){return t.startsWith("http")?1:t.startsWith("//")?2:t.startsWith("www.")?3:0}function os(t){if(typeof t!="string"||t.length===0)return!1;if(t.charCodeAt(0)===47)return t.charCodeAt(1)!==47?!0:t.startsWith("www.",2)?t.startsWith(M,6):t.startsWith(M,2);if(t.charCodeAt(0)===63)return!0;if(t.startsWith("www."))return t.startsWith(M,4);if(t.startsWith("http")){let e=t.indexOf("/",4)+2;return t.startsWith("www.",e)?t.startsWith(M,e+4):t.startsWith(M,e)}}function as(t){return t.charCodeAt(0)===47?t.charCodeAt(1)!==47?oe(t):gt(t.slice(2)):t.charCodeAt(0)===63?oe(location.pathname+t):t.startsWith("https:")||t.startsWith("http:")?gt(t.slice(t.indexOf("/",4)+2)):t.startsWith("www.")?gt(t):null}function re(t){if(typeof t=="object")return t.pathname+t.search;if(t===J)return"/";let e=is(t);if(e===1){let r=t.charCodeAt(4)===115?8:7,n=t.startsWith("www.",r)?r+4:r;return t.startsWith(M,n)?Ve(t,n):null}if(e===2){let r=t.startsWith("www.",2)?6:2;return t.startsWith(M,r)?Ve(t,r):null}return e===3?t.startsWith(M,4)?Ve(t,4):null:t.startsWith(M,0)?Ve(t,0):null}function ls(){return{hostname:M,origin:Ee,pathname:location.pathname,search:location.search,hash:location.hash}}function vt(t){if(t===J)return ls();let e=as(t);return e.origin=Ee,e.hostname=M,e}function L(t,e=6){if(t instanceof Element){let n=fr(t);return n.type=e||6,n}let r=$(null);return e===7?(r.location=vt(t),r.key=re(r.location),r.rev=r.key,r.type=e):(r.rev=location.pathname+location.search,r.location=vt(typeof t=="string"?t:r.rev),r.key=re(r.location),r.type=e),r}function xt(t){return new DOMParser().parseFromString(t,"text/html")}function pr(t){let e=t.indexOf(">",t.indexOf("<title"))+1,r=t.indexOf("</title",e);return Hn(t.slice(e,r).trim())}var Z=$(null);function R(t,...e){let r=t==="store";r&&e.splice(-1,1,xt(e[e.length-1]));let n=!0;return Q(s=>{let i=s.apply(null,e);r?i instanceof Document?n=i.documentElement.outerHTML:typeof n!="string"&&(n=i!==!1):n=i!==!1},Z[t]||[]),n}function cs(t,e,r){A(Z,t)||(Z[t]=[]),Z[t].push(r?e.bind(r):e)}function us(t,e){let r=Z[t],n=[];if(r&&e){let s=0,i=r.length;for(;s<i;s++)r[s]!==e&&n.push(r[s])}return n.length?Z[t]=n:delete Z[t],this}function ve(t){t?typeof t=="string"?(delete P[m[t].uuid],delete m[t]):we(t)&&Q(e=>{delete P[m[e].uuid],delete m[e]},t):(sr(m),sr(P))}function V(t){return t.target=A(t,"target")?t.target.length===1&&t.target[0]==="body"?t.target:[].concat(l.targets,t.target):l.targets,l.cache&&(A(t,"cache")||(t.cache=l.cache),A(t,"uuid")||(t.uuid=Un())),A(t,"position")||(t.position=$(null),t.position.y=0,t.position.x=0),l.hover!==!1&&t.type===10&&(A(t,"threshold")||(t.threshold=l.hover.threshold)),l.proximity!==!1&&t.type===12&&(A(t,"proximity")||(t.proximity=l.proximity.distance),A(t,"threshold")||(t.threshold=l.proximity.threshold)),l.progress!==!1&&!A(t,"progress")&&(t.progress=l.progress.threshold),A(t,"render")||(t.render="replace"),A(t,"visits")||(t.visits=0),m[t.key]=t,m[t.key]}function kt(t,e){let r=R("store",t,e),n=typeof r=="string"?r:e;return t.type>5&&(t.type>9?t.type=1:A(m,t.rev)&&(m[t.rev].position.x=scrollX,m[t.rev].position.y=scrollY)),t.title=pr(n),!l.cache||r===!1?t:A(t,"uuid")?(m[t.key]=t,P[t.uuid]=n,R("cached",t),t):X(t,n)}function X(t,e){let r=A(m,t.key)?m[t.key]:V(t);return typeof e=="string"&&(P[r.uuid]=e,t.title=pr(e),t.position=ge()),S(r,t)}function hs(){let t=x.state.key;if(A(m,t))return m[t];b(4,`No record exists: ${t}`)}function Pe(t){if(!t){if(x.state===null)return;t=x.state.key}if(A(m,t)){let e=$(null);return e.page=m[t],e.dom=xt(P[e.page.uuid]),e}b(4,`No record exists: ${t}`)}function W(t){return A(m,t)&&A(m[t],"uuid")&&A(P,m[t].uuid)&&typeof P[m[t].uuid]=="string"}function $t(t,e){if(!(t instanceof Element))return!1;let r=t.closest(e);return r&&r.tagName==="A"?r:!1}function bt(t){if(t.nodeName!=="A")return!1;let e=t.href;return os(e)?!W(re(e)):!1}function ds(t,e){let r=[];return document.body.querySelectorAll(t).forEach(n=>{n.nodeName!=="A"?n.querySelectorAll(e).forEach(s=>{bt(n)&&r.push(s)}):bt(n)&&r.push(n)}),r}var Ct=t=>{let e=[];return document.body.querySelectorAll(t).forEach(r=>{bt(r)&&e.push(r)}),e},ae=new Map,U=new Map,fs=class extends XMLHttpRequest{constructor(){super(...arguments),this.key=null}},ee=new Map;function Mt(t,e="text"){return new Promise(function(r,n){let s=new fs;s.key=t,s.responseType=e,s.open("GET",t),s.setRequestHeader("X-SPX","true"),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.onload=function(){r(this.response)},s.onerror=function(){n(this.statusText)},s.onabort=function(){U.delete(this.key),ee.delete(this.key),ae.delete(this.key)},s.onloadend=function(i){ee.delete(this.key),H.bytes=H.bytes+i.loaded,H.visits=H.visits+1},s.send(),ee.set(t,s)})}function mr(t){return U.has(t)?(clearTimeout(U.get(t)),U.delete(t)):!0}function gr(t,e,r){U.has(t)||W(t)||U.set(t,setTimeout(e,r))}function or(t){return ee.forEach((e,r)=>{t!==r&&(e.abort(),b(2,`Pending request aborted: ${r}`))})}function ps(t){if(l.preload!==null){if(we(l.preload)){let e=l.preload.filter(r=>{let n=L(r,3);return n.key!==r?F(V(n)):!1});return Promise.allSettled(e)}else if(typeof l.preload=="object"&&A(l.preload,t.key)){let e=l.preload[t.key].map(function(r){return F(V(L(r,3)))});return Promise.allSettled(e)}}}function yr(t){return k(this,null,function*(){if(W(t))return;let e=V(L(t,4));requestIdleCallback(function(r){F(e).then(n=>{n?b(1,`Reverse fetch completed: ${n.key}`):b(2,`Reverse fetch failed: ${t}`)})},{timeout:3e3})})}function Lt(t){return k(this,null,function*(){if(!ae.has(t.key))return t;yield Wn();let e=yield ae.get(t.key);return ae.delete(t.key),U.delete(t.key),kt(t,e)})}function F(t){return k(this,null,function*(){return ee.has(t.key)&&t.type!==7?(t.type===4&&ee.has(t.rev)?(ee.get(t.rev).abort(),b(2,`Request aborted: ${t.rev}`)):b(2,`Request in transit: ${t.key}`),!1):R("fetch",t)?(ae.set(t.key,Mt(t.key)),Lt(t)):(b(2,`Request cancelled via dispatched event: ${t.key}`),!1)})}function vr(t){let e=$t(t.target,l.selectors.hover);if(!e)return;let r=L(e,10);if(W(r.key)||U.has(r.key))return;e.addEventListener(`${q}leave`,br,{once:!0});let n=V(r),s=n.threshold||l.hover.threshold;gr(r.key,function(){R("prefetch",e,r)&&F(n).then(function(i){U.delete(r.key),Er(e)})},s)}function br(t){let e=$t(t.target,l.selectors.hover);e&&mr(re(e.href))}function ms(t){t.addEventListener(`${q}enter`,vr)}function Er(t){t.removeEventListener(`${q}enter`,vr),t.removeEventListener(`${q}leave`,br)}function Tt(){!l.hover||O.hover||(Q(ms,Ct(l.selectors.hover)),O.hover=!0)}function je(){O.hover&&(Q(Er,Ct(l.selectors.hover)),O.hover=!1)}function gs({clientX:t,clientY:e},r){return t<=r.right&&t>=r.left&&e<=r.bottom&&e>=r.top}function ys(t){let e=t.getBoundingClientRect(),r=t.getAttribute(l.selectors.proximity),n=Ot.test(r)?Number(r):l.proximity.distance;return{target:t,top:e.top-n,bottom:e.bottom+n,left:e.left-n,right:e.right+n}}function vs(t){let e=!1;return function(r){if(e)return;e=!0;let n=t.findIndex(s=>gs(r,s));if(n===-1)setTimeout(()=>{e=!1},l.proximity.throttle);else{let{target:s}=t[n],i=V(L(s,12)),o=i.threshold||l.proximity.threshold;gr(i.key,()=>k(this,null,function*(){if(!R("prefetch",s,i))return ce();(yield F(i))&&(t.splice(n,1),e=!1,t.length===0&&(ce(),b(1,"Proximity observer disconnected")))}),o)}}}var Et;function Nt(){if(!l.proximity||O.proximity)return;let t=Ct(l.selectors.proximity).map(ys);t.length>0&&(Et=vs(t),addEventListener(`${q}move`,Et,{passive:!0}),O.proximity=!0)}function ce(){O.proximity&&(removeEventListener(`${q}move`,Et),O.proximity=!1)}var te;function bs(t){return k(this,null,function*(){if(t.isIntersecting){let e=L(t.target,11);if(!R("prefetch",t.target,e))return te.unobserve(t.target);(yield F(V(e)))?te.unobserve(t.target):(b(2,`Prefetch will retry at next intersect for: ${e.key}`),te.observe(t.target))}})}function St(){if(!l.intersect||O.intersect)return;te||(te=new IntersectionObserver(Q(bs),l.intersect));let t=Q(r=>te.observe(r)),e=ds(l.selectors.intersector,l.selectors.intersects);t(e),O.intersect=!0}function Ie(){O.intersect&&(te.disconnect(),O.intersect=!1)}var ne=null,wr,ye=null,yt=[];function Ft(t){let{speed:e,easing:r,minimum:n}=l.progress,s=typeof ne=="number";t=Or(t,n,1),ne=t===1?null:t;let i=Es(!s);i.offsetWidth,As(o=>{if(i.style.transform=`translate3d(${xr(t)}%,0,0)`,i.style.transition=`all ${e}ms ${r}`,t!==1)return setTimeout(o,e);i.style.transition="none",i.style.opacity="1",i.offsetWidth,setTimeout(()=>{i.style.transition=`all ${e}ms ${r}`,i.style.opacity="0",setTimeout(()=>[ws(),o()],e)},e)})}function Ar(t){let e=ne;if(!e)return Vt();if(e<1)return typeof t!="number"&&(e>=0&&e<.2?t=.1:e>=.2&&e<.5?t=.04:e>=.5&&e<.8?t=.02:e>=.8&&e<.99?t=.005:t=0),e=Or(e+t,0,.994),Ft(e)}function Es(t){if(ye)return ye;document.documentElement.classList.add("spx-load");let e=t?"-100":xr(ne||0),r=document.createElement("div");return r.id="spx-progress",r.style.pointerEvents="none",r.style.background=l.progress.background,r.style.height=l.progress.height,r.style.position="fixed",r.style.zIndex="9999999",r.style.top="0",r.style.left="0",r.style.width="100%",r.style.transition="all 0 linear",r.style.transform=`translate3d(${e}%,0,0)`,document.body.appendChild(r),ye=r,r}function ws(){document.documentElement.classList.remove("spx-load"),document.getElementById("spx-progress")&&document.body.removeChild(ye),ye=null}function Or(t,e,r){return t<e?e:t>r?r:t}function xr(t){return(-1+t)*100}function As(t){let e=()=>{let r=yt.shift();r&&r(e)};yt.push(t),yt.length===1&&e()}function Vt(t){l.progress&&(wr=setTimeout(function(){ne||Ft(0);function e(){setTimeout(()=>{ne&&(Ar(),e())},l.progress.trickleSpeed)}l.progress.trickle&&e()},t||0))}function Os(t){if(clearTimeout(wr),!(!t&&!ne))return Ar(.3+.5*Math.random()),Ft(1)}function xs(t){return new Promise((e,r)=>{let n=document.createElement("script");n.addEventListener("error",r,{once:!0}),n.async=!1,n.text=t.target.text;for(let{nodeName:s,nodeValue:i}of t.target.attributes)n.setAttribute(s,i);document.contains(t.target)?t.target.replaceWith(n):(document.head.append(n),t.external?n.addEventListener("load",()=>n.remove(),{once:!0}):n.remove()),t.external&&n.addEventListener("load",()=>e(),{once:!0}),e()})}function ks(t){if(!t.hasAttribute("src")&&!t.text)return;let e=t.type?t.type.trim().toLowerCase():"text/javascript",r=Jn.test(e)?1:e==="module"?2:NaN,n=$(null);return n.blocking=!0,n.evaluate=!1,n.external=!1,isNaN(r)||t.noModule&&r===1||(t.src&&(n.external=!0),(r!==1||n.external&&(t.hasAttribute("async")||t.defer))&&(n.blocking=!1),n.evaluate=!0,n.target=t),n}function ar(t){return k(this,null,function*(){try{let e=xs(t);t.blocking&&(yield e)}catch(e){console.error(e)}})}function $s(t){return k(this,null,function*(){let e=hr(t,ks).filter(r=>r.evaluate).reduce((r,n)=>k(this,null,function*(){return n.external?Promise.all([r,ar(n)]):(yield r,yield ar(n))}),Promise.resolve());yield Promise.race([e])})}function Cs(t){return t?t.getAttribute&&t.getAttribute("id")||t.id:void 0}function Be(t,e){let r=t.nodeName,n=e.nodeName;if(r===n)return!0;let s=r.charCodeAt(0),i=n.charCodeAt(0);return s<=90&&i>=97||s<=90&&i>=97?r===n.toUpperCase():!1}function Ms(t,e){return!e||e==="http://www.w3.org/1999/xhtml"?document.createElement(t):document.createElementNS(e,t)}function Ls(t,e){let r=t.firstChild;for(;r;){let n=r.nextSibling;e.appendChild(r),r=n}return e}function Ts(t,e){if(e.nodeType===11||t.nodeType===11)return;let r=e.attributes,n,s,i,o,a;for(let u=r.length-1;u>=0;u--)n=r[u],s=n.name,o=n.value,i=n.namespaceURI,i?(s=n.localName||s,a=t.getAttributeNS(i,s),a!==o&&(n.prefix==="xmlns"&&(s=n.name),t.setAttributeNS(i,s,o))):(a=t.getAttribute(s),a!==o&&t.setAttribute(s,o));let c=t.attributes;for(let u=c.length-1;u>=0;u--)n=c[u],s=n.name,o=n.value,i=n.namespaceURI,i?(s=n.localName||s,e.hasAttributeNS(i,s)||t.removeAttributeNS(i,s)):e.hasAttribute(s)||t.removeAttribute(s)}var kr={};ur(kr,{INPUT:()=>Ss,OPTION:()=>Ns,SELECT:()=>Fs,TEXTAREA:()=>$r});function wt(t,e,r){t[r]!==e[r]&&(t[r]=e[r],t[r]?t.setAttribute(r,""):t.removeAttribute(r))}function Ns(t,e){let r=t.parentNode;if(r){let n=r.nodeName.toUpperCase();n==="OPTGROUP"&&(r=r.parentNode,n=r&&r.nodeName.toUpperCase()),n==="SELECT"&&!r.hasAttribute("multiple")&&(t.hasAttribute("selected")&&!e.selected&&(t.setAttribute("selected","selected"),t.removeAttribute("selected")),r.selectedIndex=-1)}wt(t,e,"selected")}function Ss(t,e){wt(t,e,"checked"),wt(t,e,"disabled"),t.value!==e.value&&(t.value=e.value),e.hasAttribute("value")||t.removeAttribute("value")}function $r(t,e){let r=e.value;t.value!==r&&(t.value=r);let n=t.firstChild;if(n){let s=n.nodeValue;if(s===r||!r&&s===t.placeholder)return;n.nodeValue=r}}function Fs(t,e){if(!e.hasAttribute("multiple")){let r=-1,n=0,s=t.firstChild,i,o;for(;s;)if(o=s.nodeName&&s.nodeName.toUpperCase(),o==="OPTGROUP")i=s,s=i.firstChild;else{if(o==="OPTION"){if(s.hasAttribute("selected")){r=n;break}n++}s=s.nextSibling,!s&&i&&(s=i.nextSibling,i=null)}t.selectedIndex=r}}function De(){}function be(t,e,r){r||(r={}),e.nodeType===11&&(e=e.firstElementChild);let n=r.getNodeKey||Cs,s=r.onNodeAdded||De,i=r.onBeforeNodeDiscarded||De,o=r.onNodeDiscarded||De,a=r.onBeforeElChildrenUpdated||De,c=new Map,u=[];function C(f,d){if(f.nodeType===1){let h=f.firstChild;for(;h;){let E;d&&(E=n(h))?u.push(E):h.firstChild&&C(h,d),h=h.nextSibling}}}function j(f,d,h){i(f)!==!1&&(d&&d.removeChild(f),C(f,h))}function T(f){if(f.nodeType===1||f.nodeType===11){let d=f.firstChild;for(;d;){let h=n(d);h&&c.set(h,d),T(d),d=d.nextSibling}}}T(t);function Y(f){s(f);let d=f.firstChild;for(;d;){let h=d.nextSibling,E=n(d);if(E){let B=c.get(E);B&&Be(d,B)?(d.parentNode.replaceChild(B,d),w(B,d)):Y(d)}else Y(d);d=h}}function ue(f,d,h){for(;d;){let E=d.nextSibling;(h=n(d))?u.push(h):j(d,f,!0),d=E}}function w(f,d){let h=n(d);h&&c.delete(h),f.isEqualNode(d)!==!0&&f.getAttribute(l.selectors.morph)!=="false"&&(f.getAttribute(l.selectors.morph)!=="children"&&Ts(f,d),a(f,d)!==!1&&(f.nodeName!=="TEXTAREA"?g(f,d):$r(f,d)))}function g(f,d){let h=d.firstChild,E=f.firstChild,B,D,se,xe,G;e:for(;h;){for(xe=h.nextSibling,B=n(h);E;){if(se=E.nextSibling,h.isSameNode&&h.isSameNode(E)){h=xe,E=se;continue e}D=n(E);let ke=E.nodeType,I;if(ke===h.nodeType&&(ke===1?(B?B!==D&&((G=c.get(B))?se===G?I=!1:(f.insertBefore(G,E),D?u.push(D):j(E,f,!0),E=G,D=n(E)):I=!1):D&&(I=!1),I=I!==!1&&Be(E,h),I===!1&&c.has(D)&&c.get(D).getAttribute(l.selectors.morph)==="children"&&(I=!0),I&&w(E,h)):(ke===3||ke===8)&&(I=!0,E.nodeValue!==h.nodeValue&&(E.nodeValue=h.nodeValue))),I){h=xe,E=se;continue e}D?u.push(D):j(E,f,!0),E=se}B&&(G=c.get(B))&&Be(G,h)?(f.appendChild(G),w(G,h)):(h.actualize&&(h=h.actualize(f.ownerDocument||document)),f.appendChild(h),Y(h)),h=xe,E=se}ue(f,E,D);let Pt=kr[f.nodeName];Pt&&Pt(f,d)}let v=t,y=v.nodeType,he=e.nodeType;if(y===1)he===1?Be(t,e)||(o(t),v=Ls(t,Ms(e.nodeName,e.namespaceURI))):v=e;else if(y===3||y===8){if(he===y)return v.nodeValue!==e.nodeValue&&(v.nodeValue=e.nodeValue),v;v=e}if(v===e)o(t);else{if(e.isSameNode&&e.isSameNode(v))return;if(w(v,e),u)for(let f=0,d=u.length;f<d;f++){let h=c.get(u[f]);h&&j(h,h.parentNode,!1)}}return v!==t&&t.parentNode&&(v.actualize&&(v=v.actualize(t.ownerDocument||document)),t.parentNode.replaceChild(v,t)),v}function Vs(t,e){return t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_PRECEDING||-1}function Cr(t,e){return k(this,null,function*(){let r=e===7?l.selectors.scriptsHydrate:l.selectors.scripts,n=hr(t.querySelectorAll(r));yield $s(n.sort(Vs))})}function Bs(t){document.head.querySelectorAll(l.selectors.evals).forEach(e=>{t.head.contains(e)||e.remove()}),document.head.append(...t.querySelectorAll(l.selectors.evals))}function Ds(t){let e=t.querySelectorAll(l.selectors.tracking);if(e!==null)for(let r of e)r.hasAttribute("id")?rr.has(r.id)||(document.body.appendChild(r),rr.add(r.id)):b(2,`Tracked node <${r.tagName.toLowerCase()}> must contain an id attribute`)}function Ps(t,e){let r=t.target,n=t.render;if(r.length===1&&r[0]==="body")n==="morph"?be(document.body,e.body):n==="replace"?document.body.replaceChildren(e.body):document.body.innerHTML=e.body.innerHTML;else{let s=r.join(","),i=e.body.querySelectorAll(s);document.body.querySelectorAll(s).forEach((o,a)=>{if(o.isEqualNode(i[a])||!R("render",o,i[a]))return;let c=n;if(o.hasAttribute(l.selectors.render)){let u=o.getAttribute(l.selectors.render);u!==c&&(c=u)}if(c==="morph"?be(o,i[a]):t.render==="replace"?o.replaceWith(i[a]):o.innerHTML=i[a].innerHTML,t.append||t.prepend){let u=document.createElement("div");return e.childNodes.forEach(u.appendChild),t.append?o.appendChild(u):o.insertBefore(u,o.firstChild)}}),Ds(e.body)}}function js(t,e){let r=t.hydrate;if(r.length===1&&r[0]==="body"){be(document.body,e.body);return}let n=r.join(","),s=document.body.querySelectorAll(n),i=t.preserve&&t.preserve.length>0?t.preserve.join(","):null,o=[];if(i&&document.body.querySelectorAll(i).forEach(a=>{a.setAttribute("spx-morph","false"),o.push(a)}),s.length>0){let a=e.body.querySelectorAll(n);s.forEach((c,u)=>{if(a[u]instanceof HTMLElement){if(!R("hydrate",c,a[u]))return;be(c,a[u])}})}if(i)for(let a of o)a.removeAttribute("spx-morph");Cr(e,7),t.hydrate=void 0,t.preserve=void 0,t.type=6,X(t)}function _(t){return k(this,null,function*(){yield Rn(),je(),Ie(),ce(),document.title=t.title;let e=xt(P[t.uuid]);return t.type===7?js(t,e):(Bs(e),Ps(t,e),scrollTo(t.position.x,t.position.y),Cr(e,t.type)),Os(),Tt(),St(),Nt(),R("load",t),t})}var Mr={};ur(Mr,{api:()=>x,connect:()=>Nr,disconnect:()=>Sr,doReverse:()=>Lr,get:()=>Is,push:()=>Ke,replace:()=>Ae});function Bt(t){let e=$(null);return e.key=t.key,e.rev=t.rev,e.title=t.title,e.position=t.position,e}function Is(){return x.state}function Lr(){return x.state!==null&&A(x.state,"rev")&&x.state.key!==x.state.rev}function Ae(t){return x.replaceState(Bt(t),t.title,t.key),b(1,`ReplaceState triggered for: ${t.key}`),t}function Ke(t){return x.pushState(Bt(t),t.title,t.key),t}function Tr(t){return k(this,null,function*(){if(b(1,"PopState visit incurred"),document.readyState!=="complete"&&(yield zn()),t.state!==null)if(W(t.state.key))yr(t.state.rev),yield _(m[t.state.key]);else{t.state.type=5;let e=yield F(t.state);if(!e)return location.assign(t.state.key);let r=re(location);if(e.key===r)yield _(e);else if(W(r))yield _(m[r]);else{let n=V(L(r,5));yield F(n),x.pushState(n,document.title,r)}}})}function Nr(t){O.history||(x.scrollRestoration&&(x.scrollRestoration="manual"),x.state===null&&t&&x.replaceState(Bt(t),t.title,t.key),addEventListener("popstate",Tr,!1),O.history=!0)}function Sr(){O.history&&(x.scrollRestoration&&(x.scrollRestoration="auto"),removeEventListener("popstate",Tr,!1),O.history=!1)}function Ks(t){return!(t.target&&t.target.isContentEditable||t.defaultPrevented||t.which>1||t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)}function le(t){if(!Ks(t))return;let e=$t(t.target,l.selectors.hrefs);if(!e)return;let r=re(e.href);if(r!==null&&R("visit",t))if(je(),ce(),Ie(),W(r)){let n=fr(e,m[r]),s=X(n);e.addEventListener("click",function(i){i.preventDefault(),m[s.rev].position=ge(),Ke(s),_(s)},{once:!0})}else if(ae.has(r)){let n=m[r];or(r),b(1,`Request in transit: ${r}`),e.addEventListener("click",function(s){s.preventDefault(),m[n.rev].position=ge(),At(n)},{once:!0})}else{or(),mr(r);let n=L(e,6),s=V(n);F(s),e.addEventListener("click",function(i){i.preventDefault(),m[s.rev].position=ge(),At(s)},{once:!0})}}function At(t){return k(this,null,function*(){Vt(t.progress);let e=yield Lt(t);if(e)Ke(e),_(e);else return location.assign(t.key)})}function lr(t,e){return k(this,null,function*(){if(e){typeof e.cache=="string"&&(e.cache==="clear"?ve():ve(e.key)),Vt(e.progress);let r=yield F(e);r?(Ke(r),_(r)):location.assign(e.key)}else return At(m[t])})}function qs(){O.hrefs||(me==="mouseOnly"?addEventListener(`${q}down`,le,!1):(me==="touchOnly"||addEventListener(`${q}down`,le,!1),addEventListener("touchstart",le,!1)),O.hrefs=!0)}function Rs(){O.hrefs&&(me==="mouseOnly"?removeEventListener(`${q}down`,le,!1):(me==="touchOnly"||removeEventListener(`${q}down`,le,!1),removeEventListener("touchstart",le,!1)),O.hrefs=!1)}var cr=$(null);function Ws(t){scrollY in cr&&Ae(m[cr[scrollY]])}function zs(){O.scroll||(addEventListener("scroll",Ws,{passive:!0}),O.scroll=!0)}function Hs(){let t=V(L(0));Nr(t),l.index=t.key;function e(){qs(),l.manual===!1&&(Tt(),St(),Nt(),zs());let r=kt(t,document.documentElement.outerHTML);return Lr()&&(r.rev=x.state.rev),r.position=ge(),Ae(r),r.rev!==r.key&&setTimeout(()=>yr(r.rev),0),setTimeout(()=>ps(r),0),r}return new Promise(r=>{if(document.readyState==="complete"||document.readyState==="interactive")return r(e());addEventListener("DOMContentLoaded",()=>r(e()),{once:!0})})}function Us(){je(),Tt(),Ie(),St(),ce(),Nt()}function _s(){Sr(),Rs(),je(),Ie(),ce(),ve(),l.globalThis&&delete window.spx,b(1,"Disconnected \u{1F614}")}var Fr=!!(window.history.pushState&&window.requestAnimationFrame&&window.addEventListener&&window.DOMParser),Vr=S($(null),{supported:Fr,on:cs,off:us,observe:Us,history:Mr,connect:Xs,capture:ei,render:Zs,session:Ys,state:Gs,reload:Js,fetch:Qs,clear:ve,hydrate:ri,prefetch:ti,visit:ni,disconnect:_s,get config(){return l}});function Xs(t={}){if(typeof document>"u")return b(4,"SPX only runs in the browser");if(!Fr)return b(4,"Browser does not support SPX");if(!window.location.protocol.startsWith("http"))return b(4,"Invalid protocol, SPX expects https or http protocol");dr(t);let e=Hs();return function(r){return k(this,null,function*(){let n=yield e;if(l.globalThis&&Object.defineProperty(window,"spx",{get(){return Vr}}),r.constructor.name==="AsyncFunction")try{yield r(n)}catch(s){b(2,"Connection Error",s)}else r(n);b(1,"Connection Established \u26A1")})}}function Ys(t,e){if(t)if(e)t==="config"&&dr(e),t==="observers"&&S(O,e);else{if(t==="config")return l;if(t==="observers")return O;if(t==="pages")return m;if(t==="snapshots")return P;if(t==="memory")return nr(H.bytes)}let r=$(null);return r.config=l,r.snapshots=P,r.pages=m,r.observers=O,r.memory=H,r.memory.size=nr(r.memory.bytes),r}function Gs(t,e){if(t===void 0)return Pe();if(typeof t=="string"){let r=re(t);W(r)||b(4,`No store exists at: ${r}`);let n=Pe(r);return e!==void 0?X(S(n.page,e)):n}if(typeof t=="object")return X(t)}function Js(){return k(this,null,function*(){let t=m[x.state.key];t.type=9;let e=yield F(t);return e?(b(1,"Triggered reload, page was re-cached"),_(e)):(b(2,"Reload failed, triggering refresh (cache will be purged)"),location.assign(t.key))})}function Qs(t){return k(this,null,function*(){let e=L(t,2);e.location.origin!==Ee&&b(4,"Cross origin fetches are not allowed");let r=yield Mt(e.key);if(r)return r})}function Zs(t,e,r){return k(this,null,function*(){let n=hs(),s=L(t);s.location.origin!==Ee&&b(4,"Cross origin fetches are not allowed");let i=yield Mt(s.key,"document");if(i||b(4,`Fetch failed for: ${s.key}`,i),yield r.call(n,i),e==="replace"){n.title=i.title;let o=X(S(n,s),i.documentElement.outerHTML);return Ae(o),o}else return _(kt(s,i.documentElement.outerHTML))})}function ei(t){let{page:e,dom:r}=Pe();if(t=we(t)?t:e.target,t.length===1&&t[0]==="body"){r.body.replaceChildren(document.body),X(e,r.documentElement.innerHTML);return}let n=t.join(","),s=document.body.querySelectorAll(n);r.body.querySelectorAll(n).forEach((i,o)=>{be(i,s[o])}),X(e,r.documentElement.innerHTML)}function ti(t){return k(this,null,function*(){let e=L(t,1);if(W(e.key)){b(2,`Cache already exists for ${e.key}, prefetch skipped`);return}let r=yield F(V(e));if(r)return r;b(4,`Prefetch failed for ${e.key}`)})}function ri(t,e){return k(this,null,function*(){let r=L(t,7);if(F(r),we(e)){r.hydrate=[],r.preserve=[];for(let s of e)s.charCodeAt(0)===33?r.preserve.push(s.slice(1)):r.hydrate.push(s)}else r.hydrate=l.targets;let n=yield Lt(r);if(n){let{key:s}=x.state;if(Ae(n),_(n),r.key!==s){l.index===s&&(l.index=r.key);for(let i in m)m[i].rev===s&&(m[i].rev=r.key);ve(s)}}return Pe(n.key).dom})}function ni(t,e){return k(this,null,function*(){let r=L(t),n=typeof e=="object"?S(r,e):r;return W(r.key)?lr(r.key,X(n)):lr(r.key,V(n))})}var Oe=Vr;var p=function(t){if(Array.isArray(t))return t.forEach(p);if(!("id"in t)){for(let n of["onenter","onexit","oninit","onresize"])if(n in t)throw new Error('qvp: Missing an "id" reference');return Object.entries(t).forEach(([n,s])=>{let i=typeof t[n];if(i==="string")return p({id:n,query:s});throw new TypeError(`qvp: Invalid query type. Expected "string" received "${i}"`)})}let e=si(t),{id:r}=e.screen;p.viewports.size||addEventListener("resize",Br(()=>{p.viewports.forEach(n=>{n.screen.active&&n.onresize(window.innerWidth)})},25),!0),p.viewports.has(r)?console.warn(`qvp: The id "${r}" is already defined, use qvp.add() instead.`):p.viewports.set(r,e)};p.viewports=new Map;Object.defineProperty(p,"isTouch",{get(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}});p.get=t=>p.viewports.has(t)?p.viewports.get(t):!1;p.add=(t,e)=>{let r=p.get(t);if(r===!1)return console.error(`qvp: There is no viewport using an id of "${t}"`);Re(e,r.screen),r.screen.test.matches&&r.onenter()};p.off=(t,e)=>{let r=p.get(t.split(":")[0]);if(r===!1||!(t in r.events))return;let n=r.events[t].length;if(typeof e=="number")e<=n-1&&r.events[t].splice(e,1);else if(typeof e=="function"){let s=[];for(let i=0;i<n;i++)r.events[t][i]!==e&&s.push(r.events[t][i]);s.length>0&&(r.events[t]=s)}else delete r.events[t]};p.on=(t,e,r)=>{let[n,s]=t.split(":"),i=p.get(n);if(i===!1)return;t in i.events||(i.events[t]=[]);let o=r?e.bind(r):e;return o["qvp:event"]=i.events[t].length,i.events[t].push(o),i.screen.test.matches?s==="oninit"?o.call():(s==="onenter"&&o.call(),Re({[s]:o},i.screen)):Re({[s]:o},i.screen),o["qvp:event"]};p.list=t=>{let e=Array.from(p.viewports.values()).map(({screen:r})=>r);return t?e.filter(({id:r})=>t.includes(r)):e};p.active=t=>{let e=p.list();if(t){let n=p.get(t);return n?n.screen.active:!1}let r=e.filter(({active:n})=>n===!0);return r.length>1?r:r[0]};p.test=(t,e=",")=>typeof t=="string"?t.indexOf(e)>-1?t.split(e).some(p.active):!!p.active(t):t.some(p.active);p.remove=t=>{p.viewports.has(t)&&(p.viewports.get(t).destroy(),p.viewports.delete(t))};p.destroy=()=>{removeEventListener("resize",Br()),p.viewports.forEach(t=>t.destroy()),p.viewports.clear()};p.screens=()=>{throw Error("qvp: The qvp.screens() is deprecated, use the default import, e.g: qvp(...)")};function Br(t,e){let r=e;return function(){let n=()=>{r=null,t.apply(this,arguments)};r&&cancelAnimationFrame(r),r=requestAnimationFrame(n)}}function Re(t,e){typeof t.onenter=="function"&&("qvp:event"in t.onenter||(t.onenter["qvp:event"]=NaN),e.onenter.add(t.onenter)),typeof t.onexit=="function"&&("qvp:event"in t.onexit||(t.onexit["qvp:event"]=NaN),e.onexit.add(t.onexit)),typeof t.onresize=="function"&&("qvp:event"in t.onresize||(t.onresize["qvp:event"]=NaN),e.onresize.add(t.onresize)),typeof t.oninit=="function"&&("qvp:event"in t.oninit||(t.oninit["qvp:event"]=NaN),e.oninit.add(t.oninit))}function qe(t,...e){let r=p.get(t.split(":")[0]);if(r!==!1&&t in r.events)for(let n=0;n<r.events[t].length&&(r.events[t][n].apply(null,e),t.endsWith(":oninit")&&p.off(t,n),t in r.events);n++);}function si(t){let e=t.query||"all",r={id:t.id,query:e,active:!1,test:matchMedia(e),onenter:new Set,onexit:new Set,onresize:new Set,oninit:new Set,events:Object.create(null)};Re(t,r);let n=()=>{r.oninit.size>0&&(r.oninit.forEach(c=>!isNaN(c["qvp:event"])||c()),qe(`${t.id}:oninit`),r.oninit.clear()),r.onenter.forEach(c=>!isNaN(c["qvp:event"])||c()),qe(`${t.id}:onenter`),r.active=!0},s=()=>{r.onexit.forEach(c=>!isNaN(c["qvp:event"])||c()),qe(`${t.id}:onexit`),r.active=!1},i=c=>{r.onresize.forEach(u=>!isNaN(u["qvp:event"])||u()),qe(`${t.id}:onresize`,c)},o=({matches:c})=>c?n():s(),a=()=>{for(let c in r.events)delete r.events[c];r.test.removeEventListener("change",o)};return r.test.addEventListener("change",o),r.test.matches&&n(),{onenter:n,onexit:s,onresize:i,destroy:a,get screen(){return r},get events(){return r.events}}}var Dr=p;var We=class t extends Fe{constructor(){super(...arguments);this.transition=r=>{if(r.propertyName==="transform"){if(this.hasShiftValue)for(let n of this.shifts)n.classList.contains(this.shiftClass)&&(n.classList.remove(this.shiftClass),n.style.removeProperty("transform"));this.hasBackdropClass&&this.backdrop.classList.contains(this.backdropClass)&&this.backdrop.classList.remove(this.backdropClass),this.modeValue==="pull"?this.shifts.item(0).removeEventListener(r.type,this.transition):this.target.removeEventListener(r.type,this.transition)}};this.outsideClick=r=>{r.target!==this.target&&(this.close(),document.documentElement.removeEventListener("click",this.outsideClick,!1))};this.toggle=r=>(r&&r.preventDefault(),this.isOpenValue=!this.isOpenValue,this.isOpenValue?this.open():this.close(),this.isOpenValue?this.open():this.close());this.touchMove=r=>{this.isOpenValue&&this.target.scrollHeight<=this.target.clientHeight&&r.preventDefault()};this.keyboard=r=>{switch(r.code){case"Esc":case"Escape":this.close();break}}}static{this.values={outsideClick:Boolean,height:String,width:String,offset:String,direction:String,shift:String,redraw:String,useParent:{type:Boolean,default:!1},isOpen:{type:Boolean,default:!1},bodyScroll:{type:Boolean,default:!1},backdrop:{type:Boolean,default:!0},mode:{type:String,default:"overlay"}}}static{this.targets=["mount"]}static{this.classes=["backdrop"]}get backdrop(){return t.backdrop}get directionClass(){return`drawer-${this.directionValue}`}get shiftClass(){return`drawer-${this.modeValue}`}get shifts(){return document.documentElement.querySelectorAll(this.shiftValue)}get buttons(){return document.documentElement.querySelectorAll(`[data-drawer="${this.target.id}"]`)}initialize(){t.backdrop||(t.backdrop=document.createElement("div"),t.backdrop.className="drawer-backdrop",t.backdrop.setAttribute("spx-morph","false")),this.useParentValue?(this.target=this.element.parentElement,this.target.ariaHidden="true"):this.target=this.element,this.target.classList.contains("d-none")&&this.target.classList.remove("d-none"),this.modeValue!=="overlay"&&this.hasShiftValue===!1&&console.error('Missing "data-drawer-shift-value" defintions on:',this.target)}connect(){for(let r of this.buttons)r.addEventListener("click",this.toggle);document.documentElement.contains(t.backdrop)===!1&&document.documentElement.appendChild(t.backdrop),this.hasWidthValue&&this.target.style.setProperty("width",this.widthValue),this.hasHeightValue&&this.target.style.setProperty("height",this.heightValue),this.hasDirectionValue&&this.target.classList.contains(this.directionClass)===!1&&this.target.classList.add(this.directionClass),this.modeValue==="pull"&&(this.target.style.setProperty("transform","translateX(0)"),this.target.style.setProperty("z-index","0")),this.html.classList.contains("drawer-open")&&this.html.classList.remove("drawer-open"),Oe.on("load",this.onLoad,this)}disconnect(){}onLoad(){this.isOpenValue&&(Dr.test(["lg","xl","xxl"])?this.close():setTimeout(this.close.bind(this),200))}open(){this.target.classList.contains("drawer-active")||this.target.classList.add("drawer-active"),this.hasBackdropClass&&!this.backdrop.classList.contains(this.backdropClass)&&this.backdrop.classList.add(this.backdropClass),this.bodyScrollValue===!1&&document.documentElement.style.setProperty("overflow","hidden"),this.hasShiftValue&&this.shiftNodes(),this.hasWidthValue&&(this.directionValue==="top"?this.backdrop.style.setProperty("transform",`translateY(-${this.offsetValue})`):this.backdrop.style.setProperty("transform",`translateX(-${this.widthValue})`)),this.html.classList.add("drawer-open"),this.backdrop.addEventListener("click",this.toggle,{once:!0}),this.target.addEventListener("touchstart",this.touchStart,{passive:!0}),this.target.ariaHidden="false"}close(){this.isOpenValue&&(this.isOpenValue=!1),this.hasWidthValue&&this.backdrop.style.removeProperty("transform"),this.bodyScrollValue===!1&&document.documentElement.style.removeProperty("overflow"),this.hasShiftValue?this.shiftNodes():this.target.addEventListener("transitionend",this.transition),this.html.classList.remove("drawer-open"),this.target.removeEventListener("touchstart",this.touchStart),this.backdrop.removeEventListener("click",this.toggle),this.target.classList.remove("drawer-active"),this.target.ariaHidden="true"}shiftNodes(){this.modeValue==="pull"?(this.target.style.setProperty("transform","translateX(0)"),this.target.style.setProperty("z-index","0"),this.isOpenValue===!1&&this.shifts.item(0).addEventListener("transitionend",this.transition)):this.isOpenValue===!1&&this.target.addEventListener("transitionend",this.transition);for(let r of this.shifts)this.isOpenValue?(r.classList.contains(this.shiftClass)||r.classList.add(this.shiftClass),this.hasWidthValue&&(this.directionValue==="left"||this.directionValue==="right")?r.style.setProperty("transform",`translateX(-${this.widthValue})`):this.hasHeightValue&&(this.directionValue==="top"||this.directionValue==="bottom")&&r.style.setProperty("transform",`translateY(-${this.heightValue})`)):this.hasWidthValue&&(this.directionValue==="left"||this.directionValue==="right")?r.style.setProperty("transform","translateX(0)"):this.hasHeightValue&&(this.directionValue==="top"||this.directionValue==="bottom")&&r.style.setProperty("transform","translateY(0)")}touchStart({target:r}){if(r instanceof HTMLElement){let{scrollTop:n,offsetHeight:s}=r,i=n+s;n===0?r.scrollTop=1:i===n&&(r.scrollTop=n-1)}}};var Dt=class extends K{static{this.targets=[""]}connect(){}};Oe.connect({targets:["#main"],render:"replace"})(function(){let t=Ne.start();t.register("control",Dt),t.register("drawer",We),ze()});Oe.on("load",()=>{ze()});
