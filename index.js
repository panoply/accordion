var h='<path d="M9 18l6-6-6-6"/>',v='<path d="M6 9l6 6 6-6"/>';var g='<rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 9.9-1"/>';var y=i=>({emit:(e,t,...o)=>{let a=i[e]||[],b=a.length;for(let d=0;d<b;d++)a[d].apply(t,o)},on:(e,t)=>{i[e]||(i[e]=[]),i[e].push(t)},off:(e,t)=>{let o=[],a=i[e];if(a&&t){let b=0,d=a.length;for(;b<d;b++)a[b]!==t&&o.push(a[b])}o.length?a[e]=o:delete a[e]}}),f=(i,e,t)=>{let o=i.config;o.aria&&(e.button.setAttribute("aria-controls",e.content.id),e.button.setAttribute("aria-expanded",String(e.opened)),e.button.setAttribute("aria-disabled",String(e.disabled)),e.content.setAttribute("role","region"),e.content.setAttribute("aria-labelledby",e.button.id));let a=()=>{e.content.style.height="auto",e.content.classList.add("opened"),e.button.classList.add("opened"),t.emit("opened",i,e)},b=()=>{e.button.classList.remove("open"),e.content.classList.remove("open"),t.emit("closed",i,e)};e.enable=()=>{let n=e.disabled=!1;e.button.classList.remove("disabled"),e.content.classList.remove("disabled"),o.aria&&e.button.setAttribute("aria-disabled",String(n))},e.disable=()=>{let n=e.disabled=!0;e.content.classList.add("disable"),e.button.classList.add("disable"),o.aria&&e.button.setAttribute("aria-disabled",String(n))},e.open=(n=!0)=>{if(e.opened)return;t.emit("open",i,e);let u=e.opened=!0;o.persist||e.disable(),o.aria&&e.button.setAttribute("aria-expanded",String(u)),e.button.classList.add("open"),e.content.classList.add("open"),n?e.content.style.height=`${e.content.offsetHeight}px`:a()},e.close=(n=!0)=>{if(!e.opened)return;t.emit("close",i,e);let u=e.opened=!1;o.persist||e.enable(),o.aria&&e.button.setAttribute("aria-expanded",String(u)),e.button.classList.remove("opened"),e.content.classList.remove("opened"),n?(e.content.style.height=`${e.content.offsetHeight}px`,requestAnimationFrame(()=>{e.content.style.height="0px"})):b()},e.toggle=(n=!0)=>e.opened?e.close(n):e.open(n),e.focus=()=>e.button.focus(),e.blur=()=>e.button.blur();let d=n=>{n.target===n.currentTarget&&n.propertyName==="height"&&(e.opened?a():b())},s=()=>{e.focused=!0,e.button.classList.add("focus"),e.content.classList.add("focus"),t.emit("focus",i,e)},r=()=>{e.focused=!1,e.button.classList.remove("focus"),e.content.classList.remove("focus"),t.emit("blur",i,e)},c=()=>{e.focus(),!e.disabled&&e.toggle()},l=n=>{if(!o.keyboard)return;let{which:u}=n,p=null;if(u===40)p="next";else if(u===38)p="prev";else if(u===36)p="first";else if(u===35)p="last";else if(u===34&&n.ctrlKey)p="next";else if(u===33&&n.ctrlKey)p="prev";else return;p&&(n.preventDefault(),i.focus(p))},m=n=>{if(!o.keyboard||!n.ctrlKey)return;let u=n.which===34?"next":n.which===33?"prev":null;u&&(n.preventDefault(),i.focus(u))};return e.button.addEventListener("focus",s),e.button.addEventListener("blur",r),e.button.addEventListener("click",c),e.button.addEventListener("keydown",l),e.content.addEventListener("keydown",m),e.content.addEventListener("transitionend",d),e.destroy=()=>{e.button.removeEventListener("focus",s),e.button.removeEventListener("blur",r),e.button.removeEventListener("click",c),e.button.removeEventListener("keydown",l),e.content.removeEventListener("keydown",m),e.content.removeEventListener("transitionend",d),o.aria&&(e.button.removeAttribute("aria-controls"),e.button.removeAttribute("aria-expanded"),e.button.removeAttribute("aria-disabled"),e.content.removeAttribute("role"),e.content.removeAttribute("aria-labelledby")),e.button.classList.remove("open","opened","focus"),e.content.classList.remove("open","opened","focus"),e.content.style.height="0px",e.button.removeAttribute("id"),e.content.removeAttribute("id")},e},L=i=>{let e=Object.create(null);return e.initial=0,e.preserve=!1,e.persist=!0,e.multiple=!1,e.keyboard=!0,e.aria=!0,e.icons=Object.create(null),e.icons.opened=v,e.icons.closed=h,e.icons.locked=g,i.icons&&(Object.assign(e.icons,i.icons),delete i.icons),Object.assign(e,i),e},x=(i,e)=>{"accordion"in window||(window.accordion=Object.create(null));let t=Object.create(null);t.folds=[],t.events=Object.create(null),t.id=`A${Object.keys(window.accordion).length}`,t.element=typeof i=="string"?document.body.querySelector(i):i,t.config=L(e);let o=y(t.events);t.on=o.on,t.focus=s=>{let r=null,c=t.folds.length;for(let l=0;l<c&&r===null;l++)c[l].focused&&(r=l);if((s==="prev"||s==="next")&&r===null&&(s=s==="prev"?"last":"first"),s==="prev"&&r===0){if(!t.config.persist)return;s="last"}if(s==="next"&&r===c-1){if(!t.config.persist)return;s="first"}s==="prev"?c[--r].focus():s==="next"?c[++r].focus():s==="last"||s==="first"?c[c-1].focus():c[0].focus()},t.config.aria&&t.element.setAttribute("aria-multiselectable",String(t.config.multiple));let a=t.element.children,b=a.length;for(let s=0;s<b;s=s+2){let r=a[s],c=a[s+1],l,m;if(r.nodeName==="A"||r.nodeName==="BUTTON")l=r;else if(r=r.firstElementChild,c=r.nextElementSibling,r.nodeName==="A"||r.nodeName==="BUTTON")l=r;else throw new TypeError("Wrapped fold buttons must be either <a> or <button> elements");if(c.nodeName==="A"||c.nodeName==="BUTTON")throw new TypeError("Content fold cannot be <a> or <button> element");if(m=c,l&&m){let n=Object.create(null);n.button=l,n.content=m,n.number=t.folds.length,n.id=`${t.element.id}F${n.number}`,n.button.id=`B${n.id}`,n.content.id=`C${n.id}`,t.folds.push(f(t,n,o))}}t.destroy=()=>{for(let s of t.folds)s.destroy();t.element.removeAttribute("aria-multiselectable"),t.element.removeAttribute("id"),o.emit("destroy",t),delete window.accordion[t.id]};let d=t.element.hasAttribute("id")?t.element.id:t.id;return window.accordion[d]=t,t};export{x as accordion};
